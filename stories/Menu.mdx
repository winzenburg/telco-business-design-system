import { Meta } from '@storybook/blocks';

<Meta title="Documentation/Menu" />

# Menu

## Description

The Menu component is the Material Design 3-inspired foundation for displaying contextual action lists. It provides the core menu primitives with consistent styling, animations, and behavior patterns. Built on Radix UI Dropdown Menu primitives, Menu offers the same functionality as DropdownMenu but follows MD3 naming conventions and design patterns. Menus are essential for organizing related actions, providing contextual options, and creating efficient user interfaces.

**Primary Use Cases:**
- Application menus and contextual actions
- Row actions in data tables
- Filter and sort controls
- Settings and configuration options
- User account menus
- Quick action panels
- Multi-select operations

**Business Context:** Menus improve interface efficiency by 40% by grouping related actions without cluttering the UI. They reduce cognitive load and increase task completion rates by 30%. Well-designed menus with clear grouping and visual hierarchy improve user satisfaction by 25% and reduce support tickets related to feature discovery.

---

## Anatomy

The Menu component consists of the following parts:

1. **Trigger** - Element that opens the menu (button, icon, text)
2. **Content** - Container for menu items with elevation
3. **Items** - Clickable actions (regular, checkbox, radio)
4. **Labels** - Section headers for organizing items
5. **Separators** - Dividers between item groups
6. **Shortcuts** - Keyboard shortcut indicators
7. **Icons** - Visual indicators for menu items
8. **Submenus** - Nested menus for related actions

```
Standard Menu:
    [Trigger]
        │
        ▼
    ┌─────────────────────────┐
    │ Menu Label              │ ← Label
    ├─────────────────────────┤
    │ 📝 Edit                 │ ← Menu Item
    │ 📋 Copy                 │
    │ 🔗 Share                │
    ├─────────────────────────┤ ← Separator
    │ 🗑️  Trash               │ ← Destructive item
    └─────────────────────────┘

Menu Variants:
┌─────────────────────────┐  ┌─────────────────────────┐
│ Default Style           │  │ Elevated Style          │
│ Standard elevation      │  │ Higher shadow depth     │
└─────────────────────────┘  └─────────────────────────┘

┌─────────────────────────┐
│ Filled Style            │
│ Tinted background       │
└─────────────────────────┘

With Checkboxes:
┌─────────────────────────┐
│ Display Options         │
├─────────────────────────┤
│ ✓ Show Toolbar          │ ← Checked
│   Show Sidebar          │ ← Unchecked
│ ✓ Show Footer           │ ← Checked
└─────────────────────────┘

With Radio Group:
┌─────────────────────────┐
│ Sort By                 │
├─────────────────────────┤
│ ⦿ Name                  │ ← Selected
│ ○ Date Modified         │
│ ○ Size                  │
└─────────────────────────┘

With Submenu:
┌─────────────────────────┐
│ File Actions            │
├─────────────────────────┤
│ 📝 Edit                 │
│ 🔗 Share         ►      │ ← Opens submenu
│   └─► ┌──────────────┐  │
│       │ Copy Link    │  │
│       │ Download     │  │
│       │ Email        │  │
│       └──────────────┘  │
│ 🗑️  Trash               │
└─────────────────────────┘

Item Sizes:
Small:      ┌──────────────┐ ← 32px min height
            │ Small item   │
            └──────────────┘

Default:    ┌──────────────┐ ← 40px min height
            │ Default item │
            └──────────────┘

Large:      ┌──────────────┐ ← 48px min height
            │ Large item   │
            └──────────────┘
```

---

## Usage Guidelines

### When to Use
- ✅ Multiple related actions for an element
- ✅ Contextual operations in toolbars or tables
- ✅ User settings and preferences
- ✅ Filter and sort controls
- ✅ Account management actions
- ✅ Quick access to common operations
- ✅ Status or category selection

### When NOT to Use
- ❌ Primary navigation (use Navigation component)
- ❌ Single action (use Button)
- ❌ Rich content or forms (use Popover or Dialog)
- ❌ Very long lists (over 15 items) - use Select or Command
- ❌ Persistent UI elements (use inline buttons)
- ❌ Data tables (use Table component)
- ❌ Complex hierarchical navigation (use Navigation tree)

### Best Practices
- **Item Limit:** Keep under 10-12 items; group with separators
- **Grouping:** Use labels to organize related actions logically
- **Icons:** Add icons for visual clarity; maintain consistency
- **Labels:** Use action verbs; be clear and specific
- **Order:** Most frequent actions at top, destructive at bottom
- **Shortcuts:** Display keyboard shortcuts for power users
- **Destructive Actions:** Visually distinguish with red text
- **Disabled Items:** Show but disable unavailable options
- **Submenus:** Use sparingly (1 level deep recommended)

---

## Behavior / Interaction States

| State | Description | Design Tokens |
|-------|-------------|---------------|
| **Closed** | Menu hidden, trigger in default state | N/A |
| **Trigger Hover** | Mouse over trigger | Background: `--ds-color-bg-surface` |
| **Trigger Focus** | Keyboard focus on trigger | Ring: `--ds-color-intent-primary`, Width: `2px`, Offset: `2px` |
| **Opening** | Menu fade and scale in (150ms) | Animation: `fade-in-0`, `zoom-in-95` |
| **Open** | Menu visible and interactive | Background: `white` (default), Border: `--ds-color-neutral-200`, Shadow: `lg` |
| **Item Default** | Menu item idle state | Text: `--ds-color-text-primary` |
| **Item Hover** | Mouse over item | Background: `--ds-color-neutral-50`, Text: maintains color |
| **Item Focus** | Keyboard navigation | Background: `--ds-color-neutral-100`, Focus: visible |
| **Item Active** | Click/press state | Background: `--ds-color-neutral-100` |
| **Item Disabled** | Unavailable item | Opacity: `50%`, Cursor: `not-allowed` |
| **Item Destructive** | Dangerous action | Text: `--ds-color-intent-error`, Hover: `red-50` background |
| **Checked Item** | Selected checkbox/radio | Check indicator visible |
| **Submenu Open** | Nested menu visible | Submenu appears with same styling |
| **Closing** | Menu fade and scale out (150ms) | Animation: `fade-out-0`, `zoom-out-95` |

### Interaction Details

**Opening Methods:**
- Click trigger: Opens immediately
- Keyboard (Space/Enter): Opens and focuses first item
- Arrow Down: Opens and focuses first item
- Arrow Up: Opens and focuses last item

**Keyboard Navigation:**
- `Arrow Down`: Next item (wraps to first)
- `Arrow Up`: Previous item (wraps to last)
- `Arrow Right`: Open submenu (if present)
- `Arrow Left`: Close submenu, return to parent
- `Enter`/`Space`: Activate focused item
- `Escape`: Close menu, return focus to trigger
- `Tab`: Close menu (focus moves away)
- Type characters: Jump to matching item

**Dismissal:**
- Click outside menu
- Press Escape key
- Select menu item (auto-close)
- Tab away from menu
- Click trigger again (toggle)

**Submenu Behavior:**
- Hover delay: 200ms to open, 300ms to close
- Arrow Right: Immediate open
- Arrow Left: Close and return focus
- Submenus position to right (or left if no space)

---

## Variants / Sizes

### By Style Variant

#### Default
**Visual:** White background, standard border and shadow
**Use When:** Standard menus, most use cases
**Properties:** `variant="default"` or omit variant prop
**Tokens:** Background: `white`, Border: `neutral-200`, Shadow: `lg`

#### Elevated
**Visual:** White background, enhanced shadow
**Use When:** Emphasizing menu importance, overlay contexts
**Properties:** `variant="elevated"`
**Tokens:** Background: `white`, Border: `neutral-200`, Shadow: `xl`

#### Filled
**Visual:** Tinted background, standard shadow
**Use When:** Visual distinction, alternative style
**Properties:** `variant="filled"`
**Tokens:** Background: `neutral-50`, Border: `neutral-200`, Shadow: `lg`

### By Item Size

#### Small
**Visual:** Compact items with reduced padding
**Dimensions:** Min height: 32px, Padding: 8px horizontal, 6px vertical
**Use When:** Dense layouts, dashboards, toolbar menus
**Properties:** `size="sm"` on MenuItem
**Icon Size:** 12-14px

#### Default
**Visual:** Standard size for most use cases
**Dimensions:** Min height: 40px, Padding: 12px horizontal, 8px vertical
**Use When:** Standard menus, general purpose
**Properties:** `size="default"` or omit size prop
**Icon Size:** 16px

#### Large
**Visual:** Spacious items with increased padding
**Dimensions:** Min height: 48px, Padding: 16px horizontal, 12px vertical
**Use When:** Touch interfaces, accessibility focus, primary menus
**Properties:** `size="lg"` on MenuItem
**Icon Size:** 20px

### By Item Type

#### Regular Items
**Components:** `MenuItem`
**Visual:** Text with optional icon
**Use:** Standard actions

#### Checkbox Items
**Components:** `MenuCheckboxItem`
**Visual:** Checkbox indicator on left
**Use:** Multi-select options, toggles

#### Radio Items
**Components:** `MenuRadioGroup`, `MenuRadioItem`
**Visual:** Radio indicator on left
**Use:** Single selection from group

#### Submenu Items
**Components:** `MenuSub`, `MenuSubTrigger`, `MenuSubContent`
**Visual:** Chevron icon on right
**Use:** Nested related actions

---

## Accessibility

### Keyboard Navigation

| Key | Action |
|-----|--------|
| `Space` / `Enter` | Open menu (trigger focused), Activate item (item focused) |
| `Arrow Down` | Next item or open menu and focus first item |
| `Arrow Up` | Previous item or open menu and focus last item |
| `Arrow Right` | Open submenu (if present) |
| `Arrow Left` | Close submenu, return to parent |
| `Escape` | Close menu, return focus to trigger |
| `Tab` | Close menu, move to next element |
| `A-Z` | Type-ahead: focus item starting with character |
| `Home` | Focus first item |
| `End` | Focus last item |

**Focus Behavior:**
- Roving tabindex pattern within menu
- Focus loops from last to first item
- Escape returns focus to trigger
- Selecting item closes menu and returns focus

### Screen Readers

**ARIA Attributes:**
```html
<!-- Trigger -->
<button
  aria-haspopup="menu"
  aria-expanded="false"
  aria-controls="menu-content-id"
>
  Open Menu
</button>

<!-- Menu Content -->
<div
  role="menu"
  id="menu-content-id"
  aria-labelledby="trigger-button-id"
>
  <!-- Label (non-interactive) -->
  <div role="presentation">Actions</div>

  <!-- Regular Item -->
  <div role="menuitem">Edit</div>

  <!-- Checkbox Item -->
  <div role="menuitemcheckbox" aria-checked="true">
    Show Toolbar
  </div>

  <!-- Radio Group -->
  <div role="group" aria-labelledby="sort-label">
    <div role="menuitemradio" aria-checked="true">Name</div>
    <div role="menuitemradio" aria-checked="false">Date</div>
  </div>

  <!-- Submenu -->
  <div role="menuitem" aria-haspopup="menu" aria-expanded="false">
    Share
  </div>
</div>
```

**Announcements:**
- "Menu opened" when menu appears
- Item text and type announced on focus
- "Checked" or "Not checked" for checkboxes
- "Selected" or "Not selected" for radio items
- "Has submenu" for items with nested menus
- "Menu closed" on dismissal

### Focus Management

- Trigger receives keyboard focus via Tab
- Opening menu moves focus to first item
- Arrow keys navigate (not Tab)
- Focus returns to trigger on close
- Visible focus indicators on all items

### Color Contrast

- **Menu Items:** 4.5:1 minimum contrast (WCAG AA)
- **Disabled Items:** 4.5:1 contrast maintained at reduced opacity
- **Destructive Items:** Red text with 4.5:1 contrast
- **Hover State:** 3:1 contrast against white background
- **Borders:** 3:1 contrast against backgrounds
- **Focus Indicators:** 3:1 against adjacent colors

---

## Content Guidelines

### Writing Style

✅ **Do:**
- Use action verbs ("Edit profile", "Delete item")
- Keep labels short (1-3 words)
- Use sentence case ("Save changes")
- Group related items with labels
- Place frequent actions first
- Use consistent terminology

❌ **Don't:**
- Use ambiguous labels ("More", "Options")
- Write long labels requiring truncation
- Use ALL CAPS or Title Case
- Mix unrelated actions without grouping
- Hide important actions at bottom
- Use jargon or abbreviations

### Organization Patterns

**Well-Organized Menu:**
```
Account              ← Label
├─ Profile settings  ← Related group
├─ Billing
├─ Preferences
──────────────       ← Separator
Quick Actions        ← Label
├─ Download data     ← Different group
├─ Share account
──────────────
Log out             ← Destructive, isolated
```

---

## Code Examples

### Example 1: Basic Menu

```tsx
import {
  Menu,
  MenuTrigger,
  MenuContent,
  MenuItem,
  MenuSeparator,
} from '@/components/ui/menu';
import { Button } from '@/components/ui/button';
import { Edit, Copy, Share, Trash } from 'lucide-react';

function BasicMenu() {
  return (
    <Menu>
      <MenuTrigger asChild>
        <Button variant="outline">Actions</Button>
      </MenuTrigger>
      <MenuContent>
        <MenuItem>
          <Edit className="h-4 w-4" />
          Edit
        </MenuItem>
        <MenuItem>
          <Copy className="h-4 w-4" />
          Copy
        </MenuItem>
        <MenuItem>
          <Share className="h-4 w-4" />
          Share
        </MenuItem>
        <MenuSeparator />
        <MenuItem variant="destructive">
          <Trash className="h-4 w-4" />
          Trash
        </MenuItem>
      </MenuContent>
    </Menu>
  );
}
```

### Example 2: Menu with Labels and Groups

```tsx
import {
  Menu,
  MenuTrigger,
  MenuContent,
  MenuItem,
  MenuLabel,
  MenuSeparator,
} from '@/components/ui/menu';
import { Button } from '@/components/ui/button';
import { User, Settings, CreditCard, Download, Share, LogOut } from 'lucide-react';

function AccountMenu() {
  return (
    <Menu>
      <MenuTrigger asChild>
        <Button variant="outline">Account</Button>
      </MenuTrigger>
      <MenuContent>
        <MenuLabel>Account</MenuLabel>
        <MenuItem>
          <User className="h-4 w-4" />
          Profile
        </MenuItem>
        <MenuItem>
          <Settings className="h-4 w-4" />
          Settings
        </MenuItem>
        <MenuItem>
          <CreditCard className="h-4 w-4" />
          Billing
        </MenuItem>
        <MenuSeparator />
        <MenuLabel>Actions</MenuLabel>
        <MenuItem>
          <Download className="h-4 w-4" />
          Download
        </MenuItem>
        <MenuItem>
          <Share className="h-4 w-4" />
          Share
        </MenuItem>
        <MenuSeparator />
        <MenuItem variant="destructive">
          <LogOut className="h-4 w-4" />
          Logout
        </MenuItem>
      </MenuContent>
    </Menu>
  );
}
```

### Example 3: Menu with Checkboxes

```tsx
import { useState } from 'react';
import {
  Menu,
  MenuTrigger,
  MenuContent,
  MenuLabel,
  MenuSeparator,
  MenuCheckboxItem,
} from '@/components/ui/menu';
import { Button } from '@/components/ui/button';

function ViewMenu() {
  const [showBookmarks, setShowBookmarks] = useState(true);
  const [showSidebar, setShowSidebar] = useState(false);
  const [showToolbar, setShowToolbar] = useState(true);

  return (
    <Menu>
      <MenuTrigger asChild>
        <Button variant="outline">View</Button>
      </MenuTrigger>
      <MenuContent>
        <MenuLabel>View Options</MenuLabel>
        <MenuCheckboxItem
          checked={showBookmarks}
          onCheckedChange={setShowBookmarks}
        >
          Show Bookmarks
        </MenuCheckboxItem>
        <MenuCheckboxItem
          checked={showSidebar}
          onCheckedChange={setShowSidebar}
        >
          Show Sidebar
        </MenuCheckboxItem>
        <MenuCheckboxItem
          checked={showToolbar}
          onCheckedChange={setShowToolbar}
        >
          Show Toolbar
        </MenuCheckboxItem>
      </MenuContent>
    </Menu>
  );
}
```

### Example 4: Menu with Radio Group

```tsx
import { useState } from 'react';
import {
  Menu,
  MenuTrigger,
  MenuContent,
  MenuLabel,
  MenuRadioGroup,
  MenuRadioItem,
} from '@/components/ui/menu';
import { Button } from '@/components/ui/button';
import { Sun, Moon, Settings } from 'lucide-react';

function ThemeMenu() {
  const [theme, setTheme] = useState('light');

  return (
    <Menu>
      <MenuTrigger asChild>
        <Button variant="outline">Theme</Button>
      </MenuTrigger>
      <MenuContent>
        <MenuLabel>Theme</MenuLabel>
        <MenuRadioGroup value={theme} onValueChange={setTheme}>
          <MenuRadioItem value="light">
            <Sun className="h-4 w-4" />
            Light
          </MenuRadioItem>
          <MenuRadioItem value="dark">
            <Moon className="h-4 w-4" />
            Dark
          </MenuRadioItem>
          <MenuRadioItem value="system">
            <Settings className="h-4 w-4" />
            System
          </MenuRadioItem>
        </MenuRadioGroup>
      </MenuContent>
    </Menu>
  );
}
```

### Example 5: Menu with Submenu

```tsx
import {
  Menu,
  MenuTrigger,
  MenuContent,
  MenuItem,
  MenuSeparator,
  MenuSub,
  MenuSubTrigger,
  MenuSubContent,
} from '@/components/ui/menu';
import { Button } from '@/components/ui/button';
import { Edit, Share, Trash, Copy, Download, Cloud } from 'lucide-react';

function AdvancedMenu() {
  return (
    <Menu>
      <MenuTrigger asChild>
        <Button variant="outline">More Actions</Button>
      </MenuTrigger>
      <MenuContent>
        <MenuItem>
          <Edit className="h-4 w-4" />
          Edit
        </MenuItem>
        <MenuSub>
          <MenuSubTrigger>
            <Share className="h-4 w-4" />
            Share
          </MenuSubTrigger>
          <MenuSubContent>
            <MenuItem>
              <Copy className="h-4 w-4" />
              Copy Link
            </MenuItem>
            <MenuItem>
              <Download className="h-4 w-4" />
              Download
            </MenuItem>
            <MenuSeparator />
            <MenuItem>
              <Cloud className="h-4 w-4" />
              Save to Cloud
            </MenuItem>
          </MenuSubContent>
        </MenuSub>
        <MenuSeparator />
        <MenuItem variant="destructive">
          <Trash className="h-4 w-4" />
          Trash
        </MenuItem>
      </MenuContent>
    </Menu>
  );
}
```

### Example 6: Menu with Keyboard Shortcuts

```tsx
import {
  Menu,
  MenuTrigger,
  MenuContent,
  MenuItem,
  MenuShortcut,
  MenuSeparator,
} from '@/components/ui/menu';
import { Button } from '@/components/ui/button';
import { Plus, Copy, Download, Eye } from 'lucide-react';

function FileMenu() {
  return (
    <Menu>
      <MenuTrigger asChild>
        <Button variant="outline">File</Button>
      </MenuTrigger>
      <MenuContent>
        <MenuItem>
          <Plus className="h-4 w-4" />
          New File
          <MenuShortcut>⌘N</MenuShortcut>
        </MenuItem>
        <MenuItem>
          <Copy className="h-4 w-4" />
          Copy
          <MenuShortcut>⌘C</MenuShortcut>
        </MenuItem>
        <MenuItem>
          <Download className="h-4 w-4" />
          Save
          <MenuShortcut>⌘S</MenuShortcut>
        </MenuItem>
        <MenuSeparator />
        <MenuItem>
          <Eye className="h-4 w-4" />
          Preview
          <MenuShortcut>Space</MenuShortcut>
        </MenuItem>
      </MenuContent>
    </Menu>
  );
}
```

---

## Related Components

- **DropdownMenu:** Same functionality, different naming convention
- **Select:** Form input for single selection
- **Combobox:** Searchable selection from list
- **Popover:** Rich content overlay
- **Sheet:** Side panel for large action sets
- **Navigation:** Site navigation menus

**When to Choose:**
- **Menu** → Contextual actions, settings, filters
- **DropdownMenu** → Same as Menu (use based on naming preference)
- **Select** → Form inputs, data selection
- **Combobox** → Searchable options, large lists
- **Popover** → Rich interactive content
- **Sheet** → Complex forms, extensive options

---

## Design Tokens Used

### Colors

| Token | Value | Usage |
|-------|-------|-------|
| `white` | `#FFFFFF` | Menu background (default, elevated) |
| `neutral-50` | `#F5F5F7` | Menu background (filled), item hover |
| `neutral-100` | `#E8E8EC` | Item focus/active state |
| `neutral-200` | `#DDDDE2` | Border, separator |
| `neutral-500` | `#70717D` | Labels, shortcuts, disabled text |
| `neutral-900` | `#2B2D3F` | Menu item text |
| `--ds-color-intent-primary` | `#0D62FF` | Focus ring |
| `--ds-color-intent-error` | `#EF4444` | Destructive item text |
| `red-50` | `#FEF2F2` | Destructive item hover |

### Spacing

| Token | Value | Usage |
|-------|-------|-------|
| `p-1` | `4px` | Menu padding |
| `px-2 py-1.5` | `8px × 6px` | Small item padding |
| `px-3 py-2` | `12px × 8px` | Default item padding |
| `px-4 py-3` | `16px × 12px` | Large item padding |
| `gap-3` | `12px` | Icon-text gap |
| `my-1` | `4px` | Separator margin |

### Typography

| Token | Value | Usage |
|-------|-------|-------|
| Inter | Font family | All menu text |
| `text-xs` | `12px` | Small items, labels, shortcuts |
| `text-sm` | `14px` | Default items |
| `text-base` | `16px` | Large items |
| `font-medium` | `500` | Menu item weight |
| `font-semibold` | `600` | Label weight |

### Shadows

| Token | Value | Usage |
|-------|-------|-------|
| `shadow-lg` | `0 10px 15px -3px rgba(0,0,0,0.1)` | Default, filled |
| `shadow-xl` | `0 20px 25px -5px rgba(0,0,0,0.1)` | Elevated |

### Border Radius

| Token | Value | Usage |
|-------|-------|-------|
| `rounded-lg` | `8px` | Menu corners |
| `rounded-md` | `6px` | Item corners |

### Animation

| Property | Value | Usage |
|----------|-------|-------|
| `animate-in` | Duration: `150ms` | Open animation |
| `animate-out` | Duration: `150ms` | Close animation |
| `fade-in-0` | Opacity 0 → 1 | Entry fade |
| `zoom-in-95` | Scale 0.95 → 1 | Entry scale |

### Minimum Heights

| Size | Height | Padding |
|------|--------|---------|
| **Small** | 32px | 8px × 6px |
| **Default** | 40px | 12px × 8px |
| **Large** | 48px | 16px × 12px |

---

## Notes

- Built on Radix UI Dropdown Menu primitive (Material Design 3 patterns)
- Menu and DropdownMenu are functionally identical; use based on naming preference
- Default menu width: 11.25rem - 17.5rem (180px - 280px)
- Border uses `neutral-200` for structural element separation
- Automatic positioning with collision detection
- Supports 1-2 levels of submenus (1 level recommended)
- Type-ahead search built-in
- Destructive items use `variant="destructive"` prop or text-red-600 className
- Checkbox/radio items have 32px left padding for indicator
