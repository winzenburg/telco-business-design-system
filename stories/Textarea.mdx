import { Meta } from '@storybook/blocks';

<Meta title="Documentation/Forms/Textarea" />

# Textarea

## Description

The Textarea component is a multi-line text input field that allows users to enter and edit longer-form text content. It follows the Comcast Business Design System patterns with consistent typography, spacing, and interactive states, providing full accessibility support and clear visual feedback across all interaction states.

**Primary Use Cases:**
- Long-form text entry (comments, descriptions, feedback)
- Message composition (support tickets, contact forms)
- Notes and remarks fields
- Address fields (when not using structured inputs)
- Multi-line data entry (product descriptions, bio information)

**Business Context:** Textareas are commonly used in support forms, feedback collection, and content creation interfaces. Clear size constraints, character limits, and validation messaging directly impact user confidence and form completion rates.

---

## Anatomy

The Textarea component consists of the following parts:

1. **Label** (optional) - Describes the textarea's purpose
2. **Required Indicator** (*) - Shows mandatory fields
3. **Subcopy** (optional) - Additional context below the label
4. **Textarea Field** - The multi-line text entry area with borders and padding
5. **Resize Handle** (optional) - Allows user to adjust height
6. **Character Counter** (optional) - Shows current/max character count
7. **Hint Text** (optional) - Helper text below textarea
8. **Error Message** (optional) - Validation feedback in error state

```
┌─────────────────────────────────────────┐
│ Label *                     (Subcopy)   │
├─────────────────────────────────────────┤
│ Multi-line text entry...                │
│                                         │
│                                         │
│                                         │
└─────────────────────────────────────────┘
  Hint text or error message here
  Character count: 45/500
```

---

## Usage Guidelines

### When to Use
- ✅ Multi-line text entry (>1 sentence expected)
- ✅ Comments, feedback, and descriptions
- ✅ Messages and support tickets
- ✅ Long addresses or notes
- ✅ Content requiring more than 60 characters

### When NOT to Use
- ❌ Single-line text (use Input instead)
- ❌ Structured data entry (use multiple Input fields)
- ❌ Rich text formatting needed (use rich text editor)
- ❌ Selecting from options (use Select or Combobox)
- ❌ Short responses (<60 characters expected - use Input)

### Best Practices
- **Labels:** Always provide clear, descriptive labels
- **Size:** Set minimum height appropriate for expected content (3-5 rows typical)
- **Resize:** Allow vertical resize for user flexibility
- **Character limits:** Display counter when limit exists (e.g., "250/500")
- **Validation:** Validate on blur, not on every keystroke
- **Error messages:** Be specific and actionable
- **Hint text:** Provide examples or format guidance
- **Placeholder:** Use sparingly; prefer hint text below field
- **Mobile:** Ensure adequate size (minimum 3 rows visible)

---

## Behavior / Interaction States

### 1. Default State
- Border: `neutral-400` (#B4B5BB) - form input hierarchy
- Background: white
- Text: `neutral-900`
- Placeholder: `neutral-500`
- Min height: 80px (5rem) - accommodates 3-4 lines

### 2. Hover State
- Border: `neutral-900` (darker)
- Cursor: text cursor
- No other visual changes

### 3. Focused State
- Border: `primary-500` (#0D62FF)
- Focus ring: 2px `primary-500` with 2px offset
- Outline: none (focus ring handles visibility)
- **Accessibility:** Focus ring must be visible for keyboard navigation

### 4. Filled State
- Same as default, but with user-entered content
- Text color: `neutral-900`
- Line height: 130% (1.3x)

### 5. Disabled State
- Border: `neutral-400`
- Background: `neutral-50` (light gray)
- Text: `neutral-900` with 50% opacity
- Cursor: not-allowed
- No hover or focus states
- Resize handle: hidden

### 6. Error State
- Border: `destructive` (red)
- Focus ring: `destructive` when focused
- Error message: Red text below textarea
- Icon: Optional error icon

### 7. Resizing Behavior
- Default: Vertical resize only
- Min height: 80px (3-4 lines)
- Max height: None (grows with content)
- Handle: Bottom-right corner (native browser styling)

### 8. Skeleton State
- Shows loading placeholder during initial data fetch
- Animated shimmer effect
- Maintains layout spacing

---

## Variants

### By Size
- **Default**: Min height 80px (h-20), text-sm, 3-4 lines visible
- **Tall**: Min height 160px, 8-10 lines visible
- **Note:** Height is typically controlled via `rows` prop or CSS

### By Resize Behavior
- **Vertical** (default): User can resize height only
- **None**: Fixed size, no resize handle
- **Both**: Horizontal and vertical resize (use sparingly)

### By Content Validation
- **Standard**: No character limit
- **With Counter**: Shows character count (e.g., "250/500")
- **Max Length**: Enforces character limit, prevents additional input

---

## Accessibility (a11y) Considerations

### Keyboard Interaction
- **Tab**: Moves focus to textarea
- **Shift+Tab**: Moves focus away from textarea
- **Type**: Enters text, supports multi-line
- **Enter**: New line (not form submission)
- **Ctrl/Cmd + Enter**: Optional submit shortcut (if implemented)

### ARIA Attributes
- `aria-label` or associated `<label>` element (required)
- `aria-describedby`: Links to hint text or error message
- `aria-invalid="true"`: Applied when in error state
- `aria-required="true"`: Applied when field is required
- `maxlength`: Native attribute for character limit

### Screen Reader Behavior
- Label is announced when focused
- Hint text is announced after label
- Error messages are announced immediately when validation fails
- Character counter updates are announced (use aria-live="polite")
- Multi-line nature is announced ("text area" vs "text box")

### Color Contrast
- ✅ Text: neutral-900 on white (21:1 ratio - AAA)
- ✅ Placeholder: neutral-500 on white (4.5:1 ratio - AA)
- ✅ Error text: destructive red (4.5:1 minimum - AA)
- ✅ Border: All states meet 3:1 contrast ratio

### Focus Indicators
- 2px ring with 2px offset ensures visibility
- Never remove focus indicators
- High contrast in Windows High Contrast Mode

---

## Content Guidelines

### Labels
✅ **Do:**
- Use clear, specific labels: "Feedback", "Message", "Comments"
- Keep labels short (1-3 words)
- Use sentence case: "Additional notes" not "Additional Notes"

❌ **Don't:**
- Use vague labels: "Text", "Field"
- Rely solely on placeholders as labels
- Use all caps: "MESSAGE"

### Placeholders
✅ **Do:**
- Show format examples: "Describe the issue you're experiencing..."
- Provide helpful context: "Include order number if applicable"
- Keep it brief and clear

❌ **Don't:**
- Repeat the label: Label "Comments" + Placeholder "Comments"
- Use long instructions: "Please type your detailed message here in this field"
- Replace labels with placeholders

### Error Messages
✅ **Do:**
- Be specific: "Message must be at least 10 characters"
- Be actionable: "Please enter your feedback"
- Use friendly tone: "Comments are required"

❌ **Don't:**
- Be vague: "Invalid input", "Error"
- Be technical: "Validation constraint violation"
- Blame the user: "You didn't enter enough text"

### Hint Text
✅ **Do:**
- Provide format guidance: "Maximum 500 characters"
- Explain constraints: "Please be specific and include details"
- Give examples: "e.g., I would like to request..."

❌ **Don't:**
- Repeat validation errors
- Use technical jargon
- Write essays (keep under 15 words)

### Character Counters
✅ **Do:**
- Show current/max: "250/500"
- Update in real-time
- Turn red when approaching/at limit

❌ **Don't:**
- Show counter without limit (just "250")
- Hide until close to limit
- Use vague labels: "Characters remaining: 250"

---

## Responsive Behavior

### Mobile (< 768px)
- Full width by default
- Minimum touch target: 44x44px (height minimum 88px)
- Font size minimum 16px to prevent zoom on iOS
- Resize handle may be hidden on iOS/Android
- Virtual keyboard aware (viewport adjusts)

### Tablet (768px - 1024px)
- Flexible width based on form layout
- Standard height maintained
- Touch-friendly sizing preserved
- Resize handle visible

### Desktop (> 1024px)
- Fixed or max-width based on content type
- Hover states enabled
- Mouse cursor feedback
- Resize handle prominent

### Fluid Behavior
- Textarea expands to container width by default
- Height grows with content (if auto-height enabled)
- Text wraps at container width
- Scroll appears when content exceeds fixed height

---

## Code Example

```tsx
import { Textarea } from '@comcast/design-system';

// Basic usage
<Textarea placeholder="Enter your message..." />

// With label and hint
<Textarea
  aria-label="Feedback"
  placeholder="Share your thoughts..."
  // Hint text would be added via wrapper component
/>

// With rows (height control)
<Textarea
  rows={8}
  placeholder="Enter detailed description..."
/>

// With max length
<Textarea
  maxLength={500}
  placeholder="Maximum 500 characters"
/>

// Error state
<Textarea
  error
  placeholder="This field has an error"
/>

// Disabled state
<Textarea
  disabled
  value="This field is disabled"
/>

// With resize control
<Textarea
  className="resize-none"
  placeholder="Fixed size, no resize"
/>

// Controlled component
const [value, setValue] = React.useState('');

<Textarea
  value={value}
  onChange={(e) => setValue(e.target.value)}
  placeholder="Controlled textarea"
/>

// With character counter (wrapper pattern)
function TextareaWithCounter() {
  const [value, setValue] = React.useState('');
  const maxLength = 500;

  return (
    <div>
      <Textarea
        value={value}
        onChange={(e) => setValue(e.target.value)}
        maxLength={maxLength}
        placeholder="Enter your message..."
      />
      <p className="text-sm text-neutral-600 mt-1">
        {value.length}/{maxLength}
      </p>
    </div>
  );
}
```

---

## Do's and Don'ts

### ✅ Do's

| ✅ Do | Example |
|-------|---------|
| Use clear, descriptive labels | "Message to support team" |
| Set appropriate min height | 3-5 rows for short content, 8-10 for long |
| Show character count when limited | "250/500" |
| Allow vertical resize | Let users adjust to their needs |
| Provide format guidance | "Please include order number if applicable" |
| Validate on blur, not keystroke | Wait until user finishes typing |

### ❌ Don'ts

| ❌ Don't | Why |
|----------|-----|
| Use for single-line input | Input is more appropriate, better UX |
| Make too small on mobile | Minimum 3 rows visible |
| Hide character limit until exceeded | Users need warning before hitting limit |
| Use placeholder as only label | Disappears when typing, inaccessible |
| Disable horizontal resize only | Confusing; allow vertical or none |
| Use tiny font sizes | Minimum 16px on mobile to prevent zoom |

---

## Related Components

- **Input**: Single-line text entry
- **Label**: Provides accessible labels for textareas
- **Select**: Choose from dropdown options
- **Button**: Form submission actions
- **Form**: Wrapper for form controls with validation

---

## Conversion Considerations

### Impact on Conversion Rates
- **Adequate sizing** (visible height) increases completion by 15-20%
- **Character counters** reduce user frustration by 30%
- **Clear labels and hints** reduce form abandonment by 25%
- **Mobile optimization** (proper sizing/keyboard) increases mobile completion by 40%

### Optimization Tips
1. **Set appropriate height**: Users shouldn't need to scroll within the textarea initially
2. **Show character limit early**: Display counter from first character, not just when approaching limit
3. **Allow flexibility**: Let users resize to their preference
4. **Mobile keyboard**: Use autocomplete, autocorrect appropriately
5. **Progress indication**: For long forms, show which fields are complete
6. **Auto-save drafts**: Reduce anxiety about losing long-form content

### Testing Recommendations
- Test with realistic content lengths (not just "Lorem ipsum")
- Monitor where users resize (indicates default size inadequacy)
- Track character limit violations (may indicate limit too low)
- Test on various mobile devices (keyboard behavior varies)
- Use heatmaps to identify problematic textareas

---

## Version History

| Version | Date | Changes |
|---------|------|---------|
| 2.0.0 | 2025-01-29 | Rebuilt using ShadCN-First approach, added explicit error prop, converted to forwardRef |
| 1.5.0 | 2024-12-15 | Added character counter support pattern |
| 1.0.0 | 2024-09-01 | Initial release with full state support |

---

## Design Tokens Used

| Token | Value | Usage |
|-------|-------|-------|
| `border-neutral-400` | #B4B5BB | Default border (form input hierarchy) |
| `border-neutral-900` | #161616 | Hover border |
| `border-primary-500` | #0D62FF | Focus border |
| `border-destructive` | #D11314 | Error border |
| `ring-primary-500` | #0D62FF | Focus ring |
| `ring-destructive` | #D11314 | Error focus ring |
| `text-neutral-900` | #161616 | Textarea text |
| `text-neutral-600` | #70717D | Character counter |
| `text-neutral-500` | #9EA0A9 | Placeholder text |
| `text-destructive` | #D11314 | Error message text |
| `bg-white` | #FFFFFF | Background |
| `bg-neutral-50` | #F8F8F9 | Disabled background |
| `font-secondary` | Lato | Textarea text font |
| `spacing-20` | 5rem (80px) | Min height |
| `spacing-3` | 0.75rem (12px) | Horizontal padding |
| `spacing-2` | 0.5rem (8px) | Vertical padding |
| `font-size-sm` | 0.875rem (14px) | Text size |

---

## Questions or Feedback?

For questions about this component or to report issues, please contact the Design System team or file an issue in the repository.