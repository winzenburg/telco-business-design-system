<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Business VoiceEdge® - Automated Attendants</title>
  <!-- Comcast Business Design System Styles -->
  <link rel="stylesheet" href="./public/styles.css">
  <script src="https://unpkg.com/lucide@latest"></script>
  <style>
    /* App-specific styles - All core styles are now in design system */
    /* Only custom overrides and app-specific layouts remain here */

    .sidebar-item.active .sidebar-item-icon {
      background: rgb(245, 248, 255);
    }

    .sidebar-item-icon svg {
      width: 18px;
      height: 18px;
    }

    .sidebar-item.active .sidebar-item-icon svg {
      color: rgb(13, 98, 255);
    }

    /* App-specific page layouts */
    .page-header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      margin-bottom: 1.5rem;
    }

    .page-title {
      font-size: 0.75rem;
      font-weight: 600;
      color: rgb(43, 45, 63);
      text-transform: uppercase;
      letter-spacing: 1px;
      margin-bottom: 0.5rem;
    }

    .location-info {
      display: flex;
      align-items: center;
      gap: 0.5rem;
      font-size: 1.25rem;
      font-weight: 600;
      color: rgb(43, 45, 63);
    }

    .card {
      background: white;
      border-radius: 0.25rem;
      box-shadow: 0 1px 3px rgba(0,0,0,0.1);
      margin-bottom: 1.5rem;
    }

    .card-header {
      padding: 1.25rem 24px;
      border-bottom: 1px solid rgb(229, 231, 235);
    }

    .card-title {
      font-size: 1rem;
      font-weight: 600;
      color: rgb(43, 45, 63);
      margin: 0;
    }

    .card-body {
      padding: 1.5rem;
    }

    /* Action buttons - using design system colors */
    .action-button {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      gap: 0.5rem;
      padding: 0.75rem 24px;
      background: white;
      color: rgb(13, 98, 255);
      border: 1px solid rgb(221, 221, 226);
      border-radius: 0.25rem;
      font-size: 0.8125rem;
      font-weight: 600;
      text-transform: uppercase;
      letter-spacing: 0.5px;
      cursor: pointer;
      transition: all 0.15s;
      text-decoration: none;
    }

    .action-button:hover {
      background: rgb(252, 252, 252);
      border-color: rgb(13, 98, 255);
    }

    .action-button-primary {
      background: rgb(13, 98, 255);
      color: white;
      border-color: rgb(13, 98, 255);
    }

    .action-button-primary:hover {
      background: rgb(10, 78, 204);
      border-color: rgb(10, 78, 204);
    }

    .action-grid {
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 1rem;
      margin-bottom: 1.5rem;
    }

    .action-card {
      background: white;
      border: 1px solid rgb(229, 231, 235);
      border-radius: 0.25rem;
      padding: 1.5rem;
      text-align: center;
      cursor: pointer;
      transition: all 0.15s;
    }

    .action-card:hover {
      border-color: rgb(13, 98, 255);
      box-shadow: 0 2px 8px rgba(13, 98, 255, 0.1);
    }

    .action-card i {
      color: rgb(13, 98, 255);
      margin-bottom: 0.75rem;
    }

    .action-card-title {
      font-size: 0.8125rem;
      font-weight: 600;
      color: rgb(13, 98, 255);
      text-transform: uppercase;
      letter-spacing: 0.5px;
    }

    .stats-grid {
      display: grid;
      grid-template-columns: repeat(4, 1fr);
      gap: 1rem;
      margin-bottom: 1.5rem;
    }

    .stat-card {
      background: white;
      border: 1px solid rgb(229, 231, 235);
      border-radius: 0.25rem;
      padding: 1.25rem;
    }

    .stat-value {
      font-size: 2rem;
      font-weight: 700;
      color: rgb(43, 45, 63);
      margin-bottom: 0.25rem;
    }

    .stat-label {
      font-size: 0.8125rem;
      color: rgb(112, 113, 125);
      font-weight: 500;
    }

    .stat-change {
      display: inline-block;
      padding: 0.125rem 8px;
      border-radius: 0.75rem;
      font-size: 0.6875rem;
      font-weight: 600;
      margin-top: 0.5rem;
    }

    .stat-change.positive {
      background: rgb(220, 252, 231);
      color: rgb(22, 101, 52);
    }

    .stat-change.negative {
      background: rgb(254, 226, 226);
      color: rgb(153, 27, 27);
    }

    .tabs {
      display: flex;
      border-bottom: 2px solid rgb(241, 242, 246);
      margin-bottom: 1.5rem;
    }

    .tab {
      padding: 0.75rem 24px;
      font-size: 0.8125rem;
      font-weight: 600;
      color: rgb(112, 113, 125);
      cursor: pointer;
      border-bottom: 3px solid transparent;
      margin-bottom: -2px;
      text-transform: uppercase;
      letter-spacing: 0.5px;
    }

    .tab.active {
      color: rgb(13, 98, 255);
      border-bottom-color: rgb(13, 98, 255);
    }

    .user-card {
      display: flex;
      align-items: center;
      padding: 1rem;
      border: 1px solid rgb(241, 242, 246);
      border-radius: 0.25rem;
      margin-bottom: 0.75rem;
      transition: all 0.15s;
    }

    .user-card:hover {
      background: rgb(252, 252, 252);
      border-color: rgb(221, 221, 226);
    }

    .user-avatar {
      width: 40px;
      height: 40px;
      border-radius: 50%;
      background: rgb(89, 90, 105);
      color: white;
      display: flex;
      align-items: center;
      justify-content: center;
      font-weight: 600;
      font-size: 0.875rem;
      margin-right: 16px;
    }

    .user-info {
      flex: 1;
    }

    .user-name {
      font-size: 0.875rem;
      font-weight: 600;
      color: rgb(43, 45, 63);
      margin-bottom: 0.25rem;
    }

    .user-details {
      font-size: 0.8125rem;
      color: rgb(112, 113, 125);
    }

    .badge {
      display: inline-block;
      padding: 0.25rem 10px;
      border-radius: 0.25rem;
      font-size: 0.6875rem;
      font-weight: 600;
      margin-left: 8px;
    }

    .badge-admin {
      background: rgb(224, 242, 254);
      color: rgb(7, 89, 133);
    }

    .badge-pending {
      background: rgb(254, 249, 195);
      color: rgb(133, 77, 14);
    }

    .badge-active {
      background: rgb(220, 252, 231);
      color: rgb(22, 101, 52);
    }

    .search-box {
      width: 100%;
      padding: 0.625rem 16px 10px 40px;
      border: 1px solid rgb(221, 221, 226);
      border-radius: 0.25rem;
      font-size: 0.875rem;
      margin-bottom: 1.25rem;
      background-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="%23999" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="11" cy="11" r="8"></circle><path d="m21 21-4.35-4.35"></path></svg>');
      background-repeat: no-repeat;
      background-position: 12px center;
    }

    .search-box:focus {
      outline: none;
      border-color: rgb(13, 98, 255);
    }

    .flow-builder {
      background: rgb(252, 252, 252);
      border: 2px dashed rgb(221, 221, 226);
      border-radius: 0.25rem;
      padding: 2.5rem;
      min-height: 500px;
    }

    .flow-node {
      background: white;
      border: 2px solid rgb(221, 221, 226);
      border-radius: 0.25rem;
      padding: 1.25rem;
      margin-bottom: 1.25rem;
      cursor: move;
      transition: all 0.15s;
    }

    .flow-node:hover {
      border-color: rgb(13, 98, 255);
      box-shadow: 0 2px 8px rgba(13,98,255,0.1);
    }

    .flow-node-title {
      display: flex;
      align-items: center;
      gap: 0.75rem;
      font-size: 0.9375rem;
      font-weight: 600;
      color: rgb(43, 45, 63);
      margin-bottom: 0.5rem;
    }

    .flow-node-desc {
      font-size: 0.8125rem;
      color: rgb(112, 113, 125);
      margin-bottom: 0.75rem;
    }

    .flow-node-tags {
      display: flex;
      gap: 0.5rem;
      flex-wrap: wrap;
    }

    .flow-tag {
      padding: 0.25rem 10px;
      background: rgb(249, 249, 250);
      color: rgb(89, 90, 105);
      border-radius: 0.25rem;
      font-size: 0.6875rem;
      font-weight: 600;
    }

    .keypad-grid {
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 1rem;
      max-width: 320px;
      margin: 0 auto 24px;
    }

    .keypad-key {
      aspect-ratio: 1;
      display: flex;
      align-items: center;
      justify-content: center;
      background: white;
      border: 2px solid rgb(221, 221, 226);
      border-radius: 0.25rem;
      font-size: 1.5rem;
      font-weight: 600;
      color: rgb(43, 45, 63);
      cursor: pointer;
      transition: all 0.15s;
    }

    .keypad-key:hover {
      border-color: rgb(13, 98, 255);
      background: rgb(245, 248, 255);
      color: rgb(13, 98, 255);
      transform: translateY(-2px);
      box-shadow: 0 4px 12px rgba(13,98,255,0.15);
    }

    .link-button {
      color: rgb(13, 98, 255);
      font-size: 0.8125rem;
      font-weight: 600;
      text-decoration: none;
      display: inline-flex;
      align-items: center;
      gap: 0.375rem;
      text-transform: uppercase;
      letter-spacing: 0.5px;
    }

    .link-button:hover {
      color: rgb(10, 78, 204);
    }

    table {
      width: 100%;
      border-collapse: collapse;
    }

    th {
      text-align: left;
      padding: 0.75rem 16px;
      background: rgb(252, 252, 252);
      border-bottom: 2px solid rgb(241, 242, 246);
      font-size: 0.75rem;
      font-weight: 600;
      color: rgb(89, 90, 105);
      text-transform: uppercase;
      letter-spacing: 0.5px;
    }

    td {
      padding: 0.875rem 16px;
      border-bottom: 1px solid rgb(241, 242, 246);
      font-size: 0.875rem;
      color: rgb(43, 45, 63);
    }

    tr:hover {
      background: rgb(252, 252, 252);
    }

    .page {
      display: none;
    }

    .page.active {
      display: block;
    }

    /* Radio button styling - no dark fill */
    input[type="radio"] {
      appearance: none;
      -webkit-appearance: none;
      -moz-appearance: none;
      width: 18px;
      height: 18px;
      border: 2px solid rgb(180, 181, 187);
      border-radius: 50%;
      background: white;
      cursor: pointer;
      position: relative;
      transition: all 0.2s;
    }

    input[type="radio"]:hover {
      border-color: rgb(13, 98, 255);
    }

    input[type="radio"]:checked {
      border-color: rgb(13, 98, 255);
      background: white;
    }

    input[type="radio"]:checked::after {
      content: '';
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      width: 8px;
      height: 8px;
      border-radius: 50%;
      background: rgb(13, 98, 255);
    }

    /* Toggle Switch */
    .toggle-switch {
      position: relative;
      display: inline-block;
      width: 44px;
      height: 24px;
    }

    .toggle-switch input {
      opacity: 0;
      width: 0;
      height: 0;
    }

    .toggle-slider {
      position: absolute;
      cursor: pointer;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background-color: rgb(221, 221, 226);
      transition: 0.3s;
      border-radius: 24px;
    }

    .toggle-slider:before {
      position: absolute;
      content: "";
      height: 18px;
      width: 18px;
      left: 3px;
      bottom: 3px;
      background-color: white;
      transition: 0.3s;
      border-radius: 50%;
    }

    input:checked + .toggle-slider {
      background-color: rgb(13, 98, 255);
    }

    input:checked + .toggle-slider:before {
      transform: translateX(20px);
    }

    /* Checkbox styling */
    input[type="checkbox"]:not(.toggle-switch input) {
      appearance: none;
      -webkit-appearance: none;
      -moz-appearance: none;
      width: 18px;
      height: 18px;
      border: 2px solid rgb(180, 181, 187);
      border-radius: 3px;
      background: white;
      cursor: pointer;
      position: relative;
      transition: all 0.2s;
    }

    input[type="checkbox"]:not(.toggle-switch input):hover {
      border-color: rgb(13, 98, 255);
    }

    input[type="checkbox"]:not(.toggle-switch input):checked {
      border-color: rgb(13, 98, 255);
      background: rgb(13, 98, 255);
    }

    input[type="checkbox"]:not(.toggle-switch input):checked::after {
      content: '';
      position: absolute;
      left: 4px;
      top: 1px;
      width: 5px;
      height: 9px;
      border: solid white;
      border-width: 0 2px 2px 0;
      transform: rotate(45deg);
    }

    .help-button {
      position: fixed;
      bottom: 24px;
      right: 24px;
      width: 56px;
      height: 56px;
      border-radius: 50%;
      background: rgb(13, 98, 255);
      color: white;
      border: none;
      box-shadow: 0 4px 12px rgba(13,98,255,0.3);
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: all 0.3s;
      z-index: 45;
    }

    /* Move help button up when wizard action bar is present */
    .has-wizard-actions .help-button {
      bottom: 110px;
    }

    .help-button:hover {
      background: rgb(10, 78, 204);
      transform: scale(1.05);
    }

    /* Login Modal styles now in src/styles.css for proper cascade order */

    /* Toggle Switch Styles */
    .toggle-switch {
      position: relative;
      display: inline-block;
      width: 48px;
      height: 24px;
    }

    .toggle-switch input {
      opacity: 0;
      width: 0;
      height: 0;
    }

    .toggle-slider {
      position: absolute;
      cursor: pointer;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background-color: rgb(221, 221, 226);
      transition: 0.3s;
      border-radius: 24px;
    }

    .toggle-slider:before {
      position: absolute;
      content: "";
      height: 18px;
      width: 18px;
      left: 3px;
      bottom: 3px;
      background-color: white;
      transition: 0.3s;
      border-radius: 50%;
      box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
    }

    .toggle-switch input:checked + .toggle-slider {
      background-color: rgb(13, 98, 255);
    }

    .toggle-switch input:checked + .toggle-slider:before {
      transform: translateX(24px);
    }

    .toggle-switch input:focus + .toggle-slider {
      box-shadow: 0 0 0 3px rgba(13, 98, 255, 0.1);
    }

    .info-banner {
      background: rgb(245, 248, 255);
      border: 1px solid rgb(194, 216, 255);
      border-radius: 0.25rem;
      padding: 1rem 20px;
      display: flex;
      align-items: start;
      gap: 0.75rem;
      margin-bottom: 1.5rem;
    }

    .info-banner i {
      color: rgb(13, 98, 255);
      flex-shrink: 0;
      margin-top: 0.125rem;
    }

    .info-banner-content {
      flex: 1;
    }

    .info-banner-title {
      font-size: 0.875rem;
      font-weight: 600;
      color: rgb(43, 45, 63);
      margin-bottom: 0.25rem;
    }

    .info-banner-text {
      font-size: 0.8125rem;
      color: rgb(89, 90, 105);
    }
  </style>
</head>
<body>
  <!-- Login Overlay -->
  <div id="login-overlay" class="login-overlay">
    <div class="login-box">
      <div class="login-logo">
        <h1>BUSINESS VOICEEDGE®</h1>
        <p>Auto-Attendant Management</p>
      </div>
      
      <form class="login-form">
        <div class="login-input-group">
          <label for="login-password">Access Code</label>
          <input 
            type="password" 
            id="login-password" 
            placeholder="Enter access code"
            autocomplete="off"
          />
        </div>
        
        <div id="login-error" class="login-error">
          <i data-lucide="alert-circle" style="width: 16px; height: 16px;"></i>
          <span>Invalid access code. Please try again.</span>
        </div>
        
        <button type="submit" class="login-button">
          Access Dashboard
        </button>
      </form>
    </div>
  </div>

  <script>
    // Login functionality - using event listener to ensure proper handling
    window.addEventListener('DOMContentLoaded', function() {
      const form = document.querySelector('.login-form');
      const input = document.getElementById('login-password');
      const overlay = document.getElementById('login-overlay');
      const errorDiv = document.getElementById('login-error');
      const DEMO_PASSWORD = 'demo2026';
      
      if (form) {
        form.addEventListener('submit', function(e) {
          e.preventDefault();
          
          if (input && input.value === DEMO_PASSWORD) {
            // Successful login
            localStorage.setItem('autoAttendantAuth', 'true');
            if (overlay) overlay.classList.add('hidden');
            if (errorDiv) errorDiv.classList.remove('show');
            input.value = '';
          } else {
            // Failed login
            if (errorDiv) errorDiv.classList.add('show');
            if (input) {
              input.value = '';
              input.focus();
              // Shake animation
              input.style.animation = 'shake 0.5s';
              setTimeout(() => {
                input.style.animation = '';
              }, 500);
            }
          }
        });
      }
    });
  </script>
  
  <!-- Global Demo Control Bar (Fixed at Top Center) -->
  <div id="global-demo-bar" style="position: fixed; top: 10px; left: 50%; transform: translateX(-50%); background: rgb(43, 45, 63); color: white; padding: 0.5rem 20px; border-radius: 0.5rem; font-size: 0.75rem; font-weight: 600; display: flex; align-items: center; gap: 1rem; box-shadow: 0 4px 16px rgba(0,0,0,0.4); z-index: 10000;">
    <!-- AI Usage State Toggle (Always Visible) -->
    <div style="display: flex; align-items: center; gap: 0.75rem;">
      <span id="demo-usage-label" style="display: flex; align-items: center; gap: 0.5rem;">
        <i data-lucide="bot" style="width: 16px; height: 16px;"></i>
        <span id="demo-usage-state-text" style="color: rgb(186, 230, 253);">Normal (49%)</span>
      </span>
      <button onclick="toggleDemoUsageState()" style="background: white; color: rgb(43, 45, 63); border: none; padding: 0.375rem 12px; border-radius: 0.375rem; font-size: 0.75rem; font-weight: 600; cursor: pointer; transition: all 0.2s;" onmouseover="this.style.background='rgb(241, 242, 246)'" onmouseout="this.style.background='white'">
        Toggle Minutes
      </button>
    </div>
    
    <!-- FTE Navigation -->
    <div id="demo-fte-control" style="display: none; align-items: center; gap: 0.75rem;">
      <span>FTE</span>
      <button onclick="skipToCompleted()" style="background: white; color: rgb(43, 45, 63); border: none; padding: 0.375rem 12px; border-radius: 0.375rem; font-size: 0.75rem; font-weight: 600; cursor: pointer; transition: all 0.2s;" onmouseover="this.style.background='rgb(241, 242, 246)'" onmouseout="this.style.background='white'">
        Skip to Completed
      </button>
    </div>
    
    <!-- Completed Navigation -->
    <div id="demo-completed-control" style="display: none; align-items: center; gap: 0.75rem;">
      <span>Completed</span>
      <button onclick="resetToFTE()" style="background: white; color: rgb(43, 45, 63); border: none; padding: 0.375rem 12px; border-radius: 0.375rem; font-size: 0.75rem; font-weight: 600; cursor: pointer; transition: all 0.2s;" onmouseover="this.style.background='rgb(241, 242, 246)'" onmouseout="this.style.background='white'">
        Reset to FTE
      </button>
    </div>
  </div>
  
  <!-- Comcast Header -->
  <header class="comcast-header">
    <!-- Top Bar -->
    <div class="comcast-header-top">
      <span>XFINITY</span>
      <span style="border-left: 1px solid rgba(255,255,255,0.3); padding-left: 20px;">COMCAST BUSINESS</span>
    </div>
    
    <!-- Main Bar -->
    <div class="comcast-header-main">
      <div class="comcast-header-main-left">
        <button style="background: none; border: none; color: white; cursor: pointer; padding: 0.25rem;">
          <i data-lucide="menu" style="width: 20px; height: 20px;"></i>
        </button>
      </div>
      
      <!-- Logo Area -->
      <div style="display: flex; align-items: center; gap: 0.75rem; background: #000a73; padding: 0 24px; height: 100%;">
        <div style="display: flex; flex-direction: column; line-height: 1.2;">
          <span style="font-size: 0.6875rem; font-weight: 700; letter-spacing: 0.5px;">COMCAST</span>
          <span style="font-size: 0.6875rem; font-weight: 700; letter-spacing: 0.5px;">BUSINESS</span>
        </div>
        <span style="font-size: 0.8125rem; font-weight: 500; padding-left: 12px; border-left: 1px solid rgba(255,255,255,0.3);">ENTERPRISE SOLUTIONS</span>
      </div>
      
      <div class="comcast-header-main-right">
        <div style="display: flex; align-items: center; gap: 1rem; margin-left: auto;">
          <span style="font-size: 0.875rem; font-weight: 400; color: white;">Hello, Really_Changeds</span>
          <div style="width: 32px; height: 32px; border-radius: 50%; background: white; color: rgb(13, 98, 255); display: flex; align-items: center; justify-content: center;">
            <i data-lucide="user" style="width: 18px; height: 18px;"></i>
          </div>
        </div>
      </div>
    </div>
  </header>

  <!-- Sidebar -->
  <nav class="sidebar" id="sidebar">
    <div class="sidebar-back" id="sidebar-toggle">
      <i data-lucide="chevrons-left" id="sidebar-toggle-icon"></i>
    </div>

    <div class="sidebar-section">
      <a href="#" class="sidebar-item active" data-page="dashboard">
        <div class="sidebar-item-icon">
          <i data-lucide="home"></i>
        </div>
        <span>SITE DASHBOARD</span>
      </a>
      <a href="#" class="sidebar-item">
        <div class="sidebar-item-icon">
          <i data-lucide="users"></i>
        </div>
        <span>USERS</span>
      </a>
      <a href="#" class="sidebar-item">
        <div class="sidebar-item-icon">
          <i data-lucide="list"></i>
        </div>
        <span>NUMBERS AND DEVICES</span>
      </a>
      <a href="#" class="sidebar-item">
        <div class="sidebar-item-icon">
          <i data-lucide="phone-forwarded"></i>
        </div>
        <span>ALTERNATE NUMBERS</span>
      </a>
      <a href="#" class="sidebar-item">
        <div class="sidebar-item-icon">
          <i data-lucide="phone"></i>
        </div>
        <span>CALL HISTORY</span>
      </a>
    </div>

    <div class="sidebar-divider"></div>

    <div class="sidebar-section">
      <div class="sidebar-header">Call Routing</div>
      <a href="#" class="sidebar-item" data-page="attendants">
        <div class="sidebar-item-icon">
          <i data-lucide="git-fork"></i>
        </div>
        <span>MAIN BUSINESS NUMBER</span>
      </a>
      <a href="#" class="sidebar-item">
        <div class="sidebar-item-icon">
          <i data-lucide="phone-call"></i>
        </div>
        <span>CALL HOLD</span>
      </a>
      <a href="#" class="sidebar-item">
        <div class="sidebar-item-icon">
          <i data-lucide="grid-3x3"></i>
        </div>
        <span>AUTOMATED ATTENDANTS</span>
      </a>
      <a href="#" class="sidebar-item">
        <div class="sidebar-item-icon">
          <i data-lucide="users-round"></i>
        </div>
        <span>HUNT GROUPS</span>
      </a>
      <a href="#" class="sidebar-item">
        <div class="sidebar-item-icon">
          <i data-lucide="calendar"></i>
        </div>
        <span>SCHEDULES</span>
      </a>
    </div>

    <div class="sidebar-divider"></div>

    <div class="sidebar-section">
      <a href="#" class="sidebar-item">
        <div class="sidebar-item-icon">
          <i data-lucide="settings"></i>
        </div>
        <span>ADVANCED SETTINGS</span>
      </a>
    </div>

    <div class="sidebar-section" style="margin-top: auto;">
      <a href="#" class="sidebar-item">
        <div class="sidebar-item-icon">
          <i data-lucide="phone-outgoing"></i>
        </div>
        <span>MY PROFILE</span>
      </a>
    </div>
  </nav>

  <!-- Main Content -->
  <main class="main-content">
    <!-- Dashboard Page -->
    <div id="page-dashboard" class="page active" style="position: relative;">
      <!-- Demo Toggle moved to global demo bar -->

      <!-- Top Section -->
      <div style="background: white; padding: 1.5rem 24px 0 24px; margin: -24px -24px 24px -24px; box-shadow: 0 1px 3px rgba(0,0,0,0.1);">
        <!-- BUSINESS VOICEEDGE Header -->
        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1.25rem; padding-bottom: 1.25rem; border-bottom: 1px solid rgb(241, 242, 246);">
          <div style="font-size: 0.875rem; font-weight: 700; letter-spacing: 0.5px; color: rgb(43, 45, 63);">BUSINESS VOICEEDGE®</div>
          <div style="display: flex; align-items: center; gap: 1.5rem;">
            <!-- Search Sites -->
            <div style="display: flex; align-items: center; gap: 0.375rem; cursor: pointer;">
              <i data-lucide="search" style="width: 18px; height: 18px; color: rgb(112, 113, 125);"></i>
              <span style="font-size: 0.875rem; font-weight: 400; color: rgb(43, 45, 63);">Search sites</span>
            </div>
            
            <!-- Learn More -->
            <div style="display: flex; align-items: center; gap: 0.375rem; cursor: pointer;">
              <i data-lucide="help-circle" style="width: 20px; height: 20px; color: rgb(112, 113, 125);"></i>
              <span style="font-size: 0.875rem; font-weight: 400; color: rgb(43, 45, 63);">Learn More</span>
              <i data-lucide="chevron-down" style="width: 16px; height: 16px; color: rgb(112, 113, 125);"></i>
            </div>
          </div>
        </div>
        
        <!-- Location Section with Default Site -->
        <div style="display: flex; align-items: center; gap: 0.75rem; margin-bottom: 1.25rem; justify-content: space-between;">
          <div style="display: flex; align-items: flex-start; gap: 0.75rem; flex: 1;">
            <i data-lucide="map-pin" style="width: 24px; height: 24px; color: rgb(157, 158, 167); margin-top: 0.25rem; flex-shrink: 0;"></i>
            <div style="flex: 1;">
              <div style="display: flex; align-items: center; gap: 0.5rem; margin-bottom: 0.375rem;">
                <h1 style="font-size: 1.5rem; font-weight: 600; color: black; margin: 0; line-height: 1.2;">Primary_BVE_Orion_Portal</h1>
                <i data-lucide="chevron-down" style="width: 20px; height: 20px; color: rgb(112, 113, 125); cursor: pointer;"></i>
              </div>
              <div style="font-size: 0.875rem; color: rgb(112, 113, 125); line-height: 1.4;">1701 John F Kennedy Blvd, Ste Eqp24526-...</div>
            </div>
          </div>
          
          <!-- Default Site -->
          <div style="display: flex; align-items: center; gap: 0.5rem;">
            <span style="font-size: 0.8125rem; font-weight: 700; color: rgb(43, 45, 63); text-transform: uppercase; letter-spacing: 0.5px;">DEFAULT SITE</span>
            <i data-lucide="info" style="width: 20px; height: 20px; color: rgb(13, 98, 255); cursor: pointer;"></i>
          </div>
        </div>

        <!-- Map Section -->
        <div style="width: calc(100% + 48px); height: 215px; background: rgb(245, 248, 255); display: flex; align-items: center; justify-content: center; position: relative; overflow: hidden; margin: 1rem -24px -24px -24px;">
          <img src="./philadelphia-map.png" alt="Philadelphia Map" style="width: 100%; height: 100%; object-fit: cover;" />
          <div style="position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%);">
            <i data-lucide="map-pin" style="width: 32px; height: 32px; color: rgb(13, 98, 255); filter: drop-shadow(0 2px 4px rgba(0,0,0,0.3));"></i>
          </div>
        </div>
      </div>

      <!-- Action Cards -->
      <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 1.25rem; margin-bottom: 1.5rem; margin-top: -67px; position: relative; z-index: 10;">
        <div style="background: white; border-radius: 0.5rem; padding: 1.25rem 16px; text-align: center; cursor: pointer; transition: all 0.2s; border: 1px solid rgb(241, 242, 246); box-shadow: 0 1px 2px rgba(0,0,0,0.05); display: flex; flex-direction: column; align-items: center; justify-content: center; height: 94px;" onmouseover="this.style.boxShadow='0 4px 12px rgba(13,98,255,0.12)'; this.style.borderColor='rgb(125, 211, 252)';" onmouseout="this.style.boxShadow='0 1px 2px rgba(0,0,0,0.05)'; this.style.borderColor='rgb(241, 242, 246)';">
          <div style="width: 32px; height: 32px; display: flex; align-items: center; justify-content: center; margin-bottom: 10px;">
            <i data-lucide="user-plus" style="width: 24px; height: 24px; color: rgb(13, 98, 255); stroke-width: 2.5;"></i>
          </div>
          <div style="font-size: 0.75rem; font-weight: 600; color: rgb(13, 98, 255); text-transform: uppercase; letter-spacing: 0.3px; line-height: 1.3;">Add New User</div>
        </div>
        <div style="background: white; border-radius: 0.5rem; padding: 1.25rem 16px; text-align: center; cursor: pointer; transition: all 0.2s; border: 1px solid rgb(241, 242, 246); box-shadow: 0 1px 2px rgba(0,0,0,0.05); display: flex; flex-direction: column; align-items: center; justify-content: center; height: 94px;" onmouseover="this.style.boxShadow='0 4px 12px rgba(13,98,255,0.12)'; this.style.borderColor='rgb(125, 211, 252)';" onmouseout="this.style.boxShadow='0 1px 2px rgba(0,0,0,0.05)'; this.style.borderColor='rgb(241, 242, 246)';">
          <div style="width: 32px; height: 32px; display: flex; align-items: center; justify-content: center; margin-bottom: 10px;">
            <i data-lucide="lock" style="width: 24px; height: 24px; color: rgb(13, 98, 255); stroke-width: 2.5;"></i>
          </div>
          <div style="font-size: 0.75rem; font-weight: 600; color: rgb(13, 98, 255); text-transform: uppercase; letter-spacing: 0.3px; line-height: 1.3;">Reset Password</div>
        </div>
        <div style="background: white; border-radius: 0.5rem; padding: 1.25rem 16px; text-align: center; cursor: pointer; transition: all 0.2s; border: 1px solid rgb(241, 242, 246); box-shadow: 0 1px 2px rgba(0,0,0,0.05); display: flex; flex-direction: column; align-items: center; justify-content: center; height: 94px;" onmouseover="this.style.boxShadow='0 4px 12px rgba(13,98,255,0.12)'; this.style.borderColor='rgb(125, 211, 252)';" onmouseout="this.style.boxShadow='0 1px 2px rgba(0,0,0,0.05)'; this.style.borderColor='rgb(241, 242, 246)';">
          <div style="width: 32px; height: 32px; display: flex; align-items: center; justify-content: center; margin-bottom: 10px;">
            <i data-lucide="voicemail" style="width: 24px; height: 24px; color: rgb(13, 98, 255); stroke-width: 2.5;"></i>
          </div>
          <div style="font-size: 0.75rem; font-weight: 600; color: rgb(13, 98, 255); text-transform: uppercase; letter-spacing: 0.3px; line-height: 1.3;">Change Voicemail PIN</div>
        </div>
      </div>

      <!-- Google Virtual Assistant Usage (Compact) -->
      <div id="dashboard-ai-usage" onclick="showMainBusinessNumberCallflow()" style="position: relative; background: linear-gradient(135deg, rgb(224, 242, 254) 0%, rgb(186, 230, 253) 100%); border-radius: 0.75rem; padding: 1.5rem; margin-bottom: 1.5rem; border: 1px solid rgb(13, 98, 255); cursor: pointer; transition: all 0.3s;" onmouseover="this.style.boxShadow='0 8px 24px rgba(13,98,255,0.25)'; this.style.transform='translateY(-2px)';" onmouseout="this.style.boxShadow='none'; this.style.transform='translateY(0)';">
        
        <!-- Status Badge (shown in reminder state) -->
        <div data-dashboard-status-badge style="display: none; margin-bottom: 1rem;">
          <span style="display: inline-flex; align-items: center; gap: 0.375rem; padding: 0.375rem 12px; background: white; border-radius: 1rem; font-size: 0.75rem; font-weight: 600; color: rgb(13, 98, 255); text-transform: uppercase; letter-spacing: 0.5px;">
            <i data-lucide="alert-circle" style="width: 14px; height: 14px;"></i>
            Setup Required
          </span>
        </div>

        <div style="display: flex; align-items: center; justify-content: space-between; margin-bottom: 1rem;">
          <div style="display: flex; align-items: center; gap: 0.75rem;">
            <div style="width: 48px; height: 48px; background: white; border-radius: 10px; display: flex; align-items: center; justify-content: center; box-shadow: 0 2px 8px rgba(13,98,255,0.15);">
              <i data-lucide="bot" style="width: 24px; height: 24px; color: rgb(13, 98, 255);"></i>
            </div>
            <div>
              <h3 data-dashboard-title style="font-size: 1.125rem; font-weight: 600; color: rgb(43, 45, 63); margin-bottom: 4px;">Google Virtual Assistant</h3>
              <p data-dashboard-subtitle style="font-size: 0.8125rem; color: rgb(89, 90, 105); margin: 0;">AI-powered call handling • Click to view details</p>
            </div>
          </div>
          <div style="display: flex; flex-direction: column; align-items: flex-end; gap: 0.375rem;">
            <button data-dashboard-add-minutes onclick="event.stopPropagation(); openAddMinutesPage();" style="display: inline-flex; align-items: center; gap: 0.375rem; padding: 0.5rem 16px; background: rgb(13, 98, 255); color: white; border: none; border-radius: 0.375rem; font-size: 0.8125rem; font-weight: 600; cursor: pointer; transition: all 0.2s; position: relative; z-index: 5; white-space: nowrap; flex-shrink: 0; min-width: fit-content;" onmouseover="this.style.background='rgb(10, 78, 204)'" onmouseout="this.style.background='rgb(13, 98, 255)'">
              <i data-lucide="plus-circle" style="width: 16px; height: 16px; flex-shrink: 0;"></i>
              Add Minutes
            </button>
            <!-- CTA (shown in reminder state) -->
            <div data-dashboard-setup-cta-container style="display: none; flex-direction: column; align-items: flex-end; gap: 0.375rem; position: relative; z-index: 5;">
              <button onclick="event.stopPropagation(); showMainBusinessNumberCallflow();" style="display: inline-flex; align-items: center; gap: 0.375rem; padding: 0.5rem 16px; background: white; color: rgb(13, 98, 255); border: 1px solid rgb(13, 98, 255); border-radius: 0.375rem; font-size: 0.8125rem; font-weight: 600; cursor: pointer; transition: all 0.2s;" onmouseover="this.style.background='rgb(240, 247, 255)';" onmouseout="this.style.background='white';">
                <i data-lucide="arrow-right" style="width: 14px; height: 14px;"></i>
                Set up call flow
              </button>
              <span style="font-size: 0.75rem; color: rgb(112, 113, 125);">Takes 10-15 minutes</span>
            </div>
          </div>
        </div>

        <!-- Usage Stats -->
        <div data-dashboard-usage-section>
          <div style="display: flex; align-items: baseline; gap: 0.5rem; margin-bottom: 0.75rem;">
            <span style="font-size: 1.75rem; font-weight: 600; color: rgb(43, 45, 63);">247</span>
            <span style="font-size: 0.875rem; color: rgb(89, 90, 105);">/ 500 minutes used</span>
            <span style="font-size: 0.875rem; font-weight: 600; color: rgb(21, 128, 61); margin-left: auto;">253 remaining</span>
          </div>
          
          <!-- Progress Bar -->
          <div style="width: 100%; height: 8px; background: rgba(255,255,255,0.5); border-radius: 0.25rem; overflow: hidden; margin-bottom: 0.5rem;">
            <div style="width: 49.4%; height: 100%; background: rgb(13, 98, 255); border-radius: 0.25rem;"></div>
          </div>
          
          <div style="display: flex; justify-content: space-between; align-items: center;">
            <span data-dashboard-usage-meta style="font-size: 0.75rem; color: rgb(112, 113, 125);">Add Minutes • 247 / 500 minutes used • 253 remaining</span>
            <div data-dashboard-timestamp style="display: flex; align-items: center; gap: 0.25rem;">
              <i data-lucide="clock" style="width: 12px; height: 12px; color: rgb(157, 158, 167);"></i>
              <span style="font-size: 0.6875rem; color: rgb(112, 113, 125);">Updated: 2:30 PM ET</span>
            </div>
          </div>
        </div>
        <span data-dashboard-billing style="font-size: 0.75rem; color: rgb(112, 113, 125);">Billing cycle: Jan 1 - Jan 31, 2026</span>
      </div>

      <!-- Two Column Layout -->
      <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1.5rem;">
        <!-- Main Business Number -->
        <div class="card">
          <div class="card-body">
            <h3 style="font-size: 1.125rem; font-weight: 700; color: rgb(43, 45, 63); margin-bottom: 1rem;">Main Business Number</h3>
            <div style="font-size: 2rem; font-weight: 400; color: rgb(43, 45, 63); margin-bottom: 1rem;">(445) 223-3050</div>
            <p style="font-size: 0.875rem; color: rgb(89, 90, 105); margin-bottom: 1.5rem; line-height: 1.5;">Below are the incoming call flow settings for your Main Business Number during open and closed hours.</p>
            
            <!-- Open Hours Call Flow -->
            <div style="margin-bottom: 1.5rem;">
              <div style="font-weight: 700; font-size: 0.8125rem; color: rgb(43, 45, 63); margin-bottom: 0.75rem; text-transform: uppercase; letter-spacing: 0.5px;">Open Hours Call Flow</div>
              <div style="font-size: 0.875rem; color: rgb(89, 90, 105); margin-bottom: 0.5rem;">Directs to User or External Number</div>
              <div style="font-size: 0.9375rem; color: rgb(43, 45, 63); margin-bottom: 0.5rem;">(445) 223-3042 Ext. 0956</div>
              <a href="#" style="color: rgb(13, 98, 255); font-size: 0.875rem; text-decoration: none; font-weight: 500;">call queue</a>
            </div>

            <!-- Closed Hours Collapsible -->
            <details style="border-top: 1px solid rgb(241, 242, 246); padding-top: 16px; margin-bottom: 1.25rem;">
              <summary style="font-weight: 700; font-size: 0.8125rem; color: rgb(43, 45, 63); text-transform: uppercase; letter-spacing: 0.5px; cursor: pointer; list-style: none; display: flex; align-items: center; justify-content: space-between; padding: 0.5rem 0;">
                <span>Closed Hours and Holidays Call Flow</span>
                <i data-lucide="chevron-down" style="width: 20px; height: 20px; transition: transform 0.2s;"></i>
              </summary>
              <div style="padding-top: 16px;">
                <div style="font-size: 0.875rem; color: rgb(89, 90, 105); margin-bottom: 0.5rem;">Forwards to Voicemail</div>
                <div style="font-size: 0.9375rem; color: rgb(43, 45, 63);">Main Business Number Voicemail</div>
              </div>
            </details>

            <!-- Change Call Flow Link -->
            <a href="#" style="display: inline-flex; align-items: center; gap: 0.5rem; color: rgb(13, 98, 255); font-size: 0.8125rem; font-weight: 600; text-decoration: none; text-transform: uppercase; letter-spacing: 0.5px;">
              <span>Change Main Number Call Flow</span>
              <i data-lucide="arrow-right" style="width: 16px; height: 16px;"></i>
            </a>
          </div>
        </div>

        <!-- Users Section -->
        <div class="card">
          <div class="card-body">
            <!-- Tabs -->
            <div style="display: flex; border-bottom: 2px solid rgb(241, 242, 246); margin-bottom: 1.25rem;">
              <div style="padding: 0.75rem 16px; font-size: 0.875rem; font-weight: 600; color: rgb(43, 45, 63); border-bottom: 3px solid rgb(13, 98, 255); margin-bottom: -2px; cursor: pointer;">USERS (76)</div>
              <div style="padding: 0.75rem 16px; font-size: 0.875rem; font-weight: 600; color: rgb(157, 158, 167); cursor: pointer;">UNASSIGNED SEATS (6)</div>
            </div>

            <!-- Search -->
            <div style="position: relative; margin-bottom: 1.25rem;">
              <i data-lucide="search" style="position: absolute; left: 12px; top: 50%; transform: translateY(-50%); width: 18px; height: 18px; color: rgb(112, 113, 125); pointer-events: none;"></i>
              <input type="text" placeholder="Search by name or phone number" style="width: 100%; padding: 0.625rem 16px 10px 40px; border: 1px solid rgb(241, 242, 246); border-radius: 0.375rem; font-size: 0.875rem; background-color: rgb(252, 252, 252); outline: none; color: rgb(66, 68, 84);" onfocus="this.style.borderColor='rgb(125, 211, 252)'; this.style.backgroundColor='white';" onblur="this.style.borderColor='rgb(241, 242, 246)'; this.style.backgroundColor='rgb(252, 252, 252)';" />
            </div>

            <!-- User List -->
            <div style="display: flex; flex-direction: column; gap: 0.75rem;">
              <!-- User 1 -->
              <div style="display: flex; align-items: center; padding: 0.75rem; border: 1px solid rgb(241, 242, 246); border-radius: 0.25rem; transition: all 0.15s;" onmouseover="this.style.background='rgb(252, 252, 252)'" onmouseout="this.style.background='white'">
                <div style="width: 40px; height: 40px; border-radius: 50%; background: rgb(66, 68, 84); color: white; display: flex; align-items: center; justify-content: center; font-weight: 600; font-size: 0.875rem; margin-right: 0.75rem;">aa</div>
                <div style="flex: 1;">
                  <div style="display: flex; align-items: center; gap: 0.5rem; margin-bottom: 0.25rem;">
                    <span style="font-size: 0.875rem; font-weight: 600; color: rgb(43, 45, 63);">admin admin</span>
                    <span style="display: inline-block; padding: 0.125rem 8px; background: rgb(224, 242, 254); color: rgb(7, 89, 133); border-radius: 0.25rem; font-size: 0.6875rem; font-weight: 600;">Admin</span>
                    <span style="display: inline-block; padding: 0.125rem 8px; background: rgb(254, 249, 195); color: rgb(133, 77, 14); border-radius: 0.25rem; font-size: 0.6875rem; font-weight: 600;">Pending</span>
                  </div>
                  <div style="font-size: 0.8125rem; color: rgb(112, 113, 125);">Call Queue Agent</div>
                  <div style="font-size: 0.8125rem; color: rgb(13, 98, 255); margin-top: 0.25rem;">
                    <a href="#" style="color: rgb(13, 98, 255); text-decoration: none; font-weight: 500;">Resend invite</a>
                    <span style="margin: 0 6px; color: rgb(180, 181, 187);">•</span>
                    <span style="color: rgb(89, 90, 105);">(445) 223-3046 Ext. 9860</span>
                  </div>
                </div>
              </div>

              <!-- User 2 -->
              <div style="display: flex; align-items: center; padding: 0.75rem; border: 1px solid rgb(241, 242, 246); border-radius: 0.25rem; transition: all 0.15s;" onmouseover="this.style.background='rgb(252, 252, 252)'" onmouseout="this.style.background='white'">
                <div style="width: 40px; height: 40px; border-radius: 50%; background: rgb(66, 68, 84); color: white; display: flex; align-items: center; justify-content: center; font-weight: 600; font-size: 0.875rem; margin-right: 0.75rem;">cv</div>
                <div style="flex: 1;">
                  <div style="display: flex; align-items: center; gap: 0.5rem; margin-bottom: 0.25rem;">
                    <span style="font-size: 0.875rem; font-weight: 600; color: rgb(43, 45, 63);">car venue</span>
                    <span style="display: inline-block; padding: 0.125rem 8px; background: rgb(224, 242, 254); color: rgb(7, 89, 133); border-radius: 0.25rem; font-size: 0.6875rem; font-weight: 600;">Admin</span>
                    <span style="display: inline-block; padding: 0.125rem 8px; background: rgb(254, 249, 195); color: rgb(133, 77, 14); border-radius: 0.25rem; font-size: 0.6875rem; font-weight: 600;">Pending</span>
                  </div>
                  <div style="font-size: 0.8125rem; color: rgb(13, 98, 255); margin-top: 0.25rem;">
                    <a href="#" style="color: rgb(13, 98, 255); text-decoration: none; font-weight: 500;">Resend invite</a>
                    <span style="margin: 0 6px; color: rgb(180, 181, 187);">•</span>
                    <span style="color: rgb(89, 90, 105);">(445) 223-3057 Ext. 8784</span>
                  </div>
                </div>
              </div>

              <!-- User 3 -->
              <div style="display: flex; align-items: center; padding: 0.75rem; border: 1px solid rgb(241, 242, 246); border-radius: 0.25rem; transition: all 0.15s;" onmouseover="this.style.background='rgb(252, 252, 252)'" onmouseout="this.style.background='white'">
                <div style="width: 40px; height: 40px; border-radius: 50%; background: rgb(66, 68, 84); color: white; display: flex; align-items: center; justify-content: center; font-weight: 600; font-size: 0.875rem; margin-right: 0.75rem;">vv</div>
                <div style="flex: 1;">
                  <div style="display: flex; align-items: center; gap: 0.5rem; margin-bottom: 0.25rem;">
                    <span style="font-size: 0.875rem; font-weight: 600; color: rgb(43, 45, 63);">v2 v2</span>
                    <span style="display: inline-block; padding: 0.125rem 8px; background: rgb(224, 242, 254); color: rgb(7, 89, 133); border-radius: 0.25rem; font-size: 0.6875rem; font-weight: 600;">Admin</span>
                    <span style="display: inline-block; padding: 0.125rem 8px; background: rgb(254, 249, 195); color: rgb(133, 77, 14); border-radius: 0.25rem; font-size: 0.6875rem; font-weight: 600;">Pending</span>
                  </div>
                  <div style="font-size: 0.8125rem; color: rgb(13, 98, 255); margin-top: 0.25rem;">
                    <a href="#" style="color: rgb(13, 98, 255); text-decoration: none; font-weight: 500;">Resend invite</a>
                    <span style="margin: 0 6px; color: rgb(180, 181, 187);">•</span>
                    <span style="color: rgb(89, 90, 105);">(445) 223-3052 Ext. 7847</span>
                  </div>
                </div>
              </div>

              <!-- User 4 -->
              <div style="display: flex; align-items: center; padding: 0.75rem; border: 1px solid rgb(241, 242, 246); border-radius: 0.25rem; transition: all 0.15s;" onmouseover="this.style.background='rgb(252, 252, 252)'" onmouseout="this.style.background='white'">
                <div style="width: 40px; height: 40px; border-radius: 50%; background: rgb(66, 68, 84); color: white; display: flex; align-items: center; justify-content: center; font-weight: 600; font-size: 0.875rem; margin-right: 0.75rem;">an</div>
                <div style="flex: 1;">
                  <div style="display: flex; align-items: center; gap: 0.5rem; margin-bottom: 0.25rem;">
                    <span style="font-size: 0.875rem; font-weight: 600; color: rgb(43, 45, 63);">add new</span>
                    <span style="display: inline-block; padding: 0.125rem 8px; background: rgb(224, 242, 254); color: rgb(7, 89, 133); border-radius: 0.25rem; font-size: 0.6875rem; font-weight: 600;">Admin</span>
                  </div>
                  <div style="font-size: 0.8125rem; color: rgb(112, 113, 125);">Call Queue Agent</div>
                  <div style="font-size: 0.8125rem; color: rgb(89, 90, 105); margin-top: 0.25rem;">(445) 223-3039 Ext. 3423</div>
                </div>
              </div>

              <!-- User 5 -->
              <div style="display: flex; align-items: center; padding: 0.75rem; border: 1px solid rgb(241, 242, 246); border-radius: 0.25rem; transition: all 0.15s;" onmouseover="this.style.background='rgb(252, 252, 252)'" onmouseout="this.style.background='white'">
                <div style="width: 40px; height: 40px; border-radius: 50%; background: rgb(66, 68, 84); color: white; display: flex; align-items: center; justify-content: center; font-weight: 600; font-size: 0.875rem; margin-right: 0.75rem;">aa</div>
                <div style="flex: 1;">
                  <div style="display: flex; align-items: center; gap: 0.5rem; margin-bottom: 0.25rem;">
                    <span style="font-size: 0.875rem; font-weight: 600; color: rgb(43, 45, 63);">admin01 admin_01</span>
                    <span style="display: inline-block; padding: 0.125rem 8px; background: rgb(224, 242, 254); color: rgb(7, 89, 133); border-radius: 0.25rem; font-size: 0.6875rem; font-weight: 600;">Admin</span>
                  </div>
                  <div style="font-size: 0.8125rem; color: rgb(89, 90, 105); margin-top: 0.25rem;">(445) 223-3041 Ext. 2156</div>
                </div>
              </div>
            </div>

            <!-- All Users Link -->
            <div style="margin-top: 20px; text-align: center;">
              <a href="#" style="display: inline-flex; align-items: center; gap: 0.5rem; color: rgb(13, 98, 255); font-size: 0.8125rem; font-weight: 600; text-decoration: none; text-transform: uppercase; letter-spacing: 0.5px;">
                <span>All Users</span>
                <i data-lucide="arrow-right" style="width: 16px; height: 16px;"></i>
              </a>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Automated Attendants Page -->
    <div id="page-attendants" class="page">
      <!-- Naming Setup Modal for Existing Customers -->
      <div id="naming-setup-modal" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0, 0, 0, 0.6); z-index: 10000; backdrop-filter: blur(4px);">
        <div style="display: flex; align-items: center; justify-content: center; min-height: 100vh; padding: 2rem;">
          <div style="background: white; border-radius: 0.75rem; max-width: 640px; width: 100%; box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3); position: relative;">
            <!-- Close Button -->
            <button onclick="dismissNamingModal()" style="position: absolute; top: 1rem; right: 1rem; width: 32px; height: 32px; border-radius: 0.375rem; background: rgba(255, 255, 255, 0.9); border: 1px solid rgb(221, 221, 226); display: flex; align-items: center; justify-content: center; cursor: pointer; transition: all 0.2s; z-index: 10;" onmouseover="this.style.background='rgb(249, 250, 251)'; this.style.borderColor='rgb(180, 181, 187)';" onmouseout="this.style.background='rgba(255, 255, 255, 0.9)'; this.style.borderColor='rgb(221, 221, 226)';" aria-label="Close modal">
              <i data-lucide="x" style="width: 18px; height: 18px; color: rgb(112, 113, 125);"></i>
            </button>
            
            <!-- Header -->
            <div style="background: rgb(249, 250, 251); padding: 1.5rem 1.75rem; border-radius: 0.75rem 0.75rem 0 0; border-bottom: 1px solid rgb(229, 229, 234); text-align: center;">
              <div style="width: 56px; height: 56px; background: white; border-radius: 50%; display: flex; align-items: center; justify-content: center; margin: 0 auto 0.75rem; box-shadow: 0 4px 12px rgba(13, 98, 255, 0.2); border: 1px solid rgb(241, 242, 246);">
                <i data-lucide="bot" style="width: 28px; height: 28px; color: rgb(13, 98, 255);"></i>
              </div>
              <h2 style="font-size: 1.25rem; font-weight: 700; color: rgb(43, 45, 63); margin-bottom: 0.375rem;">Before You Begin</h2>
              <p style="font-size: 0.875rem; color: rgb(89, 90, 105); margin: 0;">Help your Google Virtual Assistant work smarter</p>
            </div>
            
            <!-- Content -->
            <div style="padding: 1.5rem 1.75rem;">
              <!-- Intro -->
              <div style="background: rgb(254, 249, 231); border: 2px solid rgb(253, 224, 71); border-radius: 0.5rem; padding: 0.875rem 1rem; margin-bottom: 1.25rem;">
                <div style="display: flex; align-items: start; gap: 0.625rem;">
                  <i data-lucide="alert-circle" style="width: 18px; height: 18px; color: rgb(180, 83, 9); flex-shrink: 0; margin-top: 0.125rem;"></i>
                  <div>
                    <div style="font-size: 0.8125rem; font-weight: 600; color: rgb(120, 53, 15); margin-bottom: 0.25rem;">Action Required</div>
                    <p style="font-size: 0.75rem; color: rgb(146, 64, 14); line-height: 1.5; margin: 0;">
                      Your Google Virtual Assistant uses the names you've configured. Well-named resources help the AI route calls accurately.
                    </p>
                  </div>
                </div>
              </div>
              
              <!-- What to Review -->
              <h3 style="font-size: 0.875rem; font-weight: 600; color: rgb(43, 45, 63); margin-bottom: 0.875rem;">Please Review These Names</h3>
              
              <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 0.75rem; margin-bottom: 1.25rem;">
                <!-- Hunt Groups -->
                <div style="border: 1px solid rgb(229, 229, 234); border-radius: 0.375rem; padding: 0.75rem;">
                  <div style="display: flex; align-items: center; gap: 0.5rem; margin-bottom: 0.5rem;">
                    <i data-lucide="users" style="width: 16px; height: 16px; color: rgb(13, 98, 255);"></i>
                    <h4 style="font-size: 0.75rem; font-weight: 600; color: rgb(43, 45, 63); margin: 0;">Hunt Groups</h4>
                  </div>
                  <div style="font-size: 0.6875rem; line-height: 1.4;">
                    <div style="font-weight: 600; color: rgb(220, 38, 38); margin-bottom: 0.25rem;">❌ Avoid</div>
                    <div style="color: rgb(112, 113, 125); margin-bottom: 0.375rem;">Hunt Group 1</div>
                    <div style="font-weight: 600; color: rgb(34, 197, 94); margin-bottom: 0.25rem;">✓ Better</div>
                    <div style="color: rgb(112, 113, 125);">Sales Team</div>
                  </div>
                </div>
                
                <!-- Automated Attendants -->
                <div style="border: 1px solid rgb(229, 229, 234); border-radius: 0.375rem; padding: 0.75rem;">
                  <div style="display: flex; align-items: center; gap: 0.5rem; margin-bottom: 0.5rem;">
                    <i data-lucide="phone-forwarded" style="width: 16px; height: 16px; color: rgb(13, 98, 255);"></i>
                    <h4 style="font-size: 0.75rem; font-weight: 600; color: rgb(43, 45, 63); margin: 0;">Auto Attendants</h4>
                  </div>
                  <div style="font-size: 0.6875rem; line-height: 1.4;">
                    <div style="font-weight: 600; color: rgb(220, 38, 38); margin-bottom: 0.25rem;">❌ Avoid</div>
                    <div style="color: rgb(112, 113, 125); margin-bottom: 0.375rem;">AA1</div>
                    <div style="font-weight: 600; color: rgb(34, 197, 94); margin-bottom: 0.25rem;">✓ Better</div>
                    <div style="color: rgb(112, 113, 125);">Customer Service</div>
                  </div>
                </div>
                
                <!-- Users/Devices -->
                <div style="border: 1px solid rgb(229, 229, 234); border-radius: 0.375rem; padding: 0.75rem;">
                  <div style="display: flex; align-items: center; gap: 0.5rem; margin-bottom: 0.5rem;">
                    <i data-lucide="user" style="width: 16px; height: 16px; color: rgb(13, 98, 255);"></i>
                    <h4 style="font-size: 0.75rem; font-weight: 600; color: rgb(43, 45, 63); margin: 0;">Users & Devices</h4>
                  </div>
                  <div style="font-size: 0.6875rem; line-height: 1.4;">
                    <div style="font-weight: 600; color: rgb(220, 38, 38); margin-bottom: 0.25rem;">❌ Avoid</div>
                    <div style="color: rgb(112, 113, 125); margin-bottom: 0.375rem;">User123</div>
                    <div style="font-weight: 600; color: rgb(34, 197, 94); margin-bottom: 0.25rem;">✓ Better</div>
                    <div style="color: rgb(112, 113, 125);">John Smith</div>
                  </div>
                </div>
              </div>
              
              <!-- Why This Matters -->
              <div style="background: rgb(245, 248, 255); border-radius: 0.375rem; padding: 0.75rem; margin-bottom: 1.25rem;">
                <div style="display: flex; gap: 0.625rem;">
                  <i data-lucide="lightbulb" style="width: 16px; height: 16px; color: rgb(13, 98, 255); flex-shrink: 0; margin-top: 0.125rem;"></i>
                  <div>
                    <div style="font-size: 0.75rem; font-weight: 600; color: rgb(43, 45, 63); margin-bottom: 0.25rem;">Why This Matters</div>
                    <p style="font-size: 0.6875rem; color: rgb(89, 90, 105); line-height: 1.5; margin: 0;">
                      Clear, descriptive names help the AI understand your business structure and make intelligent routing decisions.
                    </p>
                  </div>
                </div>
              </div>
              
              <!-- Actions -->
              <div style="display: flex; gap: 0.625rem;">
                <button onclick="dismissNamingModal()" style="flex: 1; padding: 0.75rem; background: white; color: rgb(112, 113, 125); border: 2px solid rgb(221, 221, 226); border-radius: 0.375rem; font-size: 0.8125rem; font-weight: 600; cursor: pointer; transition: all 0.2s;" onmouseover="this.style.background='rgb(249, 250, 251)'; this.style.borderColor='rgb(180, 181, 187)';" onmouseout="this.style.background='white'; this.style.borderColor='rgb(221, 221, 226)';">
                  I'll Do This Later
                </button>
                <button onclick="dismissNamingModalAndProceed()" style="flex: 1; padding: 0.75rem; background: rgb(13, 98, 255); color: white; border: none; border-radius: 0.375rem; font-size: 0.8125rem; font-weight: 600; cursor: pointer; transition: all 0.2s; box-shadow: 0 2px 8px rgba(13, 98, 255, 0.3);" onmouseover="this.style.background='rgb(10, 78, 204)'; this.style.transform='translateY(-1px)'; this.style.boxShadow='0 4px 12px rgba(13, 98, 255, 0.4)';" onmouseout="this.style.background='rgb(13, 98, 255)'; this.style.transform='translateY(0)'; this.style.boxShadow='0 2px 8px rgba(13, 98, 255, 0.3)';">
                  Got It, Continue
                </button>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- First Time Experience -->
      <div id="fte-callflow" style="display: block; position: relative;">
        <!-- Demo buttons moved to global demo bar -->
        
        <div class="page-header">
          <div>
            <div class="page-title">MAIN BUSINESS NUMBER</div>
            <div style="display: flex; flex-direction: column; gap: 0.35rem; margin: 0.75rem 0 0 0;">
              <div style="display: flex; align-items: center; gap: 0.5rem;">
                <div>
                  <div style="font-size: 1.125rem; font-weight: 600; color: rgb(43, 45, 63); margin-bottom: 2px;">(445) 223-3000</div>
                </div>
              </div>
              <p style="color: rgb(112, 113, 125); font-size: 0.8125rem; margin: 0;">Set up how calls to your main business number are handled</p>
            </div>
          </div>
        </div>

        <div class="card" style="max-width: 900px; margin: 0 auto; text-align: center; padding: 2.5rem 40px 3rem;">
          <!-- Hero Section -->
          <div style="width: 64px; height: 64px; background: rgb(224, 242, 254); border-radius: 50%; display: flex; align-items: center; justify-content: center; margin: 0 auto 1.25rem;">
            <i data-lucide="bot" style="width: 32px; height: 32px; color: rgb(13, 98, 255);"></i>
          </div>
          
          <h2 style="font-size: 1.625rem; font-weight: 600; color: rgb(43, 45, 63); margin-bottom: 0.75rem;">Set Up Your Call Flow with Google Virtual Assistant</h2>
          
          <p style="font-size: 1rem; color: rgb(112, 113, 125); line-height: 1.6; margin-bottom: 2.5rem; max-width: 680px; margin-left: auto; margin-right: auto;">
            Configure an intelligent AI-powered call handling system with backup call routing to ensure every caller reaches the right destination.
          </p>

          <!-- What You'll Configure Section -->
          <div style="text-align: left; margin-bottom: 2rem;">
            <h3 style="font-size: 1rem; font-weight: 600; color: rgb(43, 45, 63); margin-bottom: 1.25rem; text-align: center;">What You'll Configure</h3>
            
            <div style="display: flex; flex-direction: column; gap: 1rem;">
              <!-- Step 1 -->
              <div style="display: flex; gap: 1rem; padding: 1rem; background: rgb(252, 252, 252); border-radius: 0.5rem; border: 1px solid rgb(241, 242, 246);">
                <div style="width: 40px; height: 40px; background: rgb(224, 242, 254); border-radius: 0.5rem; display: flex; align-items: center; justify-content: center; flex-shrink: 0;">
                  <i data-lucide="calendar-clock" style="width: 20px; height: 20px; color: rgb(13, 98, 255);"></i>
                </div>
                <div>
                  <h4 style="font-size: 0.875rem; font-weight: 600; color: rgb(43, 45, 63); margin: 0 0 0.375rem 0;">Business Hours & Schedules</h4>
                  <p style="font-size: 0.8125rem; color: rgb(112, 113, 125); line-height: 1.5; margin: 0;">Define your open hours, closed hours, and holidays. These settings apply to both your Google Virtual Assistant and your backup call flow.</p>
                </div>
              </div>

              <!-- Step 2 -->
              <div style="display: flex; gap: 1rem; padding: 1rem; background: rgb(252, 252, 252); border-radius: 0.5rem; border: 1px solid rgb(241, 242, 246);">
                <div style="width: 40px; height: 40px; background: rgb(224, 242, 254); border-radius: 0.5rem; display: flex; align-items: center; justify-content: center; flex-shrink: 0;">
                  <i data-lucide="phone-forwarded" style="width: 20px; height: 20px; color: rgb(13, 98, 255);"></i>
                </div>
                <div>
                  <h4 style="font-size: 0.875rem; font-weight: 600; color: rgb(43, 45, 63); margin: 0 0 0.375rem 0;">Backup Call Flow Routing</h4>
                  <p style="font-size: 0.8125rem; color: rgb(112, 113, 125); line-height: 1.5; margin: 0;">Set up where calls should route when Google Virtual Assistant is turned off or when AI minutes are depleted. This is your default call handling.</p>
                </div>
              </div>

              <!-- Step 3 -->
              <div style="display: flex; gap: 1rem; padding: 1rem; background: rgb(252, 252, 252); border-radius: 0.5rem; border: 1px solid rgb(241, 242, 246);">
                <div style="width: 40px; height: 40px; background: rgb(224, 242, 254); border-radius: 0.5rem; display: flex; align-items: center; justify-content: center; flex-shrink: 0;">
                  <i data-lucide="shield-alert" style="width: 20px; height: 20px; color: rgb(13, 98, 255);"></i>
                </div>
                <div>
                  <h4 style="font-size: 0.875rem; font-weight: 600; color: rgb(43, 45, 63); margin: 0 0 0.375rem 0;">Failover Configuration (CFNR)</h4>
                  <p style="font-size: 0.8125rem; color: rgb(112, 113, 125); line-height: 1.5; margin: 0;">Configure Call Forward No Reply routing for situations when the AI assistant fails or has network issues.</p>
                </div>
              </div>

              <!-- Step 4 -->
              <div style="display: flex; gap: 1rem; padding: 1rem; background: rgb(252, 252, 252); border-radius: 0.5rem; border: 1px solid rgb(241, 242, 246);">
                <div style="width: 40px; height: 40px; background: rgb(224, 242, 254); border-radius: 0.5rem; display: flex; align-items: center; justify-content: center; flex-shrink: 0;">
                  <i data-lucide="bot" style="width: 20px; height: 20px; color: rgb(13, 98, 255);"></i>
                </div>
                <div>
                  <h4 style="font-size: 0.875rem; font-weight: 600; color: rgb(43, 45, 63); margin: 0 0 0.375rem 0;">Google Virtual Assistant Setup</h4>
                  <p style="font-size: 0.8125rem; color: rgb(112, 113, 125); line-height: 1.5; margin: 0;">Complete your configuration by launching the Google Assistant portal to customize your AI call handling experience.</p>
                </div>
              </div>
            </div>
          </div>

          <!-- Info Box -->
          <div style="background: rgb(245, 248, 255); border-left: 3px solid rgb(13, 98, 255); border-radius: 0.375rem; padding: 1rem 1.25rem; margin-bottom: 2rem; text-align: left;">
            <div style="display: flex; align-items: start; gap: 0.75rem;">
              <i data-lucide="info" style="width: 18px; height: 18px; color: rgb(13, 98, 255); flex-shrink: 0; margin-top: 0.125rem;"></i>
              <p style="font-size: 0.8125rem; color: rgb(43, 45, 63); line-height: 1.5; margin: 0;">
                <strong>How This Works:</strong> Google Virtual Assistant will be your primary call handler when activated. The backup call flow you configure will automatically take over when the assistant is turned off, when AI minutes run out, or if there's a technical issue.
              </p>
            </div>
          </div>

          <!-- CTA Button -->
          <button class="action-button-primary" onclick="startCallFlowSetup()" style="font-size: 0.9375rem; padding: 1rem 48px; font-weight: 600; letter-spacing: 0.5px; border-radius: 0.375rem; box-shadow: 0 4px 12px rgba(13, 98, 255, 0.25); transition: all 0.2s ease; display: inline-flex; align-items: center; gap: 0.625rem;" onmouseover="this.style.transform='translateY(-2px)'; this.style.boxShadow='0 6px 20px rgba(13, 98, 255, 0.35)';" onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='0 4px 12px rgba(13, 98, 255, 0.25)';">
            <span>BEGIN CONFIGURATION</span>
            <i data-lucide="arrow-right" style="width: 20px; height: 20px; display: block;"></i>
          </button>
          
          <p style="font-size: 0.8125rem; color: rgb(157, 158, 167); margin-top: 1rem;">Takes approximately 10-15 minutes to complete</p>
        </div>
      </div>

      <!-- Setup: Time Zone Selection -->
      <div id="setup-timezone" style="display: none;">
        <!-- Wizard Header -->
        <div style="background: white; padding: 1.5rem 24px 20px 24px; margin: -24px -24px 24px -24px; box-shadow: 0 1px 3px rgba(0,0,0,0.1);">
          <div style="display: flex; align-items: center; justify-content: space-between; margin-bottom: 1.5rem;">
            <h1 style="font-size: 1.25rem; font-weight: 600; color: rgb(43, 45, 63); margin: 0;">Call Flow Setup</h1>
            <button onclick="backToFTE()" style="background: none; border: 1px solid rgb(221, 221, 226); color: rgb(13, 98, 255); padding: 0.5rem 20px; border-radius: 0.25rem; font-size: 0.8125rem; font-weight: 600; text-transform: uppercase; letter-spacing: 0.5px; cursor: pointer; transition: all 0.15s;" onmouseover="this.style.background='rgb(252, 252, 252)'" onmouseout="this.style.background='none'">
              SAVE & EXIT
            </button>
          </div>

          <!-- Wizard Steps -->
          <div style="display: flex; align-items: center; gap: 0; position: relative;">
            <!-- Step 1 - Active -->
            <div style="flex: 1; display: flex; align-items: center; gap: 0.5rem; position: relative;">
              <div style="width: 32px; height: 32px; border-radius: 50%; background: rgb(13, 98, 255); color: white; display: flex; align-items: center; justify-content: center; font-size: 0.875rem; font-weight: 600; z-index: 2; position: relative;">1</div>
              <span style="font-size: 0.875rem; font-weight: 600; color: rgb(13, 98, 255); position: relative; z-index: 2; background: white; padding-left: 0.5rem; padding-right: 0.5rem;">Schedules</span>
              <div style="position: absolute; left: 16px; top: 15px; height: 2px; background: rgb(241, 242, 246); width: 100%; z-index: 0;"></div>
            </div>

            <!-- Step 2 - Inactive -->
            <div style="flex: 1; display: flex; align-items: center; gap: 0.5rem; position: relative;">
              <div style="width: 32px; height: 32px; border-radius: 50%; background: rgb(249, 249, 250); border: 2px solid rgb(221, 221, 226); color: rgb(180, 181, 187); display: flex; align-items: center; justify-content: center; font-size: 0.875rem; font-weight: 600; z-index: 2; position: relative;">2</div>
              <span style="font-size: 0.875rem; font-weight: 500; color: rgb(180, 181, 187); position: relative; z-index: 2; background: white; padding-left: 0.5rem; padding-right: 0.5rem;">Open Hours</span>
              <div style="position: absolute; left: 16px; top: 15px; height: 2px; background: rgb(241, 242, 246); width: 100%; z-index: 0;"></div>
            </div>

            <!-- Step 3 - Inactive -->
            <div style="flex: 1; display: flex; align-items: center; gap: 0.5rem; position: relative;">
              <div style="width: 32px; height: 32px; border-radius: 50%; background: rgb(249, 249, 250); border: 2px solid rgb(221, 221, 226); color: rgb(180, 181, 187); display: flex; align-items: center; justify-content: center; font-size: 0.875rem; font-weight: 600; z-index: 2; position: relative;">3</div>
              <span style="font-size: 0.875rem; font-weight: 500; color: rgb(180, 181, 187); position: relative; z-index: 2; background: white; padding-left: 0.5rem; padding-right: 0.5rem;">Closed Hours</span>
              <div style="position: absolute; left: 16px; top: 15px; height: 2px; background: rgb(241, 242, 246); width: 100%; z-index: 0;"></div>
            </div>

            <!-- Step 4 - Inactive -->
            <div style="flex: 1; display: flex; align-items: center; gap: 0.5rem; position: relative;">
              <div style="width: 32px; height: 32px; border-radius: 50%; background: rgb(249, 249, 250); border: 2px solid rgb(221, 221, 226); color: rgb(180, 181, 187); display: flex; align-items: center; justify-content: center; font-size: 0.875rem; font-weight: 600; z-index: 2; position: relative;">4</div>
              <span style="font-size: 0.875rem; font-weight: 500; color: rgb(180, 181, 187); position: relative; z-index: 2; background: white; padding-left: 0.5rem; padding-right: 0.5rem;">Failover</span>
              <div style="position: absolute; left: 16px; top: 15px; height: 2px; background: rgb(241, 242, 246); width: 100%; z-index: 0;"></div>
            </div>

            <!-- Step 5 - Inactive -->
            <div style="flex: 1; display: flex; align-items: center; gap: 0.5rem; position: relative;">
              <div style="width: 32px; height: 32px; border-radius: 50%; background: rgb(249, 249, 250); border: 2px solid rgb(221, 221, 226); color: rgb(180, 181, 187); display: flex; align-items: center; justify-content: center; font-size: 0.875rem; font-weight: 600; z-index: 2; position: relative;">5</div>
              <span style="font-size: 0.875rem; font-weight: 500; color: rgb(180, 181, 187); position: relative; z-index: 2; background: white; padding-left: 0.5rem; padding-right: 0.5rem;">Virtual Assistant</span>
            </div>
          </div>
        </div>

        <!-- Tabs -->
        <div style="border-bottom: 2px solid rgb(241, 242, 246); margin-bottom: 2rem; display: flex; gap: 1.5rem;">
          <div onclick="navigateToTab('timezone')" style="padding: 0.75rem 0; font-size: 0.875rem; font-weight: 600; color: rgb(43, 45, 63); border-bottom: 3px solid rgb(13, 98, 255); margin-bottom: -2px; cursor: pointer; transition: color 0.2s;">TIME ZONE</div>
          <div onclick="navigateToTab('openhours')" style="padding: 0.75rem 0; font-size: 0.875rem; font-weight: 600; color: rgb(180, 181, 187); cursor: pointer; transition: color 0.2s; border-bottom: 3px solid transparent; margin-bottom: -2px;" onmouseover="this.style.color='rgb(13, 98, 255)'" onmouseout="if(this.style.borderBottomColor === 'transparent') this.style.color='rgb(180, 181, 187)'">OPEN HOURS</div>
          <div onclick="navigateToTab('holidays')" style="padding: 0.75rem 0; font-size: 0.875rem; font-weight: 600; color: rgb(180, 181, 187); cursor: pointer; transition: color 0.2s; border-bottom: 3px solid transparent; margin-bottom: -2px;" onmouseover="this.style.color='rgb(13, 98, 255)'" onmouseout="if(this.style.borderBottomColor === 'transparent') this.style.color='rgb(180, 181, 187)'">HOLIDAYS</div>
        </div>

        <!-- Content -->
        <div style="max-width: 800px;">
          <h2 style="font-size: 1.25rem; font-weight: 600; color: rgb(43, 45, 63); margin-bottom: 1.5rem;">Select the time zone that applies to this call flow</h2>

          <!-- Time Zone Options -->
          <div style="background: white; border: 1px solid rgb(241, 242, 246); border-radius: 0.25rem;">
            <label style="display: flex; align-items: center; padding: 1rem 20px; border-bottom: 1px solid rgb(241, 242, 246); cursor: pointer; transition: background 0.15s;" onmouseover="this.style.background='rgb(252, 252, 252)'" onmouseout="this.style.background='white'">
              <input type="radio" name="timezone" value="GMT-02:30" style="margin-right: 16px; width: 18px; height: 18px; cursor: pointer;">
              <span style="font-size: 0.875rem; color: rgb(43, 45, 63);">(GMT-02:30) (Canada) Newfoundland</span>
            </label>

            <label style="display: flex; align-items: center; padding: 1rem 20px; border-bottom: 1px solid rgb(241, 242, 246); cursor: pointer; transition: background 0.15s;" onmouseover="this.style.background='rgb(252, 252, 252)'" onmouseout="this.style.background='white'">
              <input type="radio" name="timezone" value="GMT-03:00" style="margin-right: 16px; width: 18px; height: 18px; cursor: pointer;">
              <span style="font-size: 0.875rem; color: rgb(43, 45, 63);">(GMT-03:00) (Canada) Atlantic Time</span>
            </label>

            <label style="display: flex; align-items: center; padding: 1rem 20px; border-bottom: 1px solid rgb(241, 242, 246); cursor: pointer; transition: background 0.15s;" onmouseover="this.style.background='rgb(252, 252, 252)'" onmouseout="this.style.background='white'">
              <input type="radio" name="timezone" value="GMT-04:00-CA" style="margin-right: 16px; width: 18px; height: 18px; cursor: pointer;">
              <span style="font-size: 0.875rem; color: rgb(43, 45, 63);">(GMT-04:00) (Canada) Eastern Time</span>
            </label>

            <label style="display: flex; align-items: center; padding: 1rem 20px; border-bottom: 1px solid rgb(241, 242, 246); cursor: pointer; transition: background 0.15s;" onmouseover="this.style.background='rgb(252, 252, 252)'" onmouseout="this.style.background='white'">
              <input type="radio" name="timezone" value="GMT-04:00-US" style="margin-right: 16px; width: 18px; height: 18px; cursor: pointer;">
              <span style="font-size: 0.875rem; color: rgb(43, 45, 63);">(GMT-04:00) (US) Eastern Time</span>
            </label>

            <label style="display: flex; align-items: center; padding: 1rem 20px; border-bottom: 1px solid rgb(241, 242, 246); cursor: pointer; transition: background 0.15s; background: rgb(224, 242, 254);" onmouseover="this.style.background='rgb(186, 230, 253)'" onmouseout="this.style.background='rgb(224, 242, 254)'">
              <input type="radio" name="timezone" value="GMT-04:00-IN" checked style="margin-right: 16px; width: 18px; height: 18px; cursor: pointer;">
              <span style="font-size: 0.875rem; color: rgb(43, 45, 63); font-weight: 500;">(GMT-04:00) US Indiana</span>
            </label>

            <label style="display: flex; align-items: center; padding: 1rem 20px; border-bottom: 1px solid rgb(241, 242, 246); cursor: pointer; transition: background 0.15s;" onmouseover="this.style.background='rgb(252, 252, 252)'" onmouseout="this.style.background='white'">
              <input type="radio" name="timezone" value="GMT-05:00-CA" style="margin-right: 16px; width: 18px; height: 18px; cursor: pointer;">
              <span style="font-size: 0.875rem; color: rgb(43, 45, 63);">(GMT-05:00) (Canada) Central Time</span>
            </label>

            <label style="display: flex; align-items: center; padding: 1rem 20px; border-bottom: 1px solid rgb(241, 242, 246); cursor: pointer; transition: background 0.15s;" onmouseover="this.style.background='rgb(252, 252, 252)'" onmouseout="this.style.background='white'">
              <input type="radio" name="timezone" value="GMT-05:00-US" style="margin-right: 16px; width: 18px; height: 18px; cursor: pointer;">
              <span style="font-size: 0.875rem; color: rgb(43, 45, 63);">(GMT-05:00) (US) Central Time</span>
            </label>

            <label style="display: flex; align-items: center; padding: 1rem 20px; border-bottom: 1px solid rgb(241, 242, 246); cursor: pointer; transition: background 0.15s;" onmouseover="this.style.background='rgb(252, 252, 252)'" onmouseout="this.style.background='white'">
              <input type="radio" name="timezone" value="GMT-06:00-CA" style="margin-right: 16px; width: 18px; height: 18px; cursor: pointer;">
              <span style="font-size: 0.875rem; color: rgb(43, 45, 63);">(GMT-06:00) (Canada) Mountain Time</span>
            </label>

            <label style="display: flex; align-items: center; padding: 1rem 20px; border-bottom: 1px solid rgb(241, 242, 246); cursor: pointer; transition: background 0.15s;" onmouseover="this.style.background='rgb(252, 252, 252)'" onmouseout="this.style.background='white'">
              <input type="radio" name="timezone" value="GMT-06:00-US" style="margin-right: 16px; width: 18px; height: 18px; cursor: pointer;">
              <span style="font-size: 0.875rem; color: rgb(43, 45, 63);">(GMT-06:00) (US) Mountain Time</span>
            </label>

            <label style="display: flex; align-items: center; padding: 1rem 20px; border-bottom: 1px solid rgb(241, 242, 246); cursor: pointer; transition: background 0.15s;" onmouseover="this.style.background='rgb(252, 252, 252)'" onmouseout="this.style.background='white'">
              <input type="radio" name="timezone" value="GMT-07:00-CA" style="margin-right: 16px; width: 18px; height: 18px; cursor: pointer;">
              <span style="font-size: 0.875rem; color: rgb(43, 45, 63);">(GMT-07:00) (Canada) Pacific Time</span>
            </label>

            <label style="display: flex; align-items: center; padding: 1rem 20px; border-bottom: 1px solid rgb(241, 242, 246); cursor: pointer; transition: background 0.15s;" onmouseover="this.style.background='rgb(252, 252, 252)'" onmouseout="this.style.background='white'">
              <input type="radio" name="timezone" value="GMT-07:00-US" style="margin-right: 16px; width: 18px; height: 18px; cursor: pointer;">
              <span style="font-size: 0.875rem; color: rgb(43, 45, 63);">(GMT-07:00) (US) Pacific Time</span>
            </label>

            <label style="display: flex; align-items: center; padding: 1rem 20px; border-bottom: 1px solid rgb(241, 242, 246); cursor: pointer; transition: background 0.15s;" onmouseover="this.style.background='rgb(252, 252, 252)'" onmouseout="this.style.background='white'">
              <input type="radio" name="timezone" value="GMT-07:00-AZ" style="margin-right: 16px; width: 18px; height: 18px; cursor: pointer;">
              <span style="font-size: 0.875rem; color: rgb(43, 45, 63);">(GMT-07:00) US Arizona</span>
            </label>

            <label style="display: flex; align-items: center; padding: 1rem 20px; border-bottom: 1px solid rgb(241, 242, 246); cursor: pointer; transition: background 0.15s;" onmouseover="this.style.background='rgb(252, 252, 252)'" onmouseout="this.style.background='white'">
              <input type="radio" name="timezone" value="GMT-08:00" style="margin-right: 16px; width: 18px; height: 18px; cursor: pointer;">
              <span style="font-size: 0.875rem; color: rgb(43, 45, 63);">(GMT-08:00) US Alaska</span>
            </label>

            <label style="display: flex; align-items: center; padding: 1rem 20px; cursor: pointer; transition: background 0.15s;" onmouseover="this.style.background='rgb(252, 252, 252)'" onmouseout="this.style.background='white'">
              <input type="radio" name="timezone" value="GMT-10:00" style="margin-right: 16px; width: 18px; height: 18px; cursor: pointer;">
              <span style="font-size: 0.875rem; color: rgb(43, 45, 63);">(GMT-10:00) US Hawaii</span>
            </label>
          </div>
        </div>

        <!-- Bottom Actions - Fixed -->
        <div class="wizard-bottom-actions" style="position: fixed; bottom: 0; left: 340px; right: 0; background: white; padding: 1.25rem 24px; border-top: 1px solid rgb(241, 242, 246); display: flex; justify-content: space-between; align-items: center; z-index: 50; box-shadow: 0 -2px 8px rgba(0,0,0,0.08); transition: left 0.3s ease;">
          <button onclick="backToFTE()" style="display: inline-flex; align-items: center; gap: 0.5rem; background: none; border: none; color: rgb(13, 98, 255); font-size: 0.8125rem; font-weight: 600; text-transform: uppercase; letter-spacing: 0.5px; cursor: pointer; padding: 0;" onmouseover="this.style.opacity='0.8'" onmouseout="this.style.opacity='1'">
            <i data-lucide="chevron-left" style="width: 18px; height: 18px;"></i>
            <span>BACK</span>
          </button>
          <button onclick="saveTimezoneAndNext()" class="action-button-primary" style="font-size: 0.8125rem; padding: 0.75rem 32px;">
            SAVE & NEXT
          </button>
        </div>
        
        <!-- Spacer for fixed bottom bar -->
        <div style="height: 5rem;"></div>
      </div>

      <!-- Setup: Open Hours -->
      <div id="setup-openhours" style="display: none;">
        <!-- Wizard Header -->
        <div style="background: white; padding: 1.5rem 24px 20px 24px; margin: -24px -24px 24px -24px; box-shadow: 0 1px 3px rgba(0,0,0,0.1);">
          <div style="display: flex; align-items: center; justify-content: space-between; margin-bottom: 1.5rem;">
            <h1 style="font-size: 1.25rem; font-weight: 600; color: rgb(43, 45, 63); margin: 0;">Call Flow Setup</h1>
            <button onclick="backToFTE()" style="background: none; border: 1px solid rgb(221, 221, 226); color: rgb(13, 98, 255); padding: 0.5rem 20px; border-radius: 0.25rem; font-size: 0.8125rem; font-weight: 600; text-transform: uppercase; letter-spacing: 0.5px; cursor: pointer; transition: all 0.15s;" onmouseover="this.style.background='rgb(252, 252, 252)'" onmouseout="this.style.background='none'">
              SAVE & EXIT
            </button>
          </div>

          <!-- Wizard Steps -->
          <div style="display: flex; align-items: center; gap: 0; position: relative;">
            <!-- Step 1 - Active -->
            <div style="flex: 1; display: flex; align-items: center; gap: 0.5rem; position: relative;">
              <div style="width: 32px; height: 32px; border-radius: 50%; background: rgb(13, 98, 255); color: white; display: flex; align-items: center; justify-content: center; font-size: 0.875rem; font-weight: 600; z-index: 2; position: relative;">1</div>
              <span style="font-size: 0.875rem; font-weight: 600; color: rgb(13, 98, 255); position: relative; z-index: 2; background: white; padding-left: 0.5rem; padding-right: 0.5rem;">Schedules</span>
              <div style="position: absolute; left: 16px; top: 15px; height: 2px; background: rgb(241, 242, 246); width: 100%; z-index: 0;"></div>
            </div>

            <!-- Step 2 - Inactive -->
            <div style="flex: 1; display: flex; align-items: center; gap: 0.5rem; position: relative;">
              <div style="width: 32px; height: 32px; border-radius: 50%; background: rgb(249, 249, 250); border: 2px solid rgb(221, 221, 226); color: rgb(180, 181, 187); display: flex; align-items: center; justify-content: center; font-size: 0.875rem; font-weight: 600; z-index: 2; position: relative;">2</div>
              <span style="font-size: 0.875rem; font-weight: 500; color: rgb(180, 181, 187); position: relative; z-index: 2; background: white; padding-left: 0.5rem; padding-right: 0.5rem;">Open Hours</span>
              <div style="position: absolute; left: 16px; top: 15px; height: 2px; background: rgb(241, 242, 246); width: 100%; z-index: 0;"></div>
            </div>

            <!-- Step 3 - Inactive -->
            <div style="flex: 1; display: flex; align-items: center; gap: 0.5rem; position: relative;">
              <div style="width: 32px; height: 32px; border-radius: 50%; background: rgb(249, 249, 250); border: 2px solid rgb(221, 221, 226); color: rgb(180, 181, 187); display: flex; align-items: center; justify-content: center; font-size: 0.875rem; font-weight: 600; z-index: 2; position: relative;">3</div>
              <span style="font-size: 0.875rem; font-weight: 500; color: rgb(180, 181, 187); position: relative; z-index: 2; background: white; padding-left: 0.5rem; padding-right: 0.5rem;">Closed Hours</span>
              <div style="position: absolute; left: 16px; top: 15px; height: 2px; background: rgb(241, 242, 246); width: 100%; z-index: 0;"></div>
            </div>

            <!-- Step 4 - Inactive -->
            <div style="flex: 1; display: flex; align-items: center; gap: 0.5rem; position: relative;">
              <div style="width: 32px; height: 32px; border-radius: 50%; background: rgb(249, 249, 250); border: 2px solid rgb(221, 221, 226); color: rgb(180, 181, 187); display: flex; align-items: center; justify-content: center; font-size: 0.875rem; font-weight: 600; z-index: 2; position: relative;">4</div>
              <span style="font-size: 0.875rem; font-weight: 500; color: rgb(180, 181, 187); position: relative; z-index: 2; background: white; padding-left: 0.5rem; padding-right: 0.5rem;">Failover</span>
              <div style="position: absolute; left: 16px; top: 15px; height: 2px; background: rgb(241, 242, 246); width: 100%; z-index: 0;"></div>
            </div>

            <!-- Step 5 - Inactive -->
            <div style="flex: 1; display: flex; align-items: center; gap: 0.5rem; position: relative;">
              <div style="width: 32px; height: 32px; border-radius: 50%; background: rgb(249, 249, 250); border: 2px solid rgb(221, 221, 226); color: rgb(180, 181, 187); display: flex; align-items: center; justify-content: center; font-size: 0.875rem; font-weight: 600; z-index: 2; position: relative;">5</div>
              <span style="font-size: 0.875rem; font-weight: 500; color: rgb(180, 181, 187); position: relative; z-index: 2; background: white; padding-left: 0.5rem; padding-right: 0.5rem;">Virtual Assistant</span>
            </div>
          </div>
        </div>

        <!-- Tabs -->
        <div style="border-bottom: 2px solid rgb(241, 242, 246); margin-bottom: 2rem; display: flex; gap: 1.5rem;">
          <div onclick="navigateToTab('timezone')" style="padding: 0.75rem 0; font-size: 0.875rem; font-weight: 600; color: rgb(180, 181, 187); cursor: pointer; transition: color 0.2s; border-bottom: 3px solid transparent; margin-bottom: -2px;" onmouseover="this.style.color='rgb(13, 98, 255)'" onmouseout="if(this.style.borderBottomColor === 'transparent') this.style.color='rgb(180, 181, 187)'">TIME ZONE</div>
          <div onclick="navigateToTab('openhours')" style="padding: 0.75rem 0; font-size: 0.875rem; font-weight: 600; color: rgb(43, 45, 63); border-bottom: 3px solid rgb(13, 98, 255); margin-bottom: -2px; cursor: pointer; transition: color 0.2s;">OPEN HOURS</div>
          <div onclick="navigateToTab('holidays')" style="padding: 0.75rem 0; font-size: 0.875rem; font-weight: 600; color: rgb(180, 181, 187); cursor: pointer; transition: color 0.2s; border-bottom: 3px solid transparent; margin-bottom: -2px;" onmouseover="this.style.color='rgb(13, 98, 255)'" onmouseout="if(this.style.borderBottomColor === 'transparent') this.style.color='rgb(180, 181, 187)'">HOLIDAYS</div>
        </div>

        <!-- Content -->
        <div style="max-width: 800px;">
          <h2 style="font-size: 1.25rem; font-weight: 600; color: rgb(43, 45, 63); margin-bottom: 0.5rem;">Open hours</h2>
          <p style="font-size: 0.875rem; color: rgb(112, 113, 125); margin-bottom: 1.5rem;">Time schedule name: <span style="font-weight: 500;">Open hours</span></p>

          <!-- Info Banner -->
          <div style="background: rgb(245, 248, 255); border: 1px solid rgb(194, 216, 255); border-radius: 0.25rem; padding: 1rem; display: flex; gap: 0.75rem; margin-bottom: 1.5rem;">
            <i data-lucide="lightbulb" style="width: 20px; height: 20px; color: rgb(13, 98, 255); flex-shrink: 0; margin-top: 0.125rem;"></i>
            <div>
              <div style="font-size: 0.875rem; font-weight: 600; color: rgb(43, 45, 63); margin-bottom: 0.25rem;">ADD A BREAK DURING YOUR OPEN HOURS</div>
              <div style="font-size: 0.8125rem; color: rgb(89, 90, 105); margin-bottom: 0.5rem;">You can adjust your Open Hours by adding additional time slots for breaks. Any time that falls outside of your Open Hours, such as lunch breaks, will follow your Closed Hours configuration.</div>
              <a href="#" style="display: inline-flex; align-items: center; gap: 0.25rem; font-size: 0.8125rem; color: rgb(13, 98, 255); text-decoration: none; font-weight: 500;">
                <i data-lucide="help-circle" style="width: 16px; height: 16px;"></i>
                How do I configure breaks?
              </a>
            </div>
          </div>

          <!-- Open 24/7 Checkbox -->
          <label style="display: flex; align-items: center; gap: 0.5rem; margin-bottom: 1.5rem; cursor: pointer;">
            <input type="checkbox" id="open-24-7" onchange="toggleOpen247()" style="width: 18px; height: 18px; cursor: pointer;">
            <span style="font-size: 0.875rem; color: rgb(43, 45, 63);">Open 24/7</span>
            <i data-lucide="info" style="width: 16px; height: 16px; color: rgb(112, 113, 125);"></i>
          </label>

          <!-- Weekly Schedule Container -->
          <div style="background: white; border: 1px solid rgb(241, 242, 246); border-radius: 0.5rem; padding: 1.5rem; box-shadow: 0 1px 3px rgba(0,0,0,0.05);">
            <!-- Weekly Schedule -->
            <div style="display: flex; flex-direction: column; gap: 1.5rem;">
            <!-- Monday -->
            <div style="display: flex; align-items: center; gap: 1rem;">
              <div style="width: 100px; font-size: 0.8125rem; font-weight: 600; color: rgb(89, 90, 105); text-transform: uppercase;">MONDAY</div>
              <label class="toggle-switch">
                <input type="checkbox" id="toggle-monday" checked onchange="toggleDay('monday')">
                <span class="toggle-slider"></span>
              </label>
              <span id="badge-monday" style="padding: 0.25rem 12px; background: rgb(13, 98, 255); color: white; border-radius: 0.25rem; font-size: 0.75rem; font-weight: 600;">OPEN</span>
              <div id="times-monday" style="display: flex; align-items: center; gap: 0.75rem; flex: 1;">
                <input type="time" value="09:00" style="padding: 0.5rem 12px; border: 1px solid rgb(221, 221, 226); border-radius: 0.25rem; font-size: 0.875rem; cursor: pointer; background: white;">
                <span style="color: rgb(112, 113, 125);">—</span>
                <input type="time" value="18:00" style="padding: 0.5rem 12px; border: 1px solid rgb(221, 221, 226); border-radius: 0.25rem; font-size: 0.875rem; cursor: pointer; background: white;">
                <button style="background: none; border: none; cursor: pointer; padding: 0.25rem;" title="Copy to other days">
                  <i data-lucide="copy" style="width: 18px; height: 18px; color: rgb(112, 113, 125);"></i>
                </button>
              </div>
            </div>
            <div style="padding-left: 116px; margin-top: -16px;">
              <a href="#" style="font-size: 0.8125rem; color: rgb(13, 98, 255); text-decoration: none; font-weight: 500;">+ Add time slot</a>
            </div>

            <!-- Tuesday -->
            <div style="display: flex; align-items: center; gap: 1rem;">
              <div style="width: 100px; font-size: 0.8125rem; font-weight: 600; color: rgb(89, 90, 105); text-transform: uppercase;">TUESDAY</div>
              <label class="toggle-switch">
                <input type="checkbox" id="toggle-tuesday" checked onchange="toggleDay('tuesday')">
                <span class="toggle-slider"></span>
              </label>
              <span id="badge-tuesday" style="padding: 0.25rem 12px; background: rgb(13, 98, 255); color: white; border-radius: 0.25rem; font-size: 0.75rem; font-weight: 600;">OPEN</span>
              <div id="times-tuesday" style="display: flex; align-items: center; gap: 0.75rem; flex: 1;">
                <input type="time" value="09:00" style="padding: 0.5rem 12px; border: 1px solid rgb(221, 221, 226); border-radius: 0.25rem; font-size: 0.875rem; cursor: pointer; background: white;">
                <span style="color: rgb(112, 113, 125);">—</span>
                <input type="time" value="18:00" style="padding: 0.5rem 12px; border: 1px solid rgb(221, 221, 226); border-radius: 0.25rem; font-size: 0.875rem; cursor: pointer; background: white;">
                <button style="background: none; border: none; cursor: pointer; padding: 0.25rem;" title="Copy to other days">
                  <i data-lucide="copy" style="width: 18px; height: 18px; color: rgb(112, 113, 125);"></i>
                </button>
              </div>
            </div>
            <div style="padding-left: 116px; margin-top: -16px;">
              <a href="#" style="font-size: 0.8125rem; color: rgb(13, 98, 255); text-decoration: none; font-weight: 500;">+ Add time slot</a>
            </div>

            <!-- Wednesday -->
            <div style="display: flex; align-items: center; gap: 1rem;">
              <div style="width: 100px; font-size: 0.8125rem; font-weight: 600; color: rgb(89, 90, 105); text-transform: uppercase;">WEDNESDAY</div>
              <label class="toggle-switch">
                <input type="checkbox" id="toggle-wednesday" onchange="toggleDay('wednesday')">
                <span class="toggle-slider"></span>
              </label>
              <span id="badge-wednesday" style="padding: 0.25rem 12px; background: rgb(241, 242, 246); color: rgb(112, 113, 125); border-radius: 0.25rem; font-size: 0.75rem; font-weight: 600;">CLOSED</span>
              <div id="times-wednesday" style="display: none; align-items: center; gap: 0.75rem; flex: 1;">
                <input type="time" value="09:00" style="padding: 0.5rem 12px; border: 1px solid rgb(221, 221, 226); border-radius: 0.25rem; font-size: 0.875rem; cursor: pointer; background: white;">
                <span style="color: rgb(112, 113, 125);">—</span>
                <input type="time" value="18:00" style="padding: 0.5rem 12px; border: 1px solid rgb(221, 221, 226); border-radius: 0.25rem; font-size: 0.875rem; cursor: pointer; background: white;">
                <button style="background: none; border: none; cursor: pointer; padding: 0.25rem;" title="Copy to other days">
                  <i data-lucide="copy" style="width: 18px; height: 18px; color: rgb(112, 113, 125);"></i>
                </button>
              </div>
            </div>

            <!-- Thursday -->
            <div style="display: flex; align-items: center; gap: 1rem;">
              <div style="width: 100px; font-size: 0.8125rem; font-weight: 600; color: rgb(89, 90, 105); text-transform: uppercase;">THURSDAY</div>
              <label class="toggle-switch">
                <input type="checkbox" id="toggle-thursday" checked onchange="toggleDay('thursday')">
                <span class="toggle-slider"></span>
              </label>
              <span id="badge-thursday" style="padding: 0.25rem 12px; background: rgb(13, 98, 255); color: white; border-radius: 0.25rem; font-size: 0.75rem; font-weight: 600;">OPEN</span>
              <div id="times-thursday" style="display: flex; align-items: center; gap: 0.75rem; flex: 1;">
                <input type="text" value="24 hours" readonly style="padding: 0.5rem 12px; border: 1px solid rgb(221, 221, 226); border-radius: 0.25rem; font-size: 0.875rem; background: rgb(252, 252, 252); color: rgb(112, 113, 125);">
                <button style="background: none; border: none; cursor: pointer; padding: 0.25rem;" title="Copy to other days">
                  <i data-lucide="copy" style="width: 18px; height: 18px; color: rgb(112, 113, 125);"></i>
                </button>
              </div>
            </div>

            <!-- Friday -->
            <div style="display: flex; align-items: center; gap: 1rem;">
              <div style="width: 100px; font-size: 0.8125rem; font-weight: 600; color: rgb(89, 90, 105); text-transform: uppercase;">FRIDAY</div>
              <label class="toggle-switch">
                <input type="checkbox" id="toggle-friday" onchange="toggleDay('friday')">
                <span class="toggle-slider"></span>
              </label>
              <span id="badge-friday" style="padding: 0.25rem 12px; background: rgb(241, 242, 246); color: rgb(112, 113, 125); border-radius: 0.25rem; font-size: 0.75rem; font-weight: 600;">CLOSED</span>
              <div id="times-friday" style="display: none; align-items: center; gap: 0.75rem; flex: 1;">
                <input type="time" value="09:00" style="padding: 0.5rem 12px; border: 1px solid rgb(221, 221, 226); border-radius: 0.25rem; font-size: 0.875rem; cursor: pointer; background: white;">
                <span style="color: rgb(112, 113, 125);">—</span>
                <input type="time" value="18:00" style="padding: 0.5rem 12px; border: 1px solid rgb(221, 221, 226); border-radius: 0.25rem; font-size: 0.875rem; cursor: pointer; background: white;">
                <button style="background: none; border: none; cursor: pointer; padding: 0.25rem;" title="Copy to other days">
                  <i data-lucide="copy" style="width: 18px; height: 18px; color: rgb(112, 113, 125);"></i>
                </button>
              </div>
            </div>

            <!-- Saturday -->
            <div style="display: flex; align-items: center; gap: 1rem;">
              <div style="width: 100px; font-size: 0.8125rem; font-weight: 600; color: rgb(89, 90, 105); text-transform: uppercase;">SATURDAY</div>
              <label class="toggle-switch">
                <input type="checkbox" id="toggle-saturday" checked onchange="toggleDay('saturday')">
                <span class="toggle-slider"></span>
              </label>
              <span id="badge-saturday" style="padding: 0.25rem 12px; background: rgb(13, 98, 255); color: white; border-radius: 0.25rem; font-size: 0.75rem; font-weight: 600;">OPEN</span>
              <div id="times-saturday" style="display: flex; align-items: center; gap: 0.75rem; flex: 1;">
                <input type="text" value="24 hours" readonly style="padding: 0.5rem 12px; border: 1px solid rgb(221, 221, 226); border-radius: 0.25rem; font-size: 0.875rem; background: rgb(252, 252, 252); color: rgb(112, 113, 125);">
                <button style="background: none; border: none; cursor: pointer; padding: 0.25rem;" title="Copy to other days">
                  <i data-lucide="copy" style="width: 18px; height: 18px; color: rgb(112, 113, 125);"></i>
                </button>
              </div>
            </div>

            <!-- Sunday -->
            <div style="display: flex; align-items: center; gap: 1rem;">
              <div style="width: 100px; font-size: 0.8125rem; font-weight: 600; color: rgb(89, 90, 105); text-transform: uppercase;">SUNDAY</div>
              <label class="toggle-switch">
                <input type="checkbox" id="toggle-sunday" onchange="toggleDay('sunday')">
                <span class="toggle-slider"></span>
              </label>
              <span id="badge-sunday" style="padding: 0.25rem 12px; background: rgb(241, 242, 246); color: rgb(112, 113, 125); border-radius: 0.25rem; font-size: 0.75rem; font-weight: 600;">CLOSED</span>
              <div id="times-sunday" style="display: none; align-items: center; gap: 0.75rem; flex: 1;">
                <input type="time" value="09:00" style="padding: 0.5rem 12px; border: 1px solid rgb(221, 221, 226); border-radius: 0.25rem; font-size: 0.875rem; cursor: pointer; background: white;">
                <span style="color: rgb(112, 113, 125);">—</span>
                <input type="time" value="18:00" style="padding: 0.5rem 12px; border: 1px solid rgb(221, 221, 226); border-radius: 0.25rem; font-size: 0.875rem; cursor: pointer; background: white;">
                <button style="background: none; border: none; cursor: pointer; padding: 0.25rem;" title="Copy to other days">
                  <i data-lucide="copy" style="width: 18px; height: 18px; color: rgb(112, 113, 125);"></i>
                </button>
              </div>
            </div>
          </div>
          </div>
        </div>

        <!-- Bottom Actions - Fixed -->
        <div class="wizard-bottom-actions" style="position: fixed; bottom: 0; left: 340px; right: 0; background: white; padding: 1.25rem 24px; border-top: 1px solid rgb(241, 242, 246); display: flex; justify-content: space-between; align-items: center; z-index: 50; box-shadow: 0 -2px 8px rgba(0,0,0,0.08); transition: left 0.3s ease;">
          <button onclick="backToTimezone()" style="display: inline-flex; align-items: center; gap: 0.5rem; background: none; border: none; color: rgb(13, 98, 255); font-size: 0.8125rem; font-weight: 600; text-transform: uppercase; letter-spacing: 0.5px; cursor: pointer; padding: 0;" onmouseover="this.style.opacity='0.8'" onmouseout="this.style.opacity='1'">
            <i data-lucide="chevron-left" style="width: 18px; height: 18px;"></i>
            <span>BACK</span>
          </button>
          <button onclick="saveOpenHoursAndNext()" class="action-button-primary" style="font-size: 0.8125rem; padding: 0.75rem 32px;">
            SAVE & NEXT
          </button>
        </div>
        
        <!-- Spacer for fixed bottom bar -->
        <div style="height: 5rem;"></div>
      </div>

      <!-- Setup: Holidays -->
      <div id="setup-holidays" style="display: none;">
        <!-- Wizard Header -->
        <div style="background: white; padding: 1.5rem 24px 20px 24px; margin: -24px -24px 24px -24px; box-shadow: 0 1px 3px rgba(0,0,0,0.1);">
          <div style="display: flex; align-items: center; justify-content: space-between; margin-bottom: 1.5rem;">
            <h1 style="font-size: 1.25rem; font-weight: 600; color: rgb(43, 45, 63); margin: 0;">Call Flow Setup</h1>
            <button onclick="backToFTE()" style="background: none; border: 1px solid rgb(221, 221, 226); color: rgb(13, 98, 255); padding: 0.5rem 20px; border-radius: 0.25rem; font-size: 0.8125rem; font-weight: 600; text-transform: uppercase; letter-spacing: 0.5px; cursor: pointer; transition: all 0.15s;" onmouseover="this.style.background='rgb(252, 252, 252)'" onmouseout="this.style.background='none'">
              SAVE & EXIT
            </button>
          </div>

          <!-- Wizard Steps -->
          <div style="display: flex; align-items: center; gap: 0; position: relative;">
            <!-- Step 1 - Active -->
            <div style="flex: 1; display: flex; align-items: center; gap: 0.5rem; position: relative;">
              <div style="width: 32px; height: 32px; border-radius: 50%; background: rgb(13, 98, 255); color: white; display: flex; align-items: center; justify-content: center; font-size: 0.875rem; font-weight: 600; z-index: 2; position: relative;">1</div>
              <span style="font-size: 0.875rem; font-weight: 600; color: rgb(13, 98, 255); position: relative; z-index: 2; background: white; padding-left: 0.5rem; padding-right: 0.5rem;">Schedules</span>
              <div style="position: absolute; left: 16px; top: 15px; height: 2px; background: rgb(241, 242, 246); width: 100%; z-index: 0;"></div>
            </div>

            <!-- Step 2 - Inactive -->
            <div style="flex: 1; display: flex; align-items: center; gap: 0.5rem; position: relative;">
              <div style="width: 32px; height: 32px; border-radius: 50%; background: rgb(249, 249, 250); border: 2px solid rgb(221, 221, 226); color: rgb(180, 181, 187); display: flex; align-items: center; justify-content: center; font-size: 0.875rem; font-weight: 600; z-index: 2; position: relative;">2</div>
              <span style="font-size: 0.875rem; font-weight: 500; color: rgb(180, 181, 187); position: relative; z-index: 2; background: white; padding-left: 0.5rem; padding-right: 0.5rem;">Open Hours</span>
              <div style="position: absolute; left: 16px; top: 15px; height: 2px; background: rgb(241, 242, 246); width: 100%; z-index: 0;"></div>
            </div>

            <!-- Step 3 - Inactive -->
            <div style="flex: 1; display: flex; align-items: center; gap: 0.5rem; position: relative;">
              <div style="width: 32px; height: 32px; border-radius: 50%; background: rgb(249, 249, 250); border: 2px solid rgb(221, 221, 226); color: rgb(180, 181, 187); display: flex; align-items: center; justify-content: center; font-size: 0.875rem; font-weight: 600; z-index: 2; position: relative;">3</div>
              <span style="font-size: 0.875rem; font-weight: 500; color: rgb(180, 181, 187); position: relative; z-index: 2; background: white; padding-left: 0.5rem; padding-right: 0.5rem;">Closed Hours</span>
              <div style="position: absolute; left: 16px; top: 15px; height: 2px; background: rgb(241, 242, 246); width: 100%; z-index: 0;"></div>
            </div>

            <!-- Step 4 - Inactive -->
            <div style="flex: 1; display: flex; align-items: center; gap: 0.5rem; position: relative;">
              <div style="width: 32px; height: 32px; border-radius: 50%; background: rgb(249, 249, 250); border: 2px solid rgb(221, 221, 226); color: rgb(180, 181, 187); display: flex; align-items: center; justify-content: center; font-size: 0.875rem; font-weight: 600; z-index: 2; position: relative;">4</div>
              <span style="font-size: 0.875rem; font-weight: 500; color: rgb(180, 181, 187); position: relative; z-index: 2; background: white; padding-left: 0.5rem; padding-right: 0.5rem;">Failover</span>
              <div style="position: absolute; left: 16px; top: 15px; height: 2px; background: rgb(241, 242, 246); width: 100%; z-index: 0;"></div>
            </div>

            <!-- Step 5 - Inactive -->
            <div style="flex: 1; display: flex; align-items: center; gap: 0.5rem; position: relative;">
              <div style="width: 32px; height: 32px; border-radius: 50%; background: rgb(249, 249, 250); border: 2px solid rgb(221, 221, 226); color: rgb(180, 181, 187); display: flex; align-items: center; justify-content: center; font-size: 0.875rem; font-weight: 600; z-index: 2; position: relative;">5</div>
              <span style="font-size: 0.875rem; font-weight: 500; color: rgb(180, 181, 187); position: relative; z-index: 2; background: white; padding-left: 0.5rem; padding-right: 0.5rem;">Virtual Assistant</span>
            </div>
          </div>
        </div>

        <!-- Tabs -->
        <div style="border-bottom: 2px solid rgb(241, 242, 246); margin-bottom: 2rem; display: flex; gap: 1.5rem;">
          <div onclick="navigateToTab('timezone')" style="padding: 0.75rem 0; font-size: 0.875rem; font-weight: 600; color: rgb(180, 181, 187); cursor: pointer; transition: color 0.2s; border-bottom: 3px solid transparent; margin-bottom: -2px;" onmouseover="this.style.color='rgb(13, 98, 255)'" onmouseout="if(this.style.borderBottomColor === 'transparent') this.style.color='rgb(180, 181, 187)'">TIME ZONE</div>
          <div onclick="navigateToTab('openhours')" style="padding: 0.75rem 0; font-size: 0.875rem; font-weight: 600; color: rgb(180, 181, 187); cursor: pointer; transition: color 0.2s; border-bottom: 3px solid transparent; margin-bottom: -2px;" onmouseover="this.style.color='rgb(13, 98, 255)'" onmouseout="if(this.style.borderBottomColor === 'transparent') this.style.color='rgb(180, 181, 187)'">OPEN HOURS</div>
          <div onclick="navigateToTab('holidays')" style="padding: 0.75rem 0; font-size: 0.875rem; font-weight: 600; color: rgb(43, 45, 63); border-bottom: 3px solid rgb(13, 98, 255); margin-bottom: -2px; cursor: pointer; transition: color 0.2s;">HOLIDAYS</div>
        </div>

        <!-- Content -->
        <div style="max-width: 800px;">
          <h2 style="font-size: 1.25rem; font-weight: 600; color: rgb(43, 45, 63); margin-bottom: 0.5rem;">What are your holidays?</h2>
          <p style="font-size: 0.875rem; color: rgb(112, 113, 125); margin-bottom: 2rem;">Select the holidays during which your business is closed.</p>

          <!-- Holiday List Container -->
          <div style="background: white; border: 1px solid rgb(241, 242, 246); border-radius: 0.5rem; padding: 1.5rem; box-shadow: 0 1px 3px rgba(0,0,0,0.05); margin-bottom: 2rem;">
            <!-- Select All -->
            <label style="display: flex; align-items: center; gap: 0.75rem; padding: 0.75rem 0; border-bottom: 1px solid rgb(241, 242, 246); margin-bottom: 1rem; cursor: pointer;">
              <input type="checkbox" id="select-all-holidays" onchange="toggleAllHolidays()" style="width: 18px; height: 18px; cursor: pointer;">
              <span style="font-size: 0.875rem; color: rgb(43, 45, 63); font-weight: 500;">Select all</span>
            </label>

            <!-- Federal Holidays -->
            <div style="display: flex; flex-direction: column; gap: 0.75rem;">
              <label style="display: flex; align-items: center; gap: 0.75rem; cursor: pointer; padding: 0.5rem 0;">
                <input type="checkbox" class="holiday-checkbox" checked style="width: 18px; height: 18px; cursor: pointer;">
                <span style="font-size: 0.875rem; color: rgb(43, 45, 63);">New Year's Day</span>
              </label>

              <label style="display: flex; align-items: center; gap: 0.75rem; cursor: pointer; padding: 0.5rem 0;">
                <input type="checkbox" class="holiday-checkbox" checked style="width: 18px; height: 18px; cursor: pointer;">
                <span style="font-size: 0.875rem; color: rgb(43, 45, 63);">Martin Luther King, Jr. Day</span>
              </label>

              <label style="display: flex; align-items: center; gap: 0.75rem; cursor: pointer; padding: 0.5rem 0;">
                <input type="checkbox" class="holiday-checkbox" checked style="width: 18px; height: 18px; cursor: pointer;">
                <span style="font-size: 0.875rem; color: rgb(43, 45, 63);">Presidents' Day</span>
              </label>

              <label style="display: flex; align-items: center; gap: 0.75rem; cursor: pointer; padding: 0.5rem 0;">
                <input type="checkbox" class="holiday-checkbox" checked style="width: 18px; height: 18px; cursor: pointer;">
                <span style="font-size: 0.875rem; color: rgb(43, 45, 63);">Memorial Day</span>
              </label>

              <label style="display: flex; align-items: center; gap: 0.75rem; cursor: pointer; padding: 0.5rem 0;">
                <input type="checkbox" class="holiday-checkbox" style="width: 18px; height: 18px; cursor: pointer;">
                <span style="font-size: 0.875rem; color: rgb(43, 45, 63);">Juneteenth</span>
              </label>

              <label style="display: flex; align-items: center; gap: 0.75rem; cursor: pointer; padding: 0.5rem 0;">
                <input type="checkbox" class="holiday-checkbox" checked style="width: 18px; height: 18px; cursor: pointer;">
                <span style="font-size: 0.875rem; color: rgb(43, 45, 63);">Independence Day</span>
              </label>

              <label style="display: flex; align-items: center; gap: 0.75rem; cursor: pointer; padding: 0.5rem 0;">
                <input type="checkbox" class="holiday-checkbox" checked style="width: 18px; height: 18px; cursor: pointer;">
                <span style="font-size: 0.875rem; color: rgb(43, 45, 63);">Labor Day</span>
              </label>

              <label style="display: flex; align-items: center; gap: 0.75rem; cursor: pointer; padding: 0.5rem 0;">
                <input type="checkbox" class="holiday-checkbox" checked style="width: 18px; height: 18px; cursor: pointer;">
                <span style="font-size: 0.875rem; color: rgb(43, 45, 63);">Columbus Day</span>
              </label>

              <label style="display: flex; align-items: center; gap: 0.75rem; cursor: pointer; padding: 0.5rem 0;">
                <input type="checkbox" class="holiday-checkbox" checked style="width: 18px; height: 18px; cursor: pointer;">
                <span style="font-size: 0.875rem; color: rgb(43, 45, 63);">Veterans Day</span>
              </label>

              <label style="display: flex; align-items: center; gap: 0.75rem; cursor: pointer; padding: 0.5rem 0;">
                <input type="checkbox" class="holiday-checkbox" checked style="width: 18px; height: 18px; cursor: pointer;">
                <span style="font-size: 0.875rem; color: rgb(43, 45, 63);">Thanksgiving Day</span>
              </label>

              <label style="display: flex; align-items: center; gap: 0.75rem; cursor: pointer; padding: 0.5rem 0;">
                <input type="checkbox" class="holiday-checkbox" style="width: 18px; height: 18px; cursor: pointer;">
                <span style="font-size: 0.875rem; color: rgb(43, 45, 63);">Black Friday</span>
                <span style="font-size: 0.75rem; color: rgb(157, 158, 167); margin-left: auto;">Non-Federal Holiday</span>
              </label>

              <label style="display: flex; align-items: center; gap: 0.75rem; cursor: pointer; padding: 0.5rem 0;">
                <input type="checkbox" class="holiday-checkbox" checked style="width: 18px; height: 18px; cursor: pointer;">
                <span style="font-size: 0.875rem; color: rgb(43, 45, 63);">Christmas Eve</span>
                <span style="font-size: 0.75rem; color: rgb(157, 158, 167); margin-left: auto;">Non-Federal Holiday</span>
              </label>

              <label style="display: flex; align-items: center; gap: 0.75rem; cursor: pointer; padding: 0.5rem 0;">
                <input type="checkbox" class="holiday-checkbox" checked style="width: 18px; height: 18px; cursor: pointer;">
                <span style="font-size: 0.875rem; color: rgb(43, 45, 63);">Christmas Day</span>
              </label>

              <label style="display: flex; align-items: center; gap: 0.75rem; cursor: pointer; padding: 0.5rem 0;">
                <input type="checkbox" class="holiday-checkbox" style="width: 18px; height: 18px; cursor: pointer;">
                <span style="font-size: 0.875rem; color: rgb(43, 45, 63);">New Year's Eve</span>
                <span style="font-size: 0.75rem; color: rgb(157, 158, 167); margin-left: auto;">Non-Federal Holiday</span>
              </label>
            </div>

            <!-- Custom Holidays Divider -->
            <div style="display: flex; align-items: center; gap: 1rem; margin: 2rem 0 24px 0;">
              <div style="flex: 1; height: 1px; background: rgb(221, 221, 226);"></div>
              <span style="font-size: 0.8125rem; color: rgb(157, 158, 167); text-transform: uppercase; letter-spacing: 0.5px;">Custom holidays</span>
              <div style="flex: 1; height: 1px; background: rgb(221, 221, 226);"></div>
            </div>

            <!-- Custom Holiday Item -->
            <div style="display: flex; align-items: center; gap: 0.75rem; padding: 0.75rem; background: rgb(252, 252, 252); border: 1px solid rgb(241, 242, 246); border-radius: 0.25rem; margin-bottom: 1rem;">
              <span style="font-size: 0.875rem; color: rgb(43, 45, 63); font-weight: 500; flex: 1;">Custom</span>
              <button style="background: none; border: none; cursor: pointer; padding: 0.25rem;">
                <i data-lucide="edit-2" style="width: 18px; height: 18px; color: rgb(112, 113, 125);"></i>
              </button>
              <button style="background: none; border: none; cursor: pointer; padding: 0.25rem;">
                <i data-lucide="trash-2" style="width: 18px; height: 18px; color: rgb(112, 113, 125);"></i>
              </button>
            </div>
            <div style="font-size: 0.875rem; color: rgb(112, 113, 125); margin-bottom: 1rem; padding-left: 12px;">Oct 20, 2025</div>

            <!-- Add Custom Holiday -->
            <a href="#" style="display: inline-flex; align-items: center; gap: 0.375rem; font-size: 0.8125rem; color: rgb(13, 98, 255); text-decoration: none; font-weight: 600;">
              + Add custom holiday
            </a>
          </div>
        </div>

        <!-- Bottom Actions - Fixed -->
        <div class="wizard-bottom-actions" style="position: fixed; bottom: 0; left: 340px; right: 0; background: white; padding: 1.25rem 24px; border-top: 1px solid rgb(241, 242, 246); display: flex; justify-content: space-between; align-items: center; z-index: 50; box-shadow: 0 -2px 8px rgba(0,0,0,0.08); transition: left 0.3s ease;">
          <button onclick="backToOpenHours()" style="display: inline-flex; align-items: center; gap: 0.5rem; background: none; border: none; color: rgb(13, 98, 255); font-size: 0.8125rem; font-weight: 600; text-transform: uppercase; letter-spacing: 0.5px; cursor: pointer; padding: 0;" onmouseover="this.style.opacity='0.8'" onmouseout="this.style.opacity='1'">
            <i data-lucide="chevron-left" style="width: 18px; height: 18px;"></i>
            <span>BACK</span>
          </button>
          <button onclick="saveHolidaysAndComplete()" class="action-button-primary" style="font-size: 0.8125rem; padding: 0.75rem 32px;">
            SAVE & NEXT
          </button>
        </div>
        
        <!-- Spacer for fixed bottom bar -->
        <div style="height: 5rem;"></div>
      </div>

      <!-- Setup: Routing Action (Open Hours) -->
      <div id="setup-routing" style="display: none;">
        <!-- Wizard Header -->
        <div style="background: white; padding: 1.5rem 24px 20px 24px; margin: -24px -24px 24px -24px; box-shadow: 0 1px 3px rgba(0,0,0,0.1);">
          <div style="display: flex; align-items: center; justify-content: space-between; margin-bottom: 1.5rem;">
            <h1 style="font-size: 1.25rem; font-weight: 600; color: rgb(43, 45, 63); margin: 0;">Call Flow Setup</h1>
            <button onclick="backToFTE()" style="background: none; border: 1px solid rgb(221, 221, 226); color: rgb(13, 98, 255); padding: 0.5rem 20px; border-radius: 0.25rem; font-size: 0.8125rem; font-weight: 600; text-transform: uppercase; letter-spacing: 0.5px; cursor: pointer; transition: all 0.15s;" onmouseover="this.style.background='rgb(252, 252, 252)'" onmouseout="this.style.background='none'">
              SAVE & EXIT
            </button>
          </div>

          <!-- Wizard Steps -->
          <div style="display: flex; align-items: center; gap: 0; position: relative;">
            <!-- Step 1 - Completed (Clickable) -->
            <div onclick="navigateToStep('setup-holidays')" style="flex: 1; display: flex; align-items: center; gap: 0.5rem; position: relative; cursor: pointer; transition: opacity 0.15s;" onmouseover="this.style.opacity='0.7'" onmouseout="this.style.opacity='1'" title="Go back to Schedules">
              <div style="width: 32px; height: 32px; border-radius: 50%; background: rgb(34, 197, 94); color: white; display: flex; align-items: center; justify-content: center; font-size: 0.875rem; font-weight: 600; z-index: 2; position: relative;">
                <i data-lucide="check" style="width: 18px; height: 18px;"></i>
              </div>
              <span style="font-size: 0.875rem; font-weight: 500; color: rgb(89, 90, 105); position: relative; z-index: 2; background: white; padding-left: 0.5rem; padding-right: 0.5rem;">Schedules</span>
              <div style="position: absolute; left: 16px; top: 15px; height: 2px; background: rgb(34, 197, 94); width: 100%; z-index: 0;"></div>
            </div>

            <!-- Step 2 - Active -->
            <div style="flex: 1; display: flex; align-items: center; gap: 0.5rem; position: relative;">
              <div style="width: 32px; height: 32px; border-radius: 50%; background: rgb(13, 98, 255); color: white; display: flex; align-items: center; justify-content: center; font-size: 0.875rem; font-weight: 600; z-index: 2; position: relative;">2</div>
              <span style="font-size: 0.875rem; font-weight: 600; color: rgb(13, 98, 255); position: relative; z-index: 2; background: white; padding-left: 0.5rem; padding-right: 0.5rem;">Open Hours</span>
              <div style="position: absolute; left: 16px; top: 15px; height: 2px; background: rgb(241, 242, 246); width: 100%; z-index: 0;"></div>
            </div>

            <!-- Step 3 - Inactive -->
            <div style="flex: 1; display: flex; align-items: center; gap: 0.5rem; position: relative;">
              <div style="width: 32px; height: 32px; border-radius: 50%; background: rgb(249, 249, 250); border: 2px solid rgb(221, 221, 226); color: rgb(180, 181, 187); display: flex; align-items: center; justify-content: center; font-size: 0.875rem; font-weight: 600; z-index: 2; position: relative;">3</div>
              <span style="font-size: 0.875rem; font-weight: 500; color: rgb(180, 181, 187); position: relative; z-index: 2; background: white; padding-left: 0.5rem; padding-right: 0.5rem;">Closed Hours</span>
              <div style="position: absolute; left: 16px; top: 15px; height: 2px; background: rgb(241, 242, 246); width: 100%; z-index: 0;"></div>
            </div>

            <!-- Step 4 - Inactive -->
            <div style="flex: 1; display: flex; align-items: center; gap: 0.5rem; position: relative;">
              <div style="width: 32px; height: 32px; border-radius: 50%; background: rgb(249, 249, 250); border: 2px solid rgb(221, 221, 226); color: rgb(180, 181, 187); display: flex; align-items: center; justify-content: center; font-size: 0.875rem; font-weight: 600; z-index: 2; position: relative;">4</div>
              <span style="font-size: 0.875rem; font-weight: 500; color: rgb(180, 181, 187); position: relative; z-index: 2; background: white; padding-left: 0.5rem; padding-right: 0.5rem;">Failover</span>
              <div style="position: absolute; left: 16px; top: 15px; height: 2px; background: rgb(241, 242, 246); width: 100%; z-index: 0;"></div>
            </div>

            <!-- Step 5 - Inactive -->
            <div style="flex: 1; display: flex; align-items: center; gap: 0.5rem; position: relative;">
              <div style="width: 32px; height: 32px; border-radius: 50%; background: rgb(249, 249, 250); border: 2px solid rgb(221, 221, 226); color: rgb(180, 181, 187); display: flex; align-items: center; justify-content: center; font-size: 0.875rem; font-weight: 600; z-index: 2; position: relative;">5</div>
              <span style="font-size: 0.875rem; font-weight: 500; color: rgb(180, 181, 187); position: relative; z-index: 2; background: white; padding-left: 0.5rem; padding-right: 0.5rem;">Virtual Assistant</span>
            </div>
          </div>
        </div>

        <!-- Section Header -->
        <div style="margin-bottom: 2rem;">
          <div style="font-size: 0.75rem; font-weight: 600; color: rgb(112, 113, 125); text-transform: uppercase; letter-spacing: 1px; margin-bottom: 0.5rem; text-decoration: underline; text-decoration-thickness: 2px; text-underline-offset: 4px;">ROUTING ACTION</div>
        </div>

        <!-- Content -->
        <div style="max-width: 1200px;">
          <h2 style="font-size: 1.5rem; font-weight: 600; color: rgb(43, 45, 63); margin-bottom: 0.75rem;">How should incoming calls be answered during <span style="background: rgb(254, 249, 195); padding: 0.125rem 4px;">open hours</span>?</h2>
          
          <!-- Info Box -->
          <div style="background: rgb(245, 248, 255); border-left: 3px solid rgb(13, 98, 255); border-radius: 0.375rem; padding: 1rem 1.25rem; margin-bottom: 1.5rem;">
            <div style="display: flex; align-items: start; gap: 0.75rem;">
              <i data-lucide="info" style="width: 18px; height: 18px; color: rgb(13, 98, 255); flex-shrink: 0; margin-top: 0.125rem;"></i>
              <p style="font-size: 0.875rem; color: rgb(43, 45, 63); line-height: 1.5; margin: 0;">
                <strong>Backup Call Flow:</strong> This routing is your default call flow when Google Virtual Assistant is turned off or when AI minutes are depleted. Your business hours apply to both this flow and the Google Assistant.
              </p>
            </div>
          </div>

          <!-- Routing Option Cards -->
          <div style="display: grid; grid-template-columns: repeat(4, 1fr); gap: 1.25rem; margin-top: 40px;">
            <!-- Keypad Options + Greeting -->
            <div onclick="goToKeypadConfig('open')" style="background: linear-gradient(135deg, white 0%, rgb(245, 248, 255) 100%); border: 2px solid rgb(241, 242, 246); border-radius: 0.75rem; padding: 1.75rem 24px; cursor: pointer; transition: all 0.3s; display: flex; flex-direction: column; height: 300px; position: relative; overflow: hidden;" onmouseover="this.style.borderColor='rgb(13, 98, 255)'; this.style.boxShadow='0 8px 24px rgba(13,98,255,0.12)'; this.style.transform='translateY(-4px)'" onmouseout="this.style.borderColor='rgb(241, 242, 246)'; this.style.boxShadow='none'; this.style.transform='translateY(0)'">
              <div style="position: absolute; top: -20px; right: -20px; width: 80px; height: 5rem; background: radial-gradient(circle, rgba(13,98,255,0.08) 0%, transparent 70%); border-radius: 50%;"></div>
              <div style="width: 56px; height: 56px; background: linear-gradient(135deg, rgb(224, 242, 254) 0%, rgb(186, 230, 253) 100%); border-radius: 0.75rem; display: flex; align-items: center; justify-content: center; margin-bottom: 1rem; box-shadow: 0 4px 12px rgba(13,98,255,0.15);">
                <i data-lucide="grid-3x3" style="width: 28px; height: 28px; color: rgb(13, 98, 255); stroke-width: 2.5;"></i>
              </div>
              <h3 style="font-size: 1rem; font-weight: 600; color: rgb(43, 45, 63); margin-bottom: 10px; line-height: 1.3;">Keypad Options + Greeting</h3>
              <p style="font-size: 0.8125rem; color: rgb(112, 113, 125); line-height: 1.5;">Callers route themselves using interactive keypad menu options</p>
            </div>

            <!-- User or External Number -->
            <div style="background: linear-gradient(135deg, white 0%, rgb(245, 248, 255) 100%); border: 2px solid rgb(241, 242, 246); border-radius: 0.75rem; padding: 1.75rem 24px; cursor: pointer; transition: all 0.3s; display: flex; flex-direction: column; height: 300px; position: relative; overflow: hidden;" onmouseover="this.style.borderColor='rgb(13, 98, 255)'; this.style.boxShadow='0 8px 24px rgba(13,98,255,0.12)'; this.style.transform='translateY(-4px)'" onmouseout="this.style.borderColor='rgb(241, 242, 246)'; this.style.boxShadow='none'; this.style.transform='translateY(0)'">
              <div style="position: absolute; top: -20px; right: -20px; width: 80px; height: 5rem; background: radial-gradient(circle, rgba(13,98,255,0.08) 0%, transparent 70%); border-radius: 50%;"></div>
              <div style="width: 56px; height: 56px; background: linear-gradient(135deg, rgb(224, 242, 254) 0%, rgb(186, 230, 253) 100%); border-radius: 0.75rem; display: flex; align-items: center; justify-content: center; margin-bottom: 1rem; box-shadow: 0 4px 12px rgba(13,98,255,0.15);">
                <i data-lucide="phone-forwarded" style="width: 28px; height: 28px; color: rgb(13, 98, 255); stroke-width: 2.5;"></i>
              </div>
              <h3 style="font-size: 1rem; font-weight: 600; color: rgb(43, 45, 63); margin-bottom: 10px; line-height: 1.3;">User or External Number</h3>
              <p style="font-size: 0.8125rem; color: rgb(112, 113, 125); line-height: 1.5;">Route calls directly to a user or external answering service</p>
            </div>

            <!-- Hunt Group -->
            <div style="background: linear-gradient(135deg, white 0%, rgb(245, 248, 255) 100%); border: 2px solid rgb(241, 242, 246); border-radius: 0.75rem; padding: 1.75rem 24px; cursor: pointer; transition: all 0.3s; display: flex; flex-direction: column; height: 300px; position: relative; overflow: hidden;" onmouseover="this.style.borderColor='rgb(13, 98, 255)'; this.style.boxShadow='0 8px 24px rgba(13,98,255,0.12)'; this.style.transform='translateY(-4px)'" onmouseout="this.style.borderColor='rgb(241, 242, 246)'; this.style.boxShadow='none'; this.style.transform='translateY(0)'">
              <div style="position: absolute; top: -20px; right: -20px; width: 80px; height: 5rem; background: radial-gradient(circle, rgba(13,98,255,0.08) 0%, transparent 70%); border-radius: 50%;"></div>
              <div style="width: 56px; height: 56px; background: linear-gradient(135deg, rgb(224, 242, 254) 0%, rgb(186, 230, 253) 100%); border-radius: 0.75rem; display: flex; align-items: center; justify-content: center; margin-bottom: 1rem; box-shadow: 0 4px 12px rgba(13,98,255,0.15);">
                <i data-lucide="users-round" style="width: 28px; height: 28px; color: rgb(13, 98, 255); stroke-width: 2.5;"></i>
              </div>
              <h3 style="font-size: 1rem; font-weight: 600; color: rgb(43, 45, 63); margin-bottom: 10px; line-height: 1.3;">Hunt Group</h3>
              <p style="font-size: 0.8125rem; color: rgb(112, 113, 125); line-height: 1.5;">Route calls to a group of users in sequence or simultaneously</p>
            </div>

            <!-- Voicemail -->
            <div style="background: linear-gradient(135deg, white 0%, rgb(245, 248, 255) 100%); border: 2px solid rgb(241, 242, 246); border-radius: 0.75rem; padding: 1.75rem 24px; cursor: pointer; transition: all 0.3s; display: flex; flex-direction: column; height: 300px; position: relative; overflow: hidden;" onmouseover="this.style.borderColor='rgb(13, 98, 255)'; this.style.boxShadow='0 8px 24px rgba(13,98,255,0.12)'; this.style.transform='translateY(-4px)'" onmouseout="this.style.borderColor='rgb(241, 242, 246)'; this.style.boxShadow='none'; this.style.transform='translateY(0)'">
              <div style="position: absolute; top: -20px; right: -20px; width: 80px; height: 5rem; background: radial-gradient(circle, rgba(13,98,255,0.08) 0%, transparent 70%); border-radius: 50%;"></div>
              <div style="width: 56px; height: 56px; background: linear-gradient(135deg, rgb(224, 242, 254) 0%, rgb(186, 230, 253) 100%); border-radius: 0.75rem; display: flex; align-items: center; justify-content: center; margin-bottom: 1rem; box-shadow: 0 4px 12px rgba(13,98,255,0.15);">
                <i data-lucide="voicemail" style="width: 28px; height: 28px; color: rgb(13, 98, 255); stroke-width: 2.5;"></i>
              </div>
              <h3 style="font-size: 1rem; font-weight: 600; color: rgb(43, 45, 63); margin-bottom: 10px; line-height: 1.3;">Voicemail</h3>
              <p style="font-size: 0.8125rem; color: rgb(112, 113, 125); line-height: 1.5;">Route calls to a voicemail box for later retrieval</p>
            </div>
          </div>
        </div>

        <!-- Bottom Actions - Fixed -->
        <div class="wizard-bottom-actions" style="position: fixed; bottom: 0; left: 340px; right: 0; background: white; padding: 1.25rem 24px; border-top: 1px solid rgb(241, 242, 246); display: flex; justify-content: flex-start; align-items: center; z-index: 50; box-shadow: 0 -2px 8px rgba(0,0,0,0.08); transition: left 0.3s ease;">
          <button onclick="backToHolidays()" style="display: inline-flex; align-items: center; gap: 0.5rem; background: none; border: none; color: rgb(13, 98, 255); font-size: 0.8125rem; font-weight: 600; text-transform: uppercase; letter-spacing: 0.5px; cursor: pointer; padding: 0;" onmouseover="this.style.opacity='0.8'" onmouseout="this.style.opacity='1'">
            <i data-lucide="chevron-left" style="width: 18px; height: 18px;"></i>
            <span>BACK</span>
          </button>
        </div>
        
        <!-- Spacer for fixed bottom bar -->
        <div style="height: 5rem;"></div>
      </div>

      <!-- Setup: Routing Action (Closed Hours & Holidays) -->
      <div id="setup-routing-closed" style="display: none;">
        <!-- Wizard Header -->
        <div style="background: white; padding: 1.5rem 24px 20px 24px; margin: -24px -24px 24px -24px; box-shadow: 0 1px 3px rgba(0,0,0,0.1);">
          <div style="display: flex; align-items: center; justify-content: space-between; margin-bottom: 1.5rem;">
            <h1 style="font-size: 1.25rem; font-weight: 600; color: rgb(43, 45, 63); margin: 0;">Call Flow Setup</h1>
            <button onclick="saveAndExit()" style="background: none; border: 1px solid rgb(221, 221, 226); color: rgb(13, 98, 255); padding: 0.5rem 20px; border-radius: 0.25rem; font-size: 0.8125rem; font-weight: 600; text-transform: uppercase; letter-spacing: 0.5px; cursor: pointer; transition: all 0.15s;" onmouseover="this.style.background='rgb(252, 252, 252)'" onmouseout="this.style.background='none'">
              SAVE & EXIT
            </button>
          </div>

          <!-- Wizard Steps -->
          <div style="display: flex; align-items: center; gap: 0; position: relative;">
            <!-- Step 1 - Completed (Clickable) -->
            <div onclick="navigateToStep('setup-holidays')" style="flex: 1; display: flex; align-items: center; gap: 0.5rem; position: relative; cursor: pointer; transition: opacity 0.15s;" onmouseover="this.style.opacity='0.7'" onmouseout="this.style.opacity='1'" title="Go back to Schedules">
              <div style="width: 32px; height: 32px; border-radius: 50%; background: rgb(34, 197, 94); color: white; display: flex; align-items: center; justify-content: center; font-size: 0.875rem; font-weight: 600; z-index: 2; position: relative;">
                <i data-lucide="check" style="width: 18px; height: 18px;"></i>
              </div>
              <span style="font-size: 0.875rem; font-weight: 500; color: rgb(89, 90, 105); position: relative; z-index: 2; background: white; padding-left: 0.5rem; padding-right: 0.5rem;">Schedules</span>
              <div style="position: absolute; left: 16px; top: 15px; height: 2px; background: rgb(34, 197, 94); width: 100%; z-index: 0;"></div>
            </div>

            <!-- Step 2 - Completed (Clickable) -->
            <div onclick="navigateToStep('setup-routing')" style="flex: 1; display: flex; align-items: center; gap: 0.5rem; position: relative; cursor: pointer; transition: opacity 0.15s;" onmouseover="this.style.opacity='0.7'" onmouseout="this.style.opacity='1'" title="Go back to Open Hours">
              <div style="width: 32px; height: 32px; border-radius: 50%; background: rgb(34, 197, 94); color: white; display: flex; align-items: center; justify-content: center; font-size: 0.875rem; font-weight: 600; z-index: 2; position: relative;">
                <i data-lucide="check" style="width: 18px; height: 18px;"></i>
              </div>
              <span style="font-size: 0.875rem; font-weight: 500; color: rgb(89, 90, 105); position: relative; z-index: 2; background: white; padding-left: 0.5rem; padding-right: 0.5rem;">Open Hours</span>
              <div style="position: absolute; left: 16px; top: 15px; height: 2px; background: rgb(34, 197, 94); width: 100%; z-index: 0;"></div>
            </div>

            <!-- Step 3 - Active -->
            <div style="flex: 1; display: flex; align-items: center; gap: 0.5rem; position: relative;">
              <div style="width: 32px; height: 32px; border-radius: 50%; background: rgb(13, 98, 255); color: white; display: flex; align-items: center; justify-content: center; font-size: 0.875rem; font-weight: 600; z-index: 2; position: relative;">3</div>
              <span style="font-size: 0.875rem; font-weight: 600; color: rgb(13, 98, 255); position: relative; z-index: 2; background: white; padding-left: 0.5rem; padding-right: 0.5rem;">Closed Hours</span>
              <div style="position: absolute; left: 16px; top: 15px; height: 2px; background: rgb(241, 242, 246); width: 100%; z-index: 0;"></div>
            </div>

            <!-- Step 4 - Inactive -->
            <div style="flex: 1; display: flex; align-items: center; gap: 0.5rem; position: relative;">
              <div style="width: 32px; height: 32px; border-radius: 50%; background: rgb(249, 249, 250); border: 2px solid rgb(221, 221, 226); color: rgb(180, 181, 187); display: flex; align-items: center; justify-content: center; font-size: 0.875rem; font-weight: 600; z-index: 2; position: relative;">4</div>
              <span style="font-size: 0.875rem; font-weight: 500; color: rgb(180, 181, 187); position: relative; z-index: 2; background: white; padding-left: 0.5rem; padding-right: 0.5rem;">Failover</span>
              <div style="position: absolute; left: 16px; top: 15px; height: 2px; background: rgb(241, 242, 246); width: 100%; z-index: 0;"></div>
            </div>

            <!-- Step 5 - Inactive -->
            <div style="flex: 1; display: flex; align-items: center; gap: 0.5rem; position: relative;">
              <div style="width: 32px; height: 32px; border-radius: 50%; background: rgb(249, 249, 250); border: 2px solid rgb(221, 221, 226); color: rgb(180, 181, 187); display: flex; align-items: center; justify-content: center; font-size: 0.875rem; font-weight: 600; z-index: 2; position: relative;">5</div>
              <span style="font-size: 0.875rem; font-weight: 500; color: rgb(180, 181, 187); position: relative; z-index: 2; background: white; padding-left: 0.5rem; padding-right: 0.5rem;">Virtual Assistant</span>
            </div>
          </div>
        </div>

        <!-- Section Header -->
        <div style="margin-bottom: 2rem;">
          <div style="font-size: 0.75rem; font-weight: 600; color: rgb(112, 113, 125); text-transform: uppercase; letter-spacing: 1px; margin-bottom: 0.5rem; text-decoration: underline; text-decoration-thickness: 2px; text-underline-offset: 4px;">ROUTING ACTION</div>
        </div>

        <!-- Content -->
        <div style="max-width: 1200px;">
          <h2 style="font-size: 1.5rem; font-weight: 600; color: rgb(43, 45, 63); margin-bottom: 0.75rem;">How should incoming calls be answered during <span style="background: rgb(254, 249, 195); padding: 0.125rem 4px;">closed hours & holidays</span>?</h2>
          
          <!-- Info Box -->
          <div style="background: rgb(245, 248, 255); border-left: 3px solid rgb(13, 98, 255); border-radius: 0.375rem; padding: 1rem 1.25rem; margin-bottom: 1.5rem;">
            <div style="display: flex; align-items: start; gap: 0.75rem;">
              <i data-lucide="info" style="width: 18px; height: 18px; color: rgb(13, 98, 255); flex-shrink: 0; margin-top: 0.125rem;"></i>
              <p style="font-size: 0.875rem; color: rgb(43, 45, 63); line-height: 1.5; margin: 0;">
                <strong>Backup Call Flow:</strong> This routing is your default call flow when Google Virtual Assistant is turned off or when AI minutes are depleted. Your business hours apply to both this flow and the Google Assistant.
              </p>
            </div>
          </div>

          <!-- Routing Option Cards (Reusing same design) -->
          <div style="display: grid; grid-template-columns: repeat(4, 1fr); gap: 1.25rem; margin-top: 40px;">
            <!-- Keypad Options + Greeting -->
            <div onclick="goToKeypadConfig('closed')" style="background: linear-gradient(135deg, white 0%, rgb(245, 248, 255) 100%); border: 2px solid rgb(241, 242, 246); border-radius: 0.75rem; padding: 1.75rem 24px; cursor: pointer; transition: all 0.3s; display: flex; flex-direction: column; height: 300px; position: relative; overflow: hidden;" onmouseover="this.style.borderColor='rgb(13, 98, 255)'; this.style.boxShadow='0 8px 24px rgba(13,98,255,0.12)'; this.style.transform='translateY(-4px)'" onmouseout="this.style.borderColor='rgb(241, 242, 246)'; this.style.boxShadow='none'; this.style.transform='translateY(0)'">
              <div style="position: absolute; top: -20px; right: -20px; width: 80px; height: 5rem; background: radial-gradient(circle, rgba(13,98,255,0.08) 0%, transparent 70%); border-radius: 50%;"></div>
              <div style="width: 56px; height: 56px; background: linear-gradient(135deg, rgb(224, 242, 254) 0%, rgb(186, 230, 253) 100%); border-radius: 0.75rem; display: flex; align-items: center; justify-content: center; margin-bottom: 1rem; box-shadow: 0 4px 12px rgba(13,98,255,0.15);">
                <i data-lucide="grid-3x3" style="width: 28px; height: 28px; color: rgb(13, 98, 255); stroke-width: 2.5;"></i>
              </div>
              <h3 style="font-size: 1rem; font-weight: 600; color: rgb(43, 45, 63); margin-bottom: 10px; line-height: 1.3;">Keypad Options + Greeting</h3>
              <p style="font-size: 0.8125rem; color: rgb(112, 113, 125); line-height: 1.5;">Callers route themselves using interactive keypad menu options</p>
            </div>

            <!-- User or External Number -->
            <div onclick="saveRoutingClosedAndNext()" style="background: linear-gradient(135deg, white 0%, rgb(245, 248, 255) 100%); border: 2px solid rgb(241, 242, 246); border-radius: 0.75rem; padding: 1.75rem 24px; cursor: pointer; transition: all 0.3s; display: flex; flex-direction: column; height: 300px; position: relative; overflow: hidden;" onmouseover="this.style.borderColor='rgb(13, 98, 255)'; this.style.boxShadow='0 8px 24px rgba(13,98,255,0.12)'; this.style.transform='translateY(-4px)'" onmouseout="this.style.borderColor='rgb(241, 242, 246)'; this.style.boxShadow='none'; this.style.transform='translateY(0)'">
              <div style="position: absolute; top: -20px; right: -20px; width: 80px; height: 5rem; background: radial-gradient(circle, rgba(13,98,255,0.08) 0%, transparent 70%); border-radius: 50%;"></div>
              <div style="width: 56px; height: 56px; background: linear-gradient(135deg, rgb(224, 242, 254) 0%, rgb(186, 230, 253) 100%); border-radius: 0.75rem; display: flex; align-items: center; justify-content: center; margin-bottom: 1rem; box-shadow: 0 4px 12px rgba(13,98,255,0.15);">
                <i data-lucide="phone-forwarded" style="width: 28px; height: 28px; color: rgb(13, 98, 255); stroke-width: 2.5;"></i>
              </div>
              <h3 style="font-size: 1rem; font-weight: 600; color: rgb(43, 45, 63); margin-bottom: 10px; line-height: 1.3;">User or External Number</h3>
              <p style="font-size: 0.8125rem; color: rgb(112, 113, 125); line-height: 1.5;">Route calls directly to a user or external answering service</p>
            </div>

            <!-- Hunt Group -->
            <div onclick="saveRoutingClosedAndNext()" style="background: linear-gradient(135deg, white 0%, rgb(245, 248, 255) 100%); border: 2px solid rgb(241, 242, 246); border-radius: 0.75rem; padding: 1.75rem 24px; cursor: pointer; transition: all 0.3s; display: flex; flex-direction: column; height: 300px; position: relative; overflow: hidden;" onmouseover="this.style.borderColor='rgb(13, 98, 255)'; this.style.boxShadow='0 8px 24px rgba(13,98,255,0.12)'; this.style.transform='translateY(-4px)'" onmouseout="this.style.borderColor='rgb(241, 242, 246)'; this.style.boxShadow='none'; this.style.transform='translateY(0)'">
              <div style="position: absolute; top: -20px; right: -20px; width: 80px; height: 5rem; background: radial-gradient(circle, rgba(13,98,255,0.08) 0%, transparent 70%); border-radius: 50%;"></div>
              <div style="width: 56px; height: 56px; background: linear-gradient(135deg, rgb(224, 242, 254) 0%, rgb(186, 230, 253) 100%); border-radius: 0.75rem; display: flex; align-items: center; justify-content: center; margin-bottom: 1rem; box-shadow: 0 4px 12px rgba(13,98,255,0.15);">
                <i data-lucide="users-round" style="width: 28px; height: 28px; color: rgb(13, 98, 255); stroke-width: 2.5;"></i>
              </div>
              <h3 style="font-size: 1rem; font-weight: 600; color: rgb(43, 45, 63); margin-bottom: 10px; line-height: 1.3;">Hunt Group</h3>
              <p style="font-size: 0.8125rem; color: rgb(112, 113, 125); line-height: 1.5;">Route calls to a group of users in sequence or simultaneously</p>
            </div>

            <!-- Voicemail -->
            <div onclick="saveRoutingClosedAndNext()" style="background: linear-gradient(135deg, white 0%, rgb(245, 248, 255) 100%); border: 2px solid rgb(241, 242, 246); border-radius: 0.75rem; padding: 1.75rem 24px; cursor: pointer; transition: all 0.3s; display: flex; flex-direction: column; height: 300px; position: relative; overflow: hidden;" onmouseover="this.style.borderColor='rgb(13, 98, 255)'; this.style.boxShadow='0 8px 24px rgba(13,98,255,0.12)'; this.style.transform='translateY(-4px)'" onmouseout="this.style.borderColor='rgb(241, 242, 246)'; this.style.boxShadow='none'; this.style.transform='translateY(0)'">
              <div style="position: absolute; top: -20px; right: -20px; width: 80px; height: 5rem; background: radial-gradient(circle, rgba(13,98,255,0.08) 0%, transparent 70%); border-radius: 50%;"></div>
              <div style="width: 56px; height: 56px; background: linear-gradient(135deg, rgb(224, 242, 254) 0%, rgb(186, 230, 253) 100%); border-radius: 0.75rem; display: flex; align-items: center; justify-content: center; margin-bottom: 1rem; box-shadow: 0 4px 12px rgba(13,98,255,0.15);">
                <i data-lucide="voicemail" style="width: 28px; height: 28px; color: rgb(13, 98, 255); stroke-width: 2.5;"></i>
              </div>
              <h3 style="font-size: 1rem; font-weight: 600; color: rgb(43, 45, 63); margin-bottom: 10px; line-height: 1.3;">Voicemail</h3>
              <p style="font-size: 0.8125rem; color: rgb(112, 113, 125); line-height: 1.5;">Route calls to a voicemail box for later retrieval</p>
            </div>
          </div>
        </div>

        <!-- Bottom Actions - Fixed -->
        <div class="wizard-bottom-actions" style="position: fixed; bottom: 0; left: 340px; right: 0; background: white; padding: 1.25rem 24px; border-top: 1px solid rgb(241, 242, 246); display: flex; justify-content: flex-start; align-items: center; z-index: 50; box-shadow: 0 -2px 8px rgba(0,0,0,0.08); transition: left 0.3s ease;">
          <button onclick="backToRouting()" style="display: inline-flex; align-items: center; gap: 0.5rem; background: none; border: none; color: rgb(13, 98, 255); font-size: 0.8125rem; font-weight: 600; text-transform: uppercase; letter-spacing: 0.5px; cursor: pointer; padding: 0;" onmouseover="this.style.opacity='0.8'" onmouseout="this.style.opacity='1'">
            <i data-lucide="chevron-left" style="width: 18px; height: 18px;"></i>
            <span>BACK</span>
          </button>
        </div>
        
        <!-- Spacer for fixed bottom bar -->
        <div style="height: 5rem;"></div>
      </div>

      <!-- Setup: CFNR (Call Forward No Reply) Configuration -->
      <div id="setup-cfnr" style="display: none;">
        <!-- Wizard Header -->
        <div style="background: white; padding: 1.5rem 24px 20px 24px; margin: -24px -24px 24px -24px; box-shadow: 0 1px 3px rgba(0,0,0,0.1);">
          <div style="display: flex; align-items: center; justify-content: space-between; margin-bottom: 1.5rem;">
            <h1 style="font-size: 1.25rem; font-weight: 600; color: rgb(43, 45, 63); margin: 0;">Call Flow Setup</h1>
            <button onclick="saveAndExit()" style="background: none; border: 1px solid rgb(221, 221, 226); color: rgb(13, 98, 255); padding: 0.5rem 20px; border-radius: 0.25rem; font-size: 0.8125rem; font-weight: 600; text-transform: uppercase; letter-spacing: 0.5px; cursor: pointer; transition: all 0.15s;" onmouseover="this.style.background='rgb(252, 252, 252)'" onmouseout="this.style.background='none'">
              SAVE & EXIT
            </button>
          </div>

          <!-- Wizard Steps -->
          <div style="display: flex; align-items: center; gap: 0; position: relative;">
            <!-- Step 1 - Completed (Clickable) -->
            <div onclick="navigateToStep('setup-holidays')" style="flex: 1; display: flex; align-items: center; gap: 0.5rem; position: relative; cursor: pointer; transition: opacity 0.15s;" onmouseover="this.style.opacity='0.7'" onmouseout="this.style.opacity='1'" title="Go back to Schedules">
              <div style="width: 32px; height: 32px; border-radius: 50%; background: rgb(34, 197, 94); color: white; display: flex; align-items: center; justify-content: center; font-size: 0.875rem; font-weight: 600; z-index: 2; position: relative;">
                <i data-lucide="check" style="width: 18px; height: 18px;"></i>
              </div>
              <span style="font-size: 0.875rem; font-weight: 500; color: rgb(89, 90, 105); position: relative; z-index: 2; background: white; padding-left: 0.5rem; padding-right: 0.5rem;">Schedules</span>
              <div style="position: absolute; left: 16px; top: 15px; height: 2px; background: rgb(34, 197, 94); width: 100%; z-index: 0;"></div>
            </div>

            <!-- Step 2 - Completed (Clickable) -->
            <div onclick="navigateToStep('setup-routing')" style="flex: 1; display: flex; align-items: center; gap: 0.5rem; position: relative; cursor: pointer; transition: opacity 0.15s;" onmouseover="this.style.opacity='0.7'" onmouseout="this.style.opacity='1'" title="Go back to Open Hours">
              <div style="width: 32px; height: 32px; border-radius: 50%; background: rgb(34, 197, 94); color: white; display: flex; align-items: center; justify-content: center; font-size: 0.875rem; font-weight: 600; z-index: 2; position: relative;">
                <i data-lucide="check" style="width: 18px; height: 18px;"></i>
              </div>
              <span style="font-size: 0.875rem; font-weight: 500; color: rgb(89, 90, 105); position: relative; z-index: 2; background: white; padding-left: 0.5rem; padding-right: 0.5rem;">Open Hours</span>
              <div style="position: absolute; left: 16px; top: 15px; height: 2px; background: rgb(34, 197, 94); width: 100%; z-index: 0;"></div>
            </div>

            <!-- Step 3 - Completed (Clickable) -->
            <div onclick="navigateToStep('setup-routing-closed')" style="flex: 1; display: flex; align-items: center; gap: 0.5rem; position: relative; cursor: pointer; transition: opacity 0.15s;" onmouseover="this.style.opacity='0.7'" onmouseout="this.style.opacity='1'" title="Go back to Closed Hours">
              <div style="width: 32px; height: 32px; border-radius: 50%; background: rgb(34, 197, 94); color: white; display: flex; align-items: center; justify-content: center; font-size: 0.875rem; font-weight: 600; z-index: 2; position: relative;">
                <i data-lucide="check" style="width: 18px; height: 18px;"></i>
              </div>
              <span style="font-size: 0.875rem; font-weight: 500; color: rgb(89, 90, 105); position: relative; z-index: 2; background: white; padding-left: 0.5rem; padding-right: 0.5rem;">Closed Hours</span>
              <div style="position: absolute; left: 16px; top: 15px; height: 2px; background: rgb(34, 197, 94); width: 100%; z-index: 0;"></div>
            </div>

            <!-- Step 4 - Active -->
            <div style="flex: 1; display: flex; align-items: center; gap: 0.5rem; position: relative;">
              <div style="width: 32px; height: 32px; border-radius: 50%; background: rgb(13, 98, 255); color: white; display: flex; align-items: center; justify-content: center; font-size: 0.875rem; font-weight: 600; z-index: 2; position: relative;">4</div>
              <span style="font-size: 0.875rem; font-weight: 600; color: rgb(13, 98, 255); position: relative; z-index: 2; background: white; padding-left: 0.5rem; padding-right: 0.5rem;">Failover</span>
              <div style="position: absolute; left: 16px; top: 15px; height: 2px; background: rgb(241, 242, 246); width: 100%; z-index: 0;"></div>
            </div>

            <!-- Step 5 - Inactive -->
            <div style="flex: 1; display: flex; align-items: center; gap: 0.5rem; position: relative;">
              <div style="width: 32px; height: 32px; border-radius: 50%; background: rgb(249, 249, 250); border: 2px solid rgb(221, 221, 226); color: rgb(180, 181, 187); display: flex; align-items: center; justify-content: center; font-size: 0.875rem; font-weight: 600; z-index: 2; position: relative;">5</div>
              <span style="font-size: 0.875rem; font-weight: 500; color: rgb(180, 181, 187); position: relative; z-index: 2; background: white; padding-left: 0.5rem; padding-right: 0.5rem;">Virtual Assistant</span>
            </div>
          </div>
        </div>

        <!-- Section Header -->
        <div style="margin-bottom: 2rem;">
          <div style="font-size: 0.75rem; font-weight: 600; color: rgb(112, 113, 125); text-transform: uppercase; letter-spacing: 1px; margin-bottom: 0.5rem; text-decoration: underline; text-decoration-thickness: 2px; text-underline-offset: 4px;">FAILOVER ROUTING</div>
        </div>

        <!-- Content -->
        <div style="max-width: 900px;">
          <h2 style="font-size: 1.5rem; font-weight: 600; color: rgb(43, 45, 63); margin-bottom: 0.5rem;">Where should calls route if the Google Virtual Assistant fails?</h2>
          <p style="font-size: 0.875rem; color: rgb(112, 113, 125); margin-bottom: 2rem;">Configure emergency failover routing for situations when the Google Virtual Assistant experiences technical failures or network issues.</p>

          <!-- Info Banner -->
          <div style="background: rgb(245, 248, 255); border: 1px solid rgb(194, 216, 255); border-radius: 0.5rem; padding: 1rem; display: flex; gap: 0.75rem; margin-bottom: 2rem;">
            <i data-lucide="info" style="width: 20px; height: 20px; color: rgb(13, 98, 255); flex-shrink: 0; margin-top: 0.125rem;"></i>
            <p style="font-size: 0.875rem; color: rgb(43, 45, 63); line-height: 1.5; margin: 0;">This failover is specifically for Google Assistant technical failures. When the assistant is turned off or minutes are depleted, calls automatically use your backup call flow.</p>
          </div>

          <!-- Selection Card -->
          <div style="background: white; border: 1px solid rgb(241, 242, 246); border-radius: 0.75rem; padding: 1.75rem; margin-bottom: 2rem;">
            <h3 style="font-size: 1rem; font-weight: 600; color: rgb(43, 45, 63); margin-bottom: 1.25rem;">Failover Destination</h3>
            
            <!-- Single Phone Number Input with Searchable Dropdown -->
            <div style="position: relative;">
              <label style="display: block; font-size: 0.8125rem; font-weight: 600; color: rgb(89, 90, 105); margin-bottom: 0.5rem;">Phone Number or Extension</label>
              <div style="position: relative;">
                <input 
                  type="text" 
                  id="cfnr-phone-number" 
                  placeholder="Enter phone number or browse existing numbers" 
                  style="width: 100%; padding: 0.625rem 48px 0.625rem 12px; border: 1px solid rgb(221, 221, 226); border-radius: 0.375rem; font-size: 0.875rem; color: rgb(43, 45, 63); background: white;"
                  onfocus="showCFNRDropdown()"
                  oninput="formatPhoneNumberInput(this); filterCFNRNumbers()">
                <button 
                  type="button"
                  onclick="toggleCFNRDropdown()"
                  style="position: absolute; right: 12px; top: 50%; transform: translateY(-50%); background: none; border: none; color: rgb(112, 113, 125); cursor: pointer; padding: 0.25rem; display: flex; align-items: center; justify-content: center;"
                  onmouseover="this.style.color='rgb(13, 98, 255)'"
                  onmouseout="this.style.color='rgb(112, 113, 125)'">
                  <i data-lucide="chevron-down" style="width: 20px; height: 20px;"></i>
                </button>
              </div>

              <!-- Searchable Dropdown Panel -->
              <div id="cfnr-dropdown-panel" style="display: none; position: absolute; top: 100%; left: 0; right: 0; margin-top: 0.5rem; background: white; border: 1px solid rgb(221, 221, 226); border-radius: 0.5rem; box-shadow: 0 4px 12px rgba(0,0,0,0.1); max-height: 400px; overflow-y: auto; z-index: 100;">
                <!-- Search within dropdown -->
                <div style="padding: 12px; border-bottom: 1px solid rgb(241, 242, 246); position: sticky; top: 0; background: white; z-index: 10;">
                  <div style="position: relative;">
                    <i data-lucide="search" style="position: absolute; left: 12px; top: 50%; transform: translateY(-50%); width: 16px; height: 16px; color: rgb(180, 181, 187);"></i>
                    <input 
                      type="text" 
                      id="cfnr-dropdown-search" 
                      placeholder="Search numbers..." 
                      style="width: 100%; padding: 0.5rem 12px 0.5rem 36px; border: 1px solid rgb(221, 221, 226); border-radius: 0.375rem; font-size: 0.8125rem;"
                      oninput="filterCFNRNumbers()">
                  </div>
                </div>

                <!-- Numbers List -->
                <div id="cfnr-numbers-container">
                  <!-- Users Section -->
                  <div class="cfnr-category">
                    <div style="padding: 8px 12px; background: rgb(252, 252, 252); font-size: 0.75rem; font-weight: 600; color: rgb(112, 113, 125); text-transform: uppercase; letter-spacing: 0.5px;">Users</div>
                    <div class="cfnr-number-item" data-value="(445) 223-3001 Ext. 3001" data-label="John Smith" data-type="user" onclick="selectCFNRNumber(this)" style="padding: 12px; cursor: pointer; border-bottom: 1px solid rgb(249, 249, 250); transition: background 0.15s;" onmouseover="this.style.background='rgb(245, 248, 255)'" onmouseout="this.style.background='white'">
                      <div style="display: flex; align-items: center; gap: 0.75rem;">
                        <div style="width: 32px; height: 32px; background: rgb(224, 242, 254); border-radius: 0.375rem; display: flex; align-items: center; justify-content: center; flex-shrink: 0;">
                          <i data-lucide="user" style="width: 16px; height: 16px; color: rgb(13, 98, 255);"></i>
                        </div>
                        <div style="flex: 1;">
                          <div style="font-size: 0.875rem; font-weight: 600; color: rgb(43, 45, 63);">John Smith</div>
                          <div style="font-size: 0.75rem; color: rgb(112, 113, 125);">(445) 223-3001 Ext. 3001</div>
                        </div>
                      </div>
                    </div>
                    <div class="cfnr-number-item" data-value="(445) 223-3002 Ext. 3002" data-label="Jane Doe" data-type="user" onclick="selectCFNRNumber(this)" style="padding: 12px; cursor: pointer; border-bottom: 1px solid rgb(249, 249, 250); transition: background 0.15s;" onmouseover="this.style.background='rgb(245, 248, 255)'" onmouseout="this.style.background='white'">
                      <div style="display: flex; align-items: center; gap: 0.75rem;">
                        <div style="width: 32px; height: 32px; background: rgb(224, 242, 254); border-radius: 0.375rem; display: flex; align-items: center; justify-content: center; flex-shrink: 0;">
                          <i data-lucide="user" style="width: 16px; height: 16px; color: rgb(13, 98, 255);"></i>
                        </div>
                        <div style="flex: 1;">
                          <div style="font-size: 0.875rem; font-weight: 600; color: rgb(43, 45, 63);">Jane Doe</div>
                          <div style="font-size: 0.75rem; color: rgb(112, 113, 125);">(445) 223-3002 Ext. 3002</div>
                        </div>
                      </div>
                    </div>
                    <div class="cfnr-number-item" data-value="(445) 223-3003 Ext. 3003" data-label="Mike Johnson" data-type="user" onclick="selectCFNRNumber(this)" style="padding: 12px; cursor: pointer; border-bottom: 1px solid rgb(249, 249, 250); transition: background 0.15s;" onmouseover="this.style.background='rgb(245, 248, 255)'" onmouseout="this.style.background='white'">
                      <div style="display: flex; align-items: center; gap: 0.75rem;">
                        <div style="width: 32px; height: 32px; background: rgb(224, 242, 254); border-radius: 0.375rem; display: flex; align-items: center; justify-content: center; flex-shrink: 0;">
                          <i data-lucide="user" style="width: 16px; height: 16px; color: rgb(13, 98, 255);"></i>
                        </div>
                        <div style="flex: 1;">
                          <div style="font-size: 0.875rem; font-weight: 600; color: rgb(43, 45, 63);">Mike Johnson</div>
                          <div style="font-size: 0.75rem; color: rgb(112, 113, 125);">(445) 223-3003 Ext. 3003</div>
                        </div>
                      </div>
                    </div>
                  </div>

                  <!-- Hunt Groups Section -->
                  <div class="cfnr-category">
                    <div style="padding: 8px 12px; background: rgb(252, 252, 252); font-size: 0.75rem; font-weight: 600; color: rgb(112, 113, 125); text-transform: uppercase; letter-spacing: 0.5px;">Hunt Groups</div>
                    <div class="cfnr-number-item" data-value="(445) 223-3050 Ext. 3050" data-label="Sales Team" data-type="huntgroup" onclick="selectCFNRNumber(this)" style="padding: 12px; cursor: pointer; border-bottom: 1px solid rgb(249, 249, 250); transition: background 0.15s;" onmouseover="this.style.background='rgb(245, 248, 255)'" onmouseout="this.style.background='white'">
                      <div style="display: flex; align-items: center; gap: 0.75rem;">
                        <div style="width: 32px; height: 32px; background: rgb(224, 242, 254); border-radius: 0.375rem; display: flex; align-items: center; justify-content: center; flex-shrink: 0;">
                          <i data-lucide="users" style="width: 16px; height: 16px; color: rgb(13, 98, 255);"></i>
                        </div>
                        <div style="flex: 1;">
                          <div style="font-size: 0.875rem; font-weight: 600; color: rgb(43, 45, 63);">Sales Team</div>
                          <div style="font-size: 0.75rem; color: rgb(112, 113, 125);">(445) 223-3050 Ext. 3050</div>
                        </div>
                      </div>
                    </div>
                    <div class="cfnr-number-item" data-value="(445) 223-3051 Ext. 3051" data-label="Support Queue" data-type="huntgroup" onclick="selectCFNRNumber(this)" style="padding: 12px; cursor: pointer; border-bottom: 1px solid rgb(249, 249, 250); transition: background 0.15s;" onmouseover="this.style.background='rgb(245, 248, 255)'" onmouseout="this.style.background='white'">
                      <div style="display: flex; align-items: center; gap: 0.75rem;">
                        <div style="width: 32px; height: 32px; background: rgb(224, 242, 254); border-radius: 0.375rem; display: flex; align-items: center; justify-content: center; flex-shrink: 0;">
                          <i data-lucide="users" style="width: 16px; height: 16px; color: rgb(13, 98, 255);"></i>
                        </div>
                        <div style="flex: 1;">
                          <div style="font-size: 0.875rem; font-weight: 600; color: rgb(43, 45, 63);">Support Queue</div>
                          <div style="font-size: 0.75rem; color: rgb(112, 113, 125);">(445) 223-3051 Ext. 3051</div>
                        </div>
                      </div>
                    </div>
                    <div class="cfnr-number-item" data-value="(445) 223-3052 Ext. 3052" data-label="Technical Support" data-type="huntgroup" onclick="selectCFNRNumber(this)" style="padding: 12px; cursor: pointer; border-bottom: 1px solid rgb(249, 249, 250); transition: background 0.15s;" onmouseover="this.style.background='rgb(245, 248, 255)'" onmouseout="this.style.background='white'">
                      <div style="display: flex; align-items: center; gap: 0.75rem;">
                        <div style="width: 32px; height: 32px; background: rgb(224, 242, 254); border-radius: 0.375rem; display: flex; align-items: center; justify-content: center; flex-shrink: 0;">
                          <i data-lucide="users" style="width: 16px; height: 16px; color: rgb(13, 98, 255);"></i>
                        </div>
                        <div style="flex: 1;">
                          <div style="font-size: 0.875rem; font-weight: 600; color: rgb(43, 45, 63);">Technical Support</div>
                          <div style="font-size: 0.75rem; color: rgb(112, 113, 125);">(445) 223-3052 Ext. 3052</div>
                        </div>
                      </div>
                    </div>
                  </div>

                  <!-- Voicemail Section -->
                  <div class="cfnr-category">
                    <div style="padding: 8px 12px; background: rgb(252, 252, 252); font-size: 0.75rem; font-weight: 600; color: rgb(112, 113, 125); text-transform: uppercase; letter-spacing: 0.5px;">Voicemail</div>
                    <div class="cfnr-number-item" data-value="(445) 223-3000" data-label="Main Voicemail" data-type="voicemail" onclick="selectCFNRNumber(this)" style="padding: 12px; cursor: pointer; border-bottom: 1px solid rgb(249, 249, 250); transition: background 0.15s;" onmouseover="this.style.background='rgb(245, 248, 255)'" onmouseout="this.style.background='white'">
                      <div style="display: flex; align-items: center; gap: 0.75rem;">
                        <div style="width: 32px; height: 32px; background: rgb(224, 242, 254); border-radius: 0.375rem; display: flex; align-items: center; justify-content: center; flex-shrink: 0;">
                          <i data-lucide="voicemail" style="width: 16px; height: 16px; color: rgb(13, 98, 255);"></i>
                        </div>
                        <div style="flex: 1;">
                          <div style="font-size: 0.875rem; font-weight: 600; color: rgb(43, 45, 63);">Main Voicemail</div>
                          <div style="font-size: 0.75rem; color: rgb(112, 113, 125);">(445) 223-3000</div>
                        </div>
                      </div>
                    </div>
                    <div class="cfnr-number-item" data-value="(445) 223-3060" data-label="Sales Voicemail" data-type="voicemail" onclick="selectCFNRNumber(this)" style="padding: 12px; cursor: pointer; border-bottom: 1px solid rgb(249, 249, 250); transition: background 0.15s;" onmouseover="this.style.background='rgb(245, 248, 255)'" onmouseout="this.style.background='white'">
                      <div style="display: flex; align-items: center; gap: 0.75rem;">
                        <div style="width: 32px; height: 32px; background: rgb(224, 242, 254); border-radius: 0.375rem; display: flex; align-items: center; justify-content: center; flex-shrink: 0;">
                          <i data-lucide="voicemail" style="width: 16px; height: 16px; color: rgb(13, 98, 255);"></i>
                        </div>
                        <div style="flex: 1;">
                          <div style="font-size: 0.875rem; font-weight: 600; color: rgb(43, 45, 63);">Sales Voicemail</div>
                          <div style="font-size: 0.75rem; color: rgb(112, 113, 125);">(445) 223-3060</div>
                        </div>
                      </div>
                    </div>
                    <div class="cfnr-number-item" data-value="(445) 223-3061" data-label="Support Voicemail" data-type="voicemail" onclick="selectCFNRNumber(this)" style="padding: 12px; cursor: pointer; transition: background 0.15s;" onmouseover="this.style.background='rgb(245, 248, 255)'" onmouseout="this.style.background='white'">
                      <div style="display: flex; align-items: center; gap: 0.75rem;">
                        <div style="width: 32px; height: 32px; background: rgb(224, 242, 254); border-radius: 0.375rem; display: flex; align-items: center; justify-content: center; flex-shrink: 0;">
                          <i data-lucide="voicemail" style="width: 16px; height: 16px; color: rgb(13, 98, 255);"></i>
                        </div>
                        <div style="flex: 1;">
                          <div style="font-size: 0.875rem; font-weight: 600; color: rgb(43, 45, 63);">Support Voicemail</div>
                          <div style="font-size: 0.75rem; color: rgb(112, 113, 125);">(445) 223-3061</div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>

              <p style="font-size: 0.75rem; color: rgb(112, 113, 125); margin-top: 0.5rem; display: flex; align-items: center; gap: 0.375rem;">
                <i data-lucide="info" style="width: 14px; height: 14px;"></i>
                <span>You can type a phone number manually or select from your existing numbers</span>
              </p>
            </div>

            <!-- Selected Destination Preview -->
            <div id="cfnr-selection-preview" style="display: none; margin-top: 1.25rem; padding: 1rem; background: rgb(245, 248, 255); border-radius: 0.5rem; border: 1px solid rgb(186, 230, 253);">
              <div style="display: flex; align-items: center; gap: 0.75rem;">
                <div style="width: 40px; height: 40px; background: white; border-radius: 0.5rem; display: flex; align-items: center; justify-content: center; flex-shrink: 0;">
                  <i data-lucide="check-circle" style="width: 20px; height: 20px; color: rgb(34, 197, 94);"></i>
                </div>
                <div>
                  <div style="font-size: 0.75rem; font-weight: 600; color: rgb(13, 98, 255); text-transform: uppercase; letter-spacing: 0.5px; margin-bottom: 0.25rem;">Selected Destination</div>
                  <div id="cfnr-preview-text" style="font-size: 0.875rem; font-weight: 600; color: rgb(43, 45, 63);"></div>
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- Bottom Actions - Fixed -->
        <div class="wizard-bottom-actions" style="position: fixed; bottom: 0; left: 340px; right: 0; background: white; padding: 1.25rem 24px; border-top: 1px solid rgb(241, 242, 246); display: flex; justify-content: space-between; align-items: center; z-index: 50; box-shadow: 0 -2px 8px rgba(0,0,0,0.08); transition: left 0.3s ease;">
          <button onclick="backToCFNRFromRouting()" style="display: inline-flex; align-items: center; gap: 0.5rem; background: none; border: none; color: rgb(13, 98, 255); font-size: 0.8125rem; font-weight: 600; text-transform: uppercase; letter-spacing: 0.5px; cursor: pointer; padding: 0;" onmouseover="this.style.opacity='0.8'" onmouseout="this.style.opacity='1'">
            <i data-lucide="chevron-left" style="width: 18px; height: 18px;"></i>
            <span>BACK</span>
          </button>
          <button onclick="saveCFNRAndNext()" class="action-button-primary" style="font-size: 0.8125rem; padding: 0.75rem 32px;">
            SAVE & NEXT
          </button>
        </div>
        
        <!-- Spacer for fixed bottom bar -->
        <div style="height: 5rem;"></div>
      </div>

      <!-- Setup: Keypad Options Configuration -->
      <div id="setup-keypad" style="display: none;">
        <!-- Wizard Header -->
        <div style="background: white; padding: 1.5rem 24px 20px 24px; margin: -24px -24px 24px -24px; box-shadow: 0 1px 3px rgba(0,0,0,0.1);">
          <div style="display: flex; align-items: center; justify-content: space-between; margin-bottom: 1.5rem;">
            <h1 style="font-size: 1.25rem; font-weight: 600; color: rgb(43, 45, 63); margin: 0;">Call Flow Setup</h1>
            <button onclick="saveAndExit()" style="background: none; border: 1px solid rgb(221, 221, 226); color: rgb(13, 98, 255); padding: 0.5rem 20px; border-radius: 0.25rem; font-size: 0.8125rem; font-weight: 600; text-transform: uppercase; letter-spacing: 0.5px; cursor: pointer; transition: all 0.15s;" onmouseover="this.style.background='rgb(252, 252, 252)'" onmouseout="this.style.background='none'">
              SAVE & EXIT
            </button>
          </div>

          <!-- Wizard Steps -->
          <div id="keypad-stepper" style="display: flex; align-items: center; gap: 0; position: relative; margin-bottom: 1.25rem;">
            <!-- Steps will be dynamically updated based on context -->
          </div>

          <!-- Breadcrumb Navigation -->
          <div style="padding: 0.75rem 0; margin-bottom: 1rem; display: flex; align-items: center; gap: 0.5rem; font-size: 0.875rem;">
            <button onclick="backFromKeypad()" style="display: flex; align-items: center; gap: 0.375rem; color: rgb(112, 113, 125); background: none; border: none; cursor: pointer; padding: 0.25rem 8px; border-radius: 0.25rem; transition: background 0.15s;" onmouseover="this.style.background='rgb(249, 249, 250)'" onmouseout="this.style.background='none'">
              <i data-lucide="check-circle" style="width: 16px; height: 16px; color: rgb(34, 197, 94);"></i>
              Routing Action
            </button>
            <i data-lucide="chevron-right" style="width: 16px; height: 16px; color: rgb(112, 113, 125);"></i>
            <span style="font-weight: 600; color: rgb(13, 98, 255);">Keypad Options</span>
            <i data-lucide="chevron-right" style="width: 16px; height: 16px; color: rgb(112, 113, 125);"></i>
            <span style="color: rgb(180, 181, 187);">Greeting</span>
          </div>
        </div>

        <!-- Keypad Configuration Content -->
        <div style="max-width: 1400px;">
          <h2 style="font-size: 1.5rem; font-weight: 600; color: rgb(43, 45, 63); margin-bottom: 0.5rem;">Set your keypad options</h2>
          <p style="font-size: 0.875rem; color: rgb(112, 113, 125); margin-bottom: 2rem;">Callers will route themselves using these keys.</p>

          <!-- Extension Dialing Toggle -->
          <div style="background: white; border: 1px solid rgb(241, 242, 246); border-radius: 0.5rem; padding: 1.25rem 24px; margin-bottom: 2rem; display: flex; align-items: center; justify-content: space-between;">
            <div>
              <div style="font-size: 0.875rem; font-weight: 600; color: rgb(43, 45, 63); margin-bottom: 0.25rem;">ALLOW FIRST-LEVEL EXTENSION DIALING</div>
              <div style="font-size: 0.8125rem; color: rgb(112, 113, 125);">Allow callers to dial an extension at any time to bypass the Automated Attendant during open hours.</div>
            </div>
            <label class="toggle-switch" style="margin-left: 1.5rem;">
              <input type="checkbox" id="extension-dialing-toggle" checked>
              <span class="toggle-slider"></span>
            </label>
          </div>

          <!-- Two Column Layout -->
          <div style="display: grid; grid-template-columns: 280px 1fr; gap: 2rem;">
            <!-- Left Column: Keypad -->
            <div>
              <h3 style="font-size: 0.875rem; font-weight: 600; color: rgb(43, 45, 63); margin-bottom: 1rem;">ADD/REMOVE KEYS</h3>
              <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 0.75rem; background: white; padding: 1.5rem; border: 1px solid rgb(241, 242, 246); border-radius: 0.5rem;">
                <button style="width: 60px; height: 60px; border: 2px solid rgb(13, 98, 255); background: rgb(224, 242, 254); border-radius: 0.5rem; font-size: 1.25rem; font-weight: 600; color: rgb(13, 98, 255); cursor: pointer; transition: all 0.2s;" onmouseover="this.style.background='rgb(186, 230, 253)'" onmouseout="this.style.background='rgb(224, 242, 254)'">1</button>
                <button style="width: 60px; height: 60px; border: 2px solid rgb(13, 98, 255); background: rgb(224, 242, 254); border-radius: 0.5rem; font-size: 1.25rem; font-weight: 600; color: rgb(13, 98, 255); cursor: pointer; transition: all 0.2s;" onmouseover="this.style.background='rgb(186, 230, 253)'" onmouseout="this.style.background='rgb(224, 242, 254)'">2</button>
                <button style="width: 60px; height: 60px; border: 2px solid rgb(221, 221, 226); background: white; border-radius: 0.5rem; font-size: 1.25rem; font-weight: 600; color: rgb(180, 181, 187); cursor: pointer; transition: all 0.2s;" onmouseover="this.style.background='rgb(252, 252, 252)'" onmouseout="this.style.background='white'">3</button>
                <button style="width: 60px; height: 60px; border: 2px solid rgb(13, 98, 255); background: rgb(224, 242, 254); border-radius: 0.5rem; font-size: 1.25rem; font-weight: 600; color: rgb(13, 98, 255); cursor: pointer; transition: all 0.2s;" onmouseover="this.style.background='rgb(186, 230, 253)'" onmouseout="this.style.background='rgb(224, 242, 254)'">4</button>
                <button style="width: 60px; height: 60px; border: 2px solid rgb(13, 98, 255); background: rgb(224, 242, 254); border-radius: 0.5rem; font-size: 1.25rem; font-weight: 600; color: rgb(13, 98, 255); cursor: pointer; transition: all 0.2s;" onmouseover="this.style.background='rgb(186, 230, 253)'" onmouseout="this.style.background='rgb(224, 242, 254)'">5</button>
                <button style="width: 60px; height: 60px; border: 2px solid rgb(221, 221, 226); background: white; border-radius: 0.5rem; font-size: 1.25rem; font-weight: 600; color: rgb(180, 181, 187); cursor: pointer; transition: all 0.2s;" onmouseover="this.style.background='rgb(252, 252, 252)'" onmouseout="this.style.background='white'">6</button>
                <button style="width: 60px; height: 60px; border: 2px solid rgb(221, 221, 226); background: white; border-radius: 0.5rem; font-size: 1.25rem; font-weight: 600; color: rgb(180, 181, 187); cursor: pointer; transition: all 0.2s;" onmouseover="this.style.background='rgb(252, 252, 252)'" onmouseout="this.style.background='white'">7</button>
                <button style="width: 60px; height: 60px; border: 2px solid rgb(221, 221, 226); background: white; border-radius: 0.5rem; font-size: 1.25rem; font-weight: 600; color: rgb(180, 181, 187); cursor: pointer; transition: all 0.2s;" onmouseover="this.style.background='rgb(252, 252, 252)'" onmouseout="this.style.background='white'">8</button>
                <button style="width: 60px; height: 60px; border: 2px solid rgb(221, 221, 226); background: white; border-radius: 0.5rem; font-size: 1.25rem; font-weight: 600; color: rgb(180, 181, 187); cursor: pointer; transition: all 0.2s;" onmouseover="this.style.background='rgb(252, 252, 252)'" onmouseout="this.style.background='white'">9</button>
                <button style="width: 60px; height: 60px; border: 2px solid rgb(221, 221, 226); background: white; border-radius: 0.5rem; font-size: 1.25rem; font-weight: 600; color: rgb(180, 181, 187); cursor: pointer; transition: all 0.2s;" onmouseover="this.style.background='rgb(252, 252, 252)'" onmouseout="this.style.background='white'">*</button>
                <button style="width: 60px; height: 60px; border: 2px solid rgb(221, 221, 226); background: white; border-radius: 0.5rem; font-size: 1.25rem; font-weight: 600; color: rgb(180, 181, 187); cursor: pointer; transition: all 0.2s;" onmouseover="this.style.background='rgb(252, 252, 252)'" onmouseout="this.style.background='white'">0</button>
                <button style="width: 60px; height: 60px; border: 2px solid rgb(221, 221, 226); background: white; border-radius: 0.5rem; font-size: 1.25rem; font-weight: 600; color: rgb(180, 181, 187); cursor: pointer; transition: all 0.2s;" onmouseover="this.style.background='rgb(252, 252, 252)'" onmouseout="this.style.background='white'">#</button>
              </div>
            </div>

            <!-- Right Column: Routing Actions -->
            <div>
              <h3 style="font-size: 0.875rem; font-weight: 600; color: rgb(43, 45, 63); margin-bottom: 1rem;">ADD ROUTING ACTIONS</h3>
              
              <!-- Routing Action Items -->
              <div style="display: flex; flex-direction: column; gap: 1rem;">
                <!-- Action 1: Hunt Group -->
                <div style="background: white; border: 1px solid rgb(241, 242, 246); border-radius: 0.5rem; padding: 1.25rem;">
                  <div style="display: flex; align-items: center; gap: 1rem; margin-bottom: 1rem;">
                    <div style="display: flex; align-items: center; gap: 0.5rem;">
                      <span style="font-size: 0.8125rem; color: rgb(112, 113, 125);">Press</span>
                      <div style="width: 40px; height: 40px; border: 2px solid rgb(13, 98, 255); background: rgb(224, 242, 254); border-radius: 0.375rem; display: flex; align-items: center; justify-content: center; font-size: 1.125rem; font-weight: 600; color: rgb(13, 98, 255);">1</div>
                      <span style="font-size: 0.8125rem; color: rgb(112, 113, 125);">to</span>
                    </div>
                    <select style="flex: 1; padding: 0.625rem 12px; border: 1px solid rgb(221, 221, 226); border-radius: 0.375rem; font-size: 0.875rem; color: rgb(43, 45, 63); background: white; cursor: pointer;">
                      <option value="">Select routing type...</option>
                      <option value="user">User</option>
                      <option value="external">External Number</option>
                      <option value="huntgroup" selected>Hunt Group</option>
                      <option value="voicemail">Voicemail</option>
                      <option value="menu">Sub-Menu</option>
                    </select>
                    <button style="background: none; border: none; cursor: pointer; padding: 0.5rem;">
                      <i data-lucide="trash-2" style="width: 18px; height: 18px; color: rgb(112, 113, 125);"></i>
                    </button>
                  </div>
                  <div style="padding-left: 84px;">
                    <label style="font-size: 0.8125rem; color: rgb(89, 90, 105); font-weight: 500; display: block; margin-bottom: 0.375rem;">Select Hunt Group</label>
                    <select style="width: 100%; padding: 0.625rem 12px; border: 1px solid rgb(221, 221, 226); border-radius: 0.375rem; font-size: 0.875rem; color: rgb(43, 45, 63); background: white; cursor: pointer; margin-bottom: 0.75rem;">
                      <option value="">Choose a hunt group...</option>
                      <option value="hg1">Sales Team - (445) 223-3050 Ext. 3050</option>
                      <option value="hg2" selected>Unanswered HuntGroup_3 - (445) 223-3051 Ext. 3061</option>
                      <option value="hg3">Support Queue - (445) 223-3052 Ext. 3052</option>
                      <option value="hg4">Technical Support - (445) 223-3053 Ext. 3053</option>
                    </select>
                    <label style="display: flex; align-items: center; gap: 0.5rem; margin-bottom: 0.25rem; cursor: pointer;">
                      <input type="radio" name="transfer-1" value="no-users" style="width: 16px; height: 16px;">
                      <span style="font-size: 0.8125rem; color: rgb(112, 113, 125);">No Users</span>
                    </label>
                    <button style="background: none; border: none; color: rgb(13, 98, 255); font-size: 0.8125rem; font-weight: 600; cursor: pointer; padding: 0; margin-top: 0.5rem;">Configure</button>
                  </div>
                </div>

                <!-- Action 2: User -->
                <div style="background: white; border: 1px solid rgb(241, 242, 246); border-radius: 0.5rem; padding: 1.25rem;">
                  <div style="display: flex; align-items: center; gap: 1rem; margin-bottom: 1rem;">
                    <div style="display: flex; align-items: center; gap: 0.5rem;">
                      <span style="font-size: 0.8125rem; color: rgb(112, 113, 125);">Press</span>
                      <div style="width: 40px; height: 40px; border: 2px solid rgb(13, 98, 255); background: rgb(224, 242, 254); border-radius: 0.375rem; display: flex; align-items: center; justify-content: center; font-size: 1.125rem; font-weight: 600; color: rgb(13, 98, 255);">2</div>
                      <span style="font-size: 0.8125rem; color: rgb(112, 113, 125);">to</span>
                    </div>
                    <select style="flex: 1; padding: 0.625rem 12px; border: 1px solid rgb(221, 221, 226); border-radius: 0.375rem; font-size: 0.875rem; color: rgb(43, 45, 63); background: white; cursor: pointer;">
                      <option value="">Select routing type...</option>
                      <option value="user" selected>User</option>
                      <option value="external">External Number</option>
                      <option value="huntgroup">Hunt Group</option>
                      <option value="voicemail">Voicemail</option>
                      <option value="menu">Sub-Menu</option>
                    </select>
                    <button style="background: none; border: none; cursor: pointer; padding: 0.5rem;">
                      <i data-lucide="trash-2" style="width: 18px; height: 18px; color: rgb(112, 113, 125);"></i>
                    </button>
                  </div>
                  <div style="padding-left: 84px;">
                    <label style="font-size: 0.8125rem; color: rgb(89, 90, 105); font-weight: 500; display: block; margin-bottom: 0.375rem;">Select User</label>
                    <select style="width: 100%; padding: 0.625rem 12px; border: 1px solid rgb(221, 221, 226); border-radius: 0.375rem; font-size: 0.875rem; color: rgb(43, 45, 63); background: white; cursor: pointer;">
                      <option value="">Choose a user...</option>
                      <option value="user1" selected>John Smith - (445) 223-3060 Ext. 3080</option>
                      <option value="user2">Jane Doe - (445) 223-3061 Ext. 3081</option>
                      <option value="user3">Bob Johnson - (445) 223-3062 Ext. 3082</option>
                      <option value="user4">Sarah Williams - (445) 223-3063 Ext. 3083</option>
                    </select>
                  </div>
                </div>

                <!-- Action 4: Voicemail -->
                <div style="background: white; border: 1px solid rgb(241, 242, 246); border-radius: 0.5rem; padding: 1.25rem;">
                  <div style="display: flex; align-items: center; gap: 1rem; margin-bottom: 1rem;">
                    <div style="display: flex; align-items: center; gap: 0.5rem;">
                      <span style="font-size: 0.8125rem; color: rgb(112, 113, 125);">Press</span>
                      <div style="width: 40px; height: 40px; border: 2px solid rgb(13, 98, 255); background: rgb(224, 242, 254); border-radius: 0.375rem; display: flex; align-items: center; justify-content: center; font-size: 1.125rem; font-weight: 600; color: rgb(13, 98, 255);">4</div>
                      <span style="font-size: 0.8125rem; color: rgb(112, 113, 125);">to</span>
                    </div>
                    <select style="flex: 1; padding: 0.625rem 12px; border: 1px solid rgb(221, 221, 226); border-radius: 0.375rem; font-size: 0.875rem; color: rgb(43, 45, 63); background: white; cursor: pointer;">
                      <option value="">Select routing type...</option>
                      <option value="user">User</option>
                      <option value="external">External Number</option>
                      <option value="huntgroup">Hunt Group</option>
                      <option value="voicemail" selected>Voicemail</option>
                      <option value="menu">Sub-Menu</option>
                    </select>
                    <button style="background: none; border: none; cursor: pointer; padding: 0.5rem;">
                      <i data-lucide="trash-2" style="width: 18px; height: 18px; color: rgb(112, 113, 125);"></i>
                    </button>
                  </div>
                  <div style="padding-left: 84px;">
                    <label style="font-size: 0.8125rem; color: rgb(89, 90, 105); font-weight: 500; display: block; margin-bottom: 0.375rem;">Select Voicemail Box</label>
                    <select style="width: 100%; padding: 0.625rem 12px; border: 1px solid rgb(221, 221, 226); border-radius: 0.375rem; font-size: 0.875rem; color: rgb(43, 45, 63); background: white; cursor: pointer; margin-bottom: 1rem;">
                      <option value="">Choose a voicemail box...</option>
                      <option value="vm1">General Mailbox - (445) 223-3060 Ext. 3080</option>
                      <option value="vm2" selected>Jack Smith - (445) 223-3062 Ext. 3082</option>
                      <option value="vm3">Sales Department - (445) 223-3064 Ext. 3084</option>
                      <option value="vm4">Support Team - (445) 223-3065 Ext. 3085</option>
                    </select>
                    
                    <label style="font-size: 0.8125rem; color: rgb(89, 90, 105); font-weight: 500; display: block; margin-bottom: 0.5rem;">Transfer Options</label>
                    <label style="display: flex; align-items: center; gap: 0.5rem; margin-bottom: 0.5rem; cursor: pointer;">
                      <input type="radio" name="transfer-4" value="with-prompt" checked style="width: 16px; height: 16px;">
                      <span style="font-size: 0.8125rem; color: rgb(89, 90, 105);">Transfer With Prompt</span>
                    </label>
                    <div style="font-size: 0.75rem; color: rgb(157, 158, 167); margin-left: 1.5rem; font-style: italic; margin-bottom: 0.5rem;">"Your call is being transferred. Please hold."</div>
                    <label style="display: flex; align-items: center; gap: 0.5rem; cursor: pointer;">
                      <input type="radio" name="transfer-4" value="without-prompt" style="width: 16px; height: 16px;">
                      <span style="font-size: 0.8125rem; color: rgb(89, 90, 105);">Transfer Without Prompt</span>
                    </label>
                  </div>
                </div>

                <!-- Add More Link -->
                <button style="background: none; border: 2px dashed rgb(221, 221, 226); border-radius: 0.5rem; padding: 1rem; color: rgb(13, 98, 255); font-size: 0.875rem; font-weight: 600; cursor: pointer; display: flex; align-items: center; justify-content: center; gap: 0.5rem; transition: all 0.2s;" onmouseover="this.style.background='rgb(252, 252, 252)'" onmouseout="this.style.background='none'">
                  <i data-lucide="plus" style="width: 18px; height: 18px;"></i>
                  Add Action
                </button>
              </div>
            </div>
          </div>
        </div>

        <!-- Bottom Actions - Fixed -->
        <div class="wizard-bottom-actions" style="position: fixed; bottom: 0; left: 340px; right: 0; background: white; padding: 1.25rem 24px; border-top: 1px solid rgb(241, 242, 246); display: flex; justify-content: space-between; align-items: center; z-index: 50; box-shadow: 0 -2px 8px rgba(0,0,0,0.08); transition: left 0.3s ease;">
          <button onclick="backFromKeypad()" style="display: inline-flex; align-items: center; gap: 0.5rem; background: none; border: none; color: rgb(13, 98, 255); font-size: 0.8125rem; font-weight: 600; text-transform: uppercase; letter-spacing: 0.5px; cursor: pointer; padding: 0;" onmouseover="this.style.opacity='0.8'" onmouseout="this.style.opacity='1'">
            <i data-lucide="chevron-left" style="width: 18px; height: 18px;"></i>
            <span>BACK</span>
          </button>
          <button onclick="saveKeypadAndNext()" style="background: rgb(13, 98, 255); color: white; border: none; padding: 0.75rem 32px; border-radius: 0.375rem; font-weight: 600; font-size: 0.875rem; cursor: pointer; transition: all 0.2s;" onmouseover="this.style.background='rgb(8, 59, 153)'" onmouseout="this.style.background='rgb(13, 98, 255)'">
            SAVE & NEXT
          </button>
        </div>
        
        <!-- Spacer for fixed bottom bar -->
        <div style="height: 5rem;"></div>
      </div>

      <!-- Setup: Greeting Configuration -->
      <div id="setup-greeting" style="display: none;">
        <!-- Wizard Header -->
        <div style="background: white; padding: 1.5rem 24px 20px 24px; margin: -24px -24px 24px -24px; box-shadow: 0 1px 3px rgba(0,0,0,0.1);">
          <div style="display: flex; align-items: center; justify-content: space-between; margin-bottom: 1.5rem;">
            <h1 style="font-size: 1.25rem; font-weight: 600; color: rgb(43, 45, 63); margin: 0;">Call Flow Setup</h1>
            <button onclick="saveAndExit()" style="background: none; border: 1px solid rgb(221, 221, 226); color: rgb(13, 98, 255); padding: 0.5rem 20px; border-radius: 0.25rem; font-size: 0.8125rem; font-weight: 600; text-transform: uppercase; letter-spacing: 0.5px; cursor: pointer; transition: all 0.15s;" onmouseover="this.style.background='rgb(252, 252, 252)'" onmouseout="this.style.background='none'">
              SAVE & EXIT
            </button>
          </div>

          <!-- Wizard Steps -->
          <div id="greeting-stepper" style="display: flex; align-items: center; gap: 0; position: relative; margin-bottom: 1.25rem;">
            <!-- Steps will be dynamically updated based on context -->
          </div>

          <!-- Breadcrumb Navigation -->
          <div style="padding: 0.75rem 0; margin-bottom: 1rem; display: flex; align-items: center; gap: 0.5rem; font-size: 0.875rem;">
            <button onclick="backFromGreeting(); backFromKeypad();" style="display: flex; align-items: center; gap: 0.375rem; color: rgb(112, 113, 125); background: none; border: none; cursor: pointer; padding: 0.25rem 8px; border-radius: 0.25rem; transition: background 0.15s;" onmouseover="this.style.background='rgb(249, 249, 250)'" onmouseout="this.style.background='none'">
              <i data-lucide="check-circle" style="width: 16px; height: 16px; color: rgb(34, 197, 94);"></i>
              Routing Action
            </button>
            <i data-lucide="chevron-right" style="width: 16px; height: 16px; color: rgb(112, 113, 125);"></i>
            <button onclick="backFromGreeting()" style="display: flex; align-items: center; gap: 0.375rem; color: rgb(112, 113, 125); background: none; border: none; cursor: pointer; padding: 0.25rem 8px; border-radius: 0.25rem; transition: background 0.15s;" onmouseover="this.style.background='rgb(249, 249, 250)'" onmouseout="this.style.background='none'">
              <i data-lucide="check-circle" style="width: 16px; height: 16px; color: rgb(34, 197, 94);"></i>
              Keypad Options
            </button>
            <i data-lucide="chevron-right" style="width: 16px; height: 16px; color: rgb(112, 113, 125);"></i>
            <span style="font-weight: 600; color: rgb(13, 98, 255);">Greeting</span>
          </div>
        </div>

        <!-- Greeting Configuration Content -->
        <div style="max-width: 1400px;">
          <h2 style="font-size: 1.5rem; font-weight: 600; color: rgb(43, 45, 63); margin-bottom: 0.5rem;">Type, record, or upload your greeting</h2>
          <p style="font-size: 0.875rem; color: rgb(112, 113, 125); margin-bottom: 2rem;">Your greeting should include your keypad options.</p>

          <!-- Two Column Layout -->
          <div style="display: grid; grid-template-columns: 420px 1fr; gap: 2rem;">
            <!-- Left Column: Script Suggestion -->
            <div>
              <div style="background: linear-gradient(135deg, rgb(224, 242, 254) 0%, rgb(245, 248, 255) 100%); border: 1px solid rgb(186, 230, 253); border-radius: 0.75rem; padding: 1.75rem; position: relative;">
                <div style="display: flex; align-items: center; gap: 0.5rem; margin-bottom: 1rem;">
                  <i data-lucide="lightbulb" style="width: 20px; height: 20px; color: rgb(13, 98, 255);"></i>
                  <h3 style="font-size: 1rem; font-weight: 600; color: rgb(43, 45, 63); margin: 0;">TRY THIS SCRIPT</h3>
                </div>
                <p style="font-size: 0.8125rem; color: rgb(89, 90, 105); margin-bottom: 1.25rem;">Thank you for calling [business name].</p>
                
                <div style="display: flex; flex-direction: column; gap: 14px; font-size: 0.8125rem; line-height: 1.6; color: rgb(66, 68, 84);">
                  <div style="display: flex; gap: 0.625rem;">
                    <span style="width: 22px; height: 22px; background: rgb(43, 45, 63); color: white; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 0.6875rem; font-weight: 600; flex-shrink: 0;">1</span>
                    <span>To speak to <strong style="text-decoration: underline;">Test</strong>, press 1.</span>
                  </div>
                  <div style="display: flex; gap: 0.625rem;">
                    <span style="width: 22px; height: 22px; background: rgb(43, 45, 63); color: white; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 0.6875rem; font-weight: 600; flex-shrink: 0;">2</span>
                    <span>To speak to <strong style="text-decoration: underline;">AAAATest</strong>, press 2.</span>
                  </div>
                  <div style="display: flex; gap: 0.625rem;">
                    <span style="width: 22px; height: 22px; background: rgb(43, 45, 63); color: white; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 0.6875rem; font-weight: 600; flex-shrink: 0;">3</span>
                    <span>To speak to <strong style="text-decoration: underline;">Main Business Number</strong>, press 3.</span>
                  </div>
                  <div style="display: flex; gap: 0.625rem;">
                    <span style="width: 22px; height: 22px; background: rgb(43, 45, 63); color: white; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 0.6875rem; font-weight: 600; flex-shrink: 0;">4</span>
                    <span>To leave a voicemail, press 4.</span>
                  </div>
                  <div style="display: flex; gap: 0.625rem;">
                    <span style="width: 22px; height: 22px; background: rgb(43, 45, 63); color: white; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 0.6875rem; font-weight: 600; flex-shrink: 0;">5</span>
                    <span>To repeat the menu, press 5.</span>
                  </div>
                  <div style="display: flex; gap: 0.625rem;">
                    <span style="width: 22px; height: 22px; background: rgb(43, 45, 63); color: white; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 0.6875rem; font-weight: 600; flex-shrink: 0;">6</span>
                    <span>To dial by name, press 6.</span>
                  </div>
                  <div style="display: flex; gap: 0.625rem;">
                    <span style="width: 22px; height: 22px; background: rgb(43, 45, 63); color: white; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 0.6875rem; font-weight: 600; flex-shrink: 0;">7</span>
                    <span>To dial by Extension, press 7.</span>
                  </div>
                  <div style="display: flex; gap: 0.625rem;">
                    <span style="width: 22px; height: 22px; background: rgb(43, 45, 63); color: white; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 0.6875rem; font-weight: 600; flex-shrink: 0;">8</span>
                    <span>To end the call, press 9 or hang up.</span>
                  </div>
                  <div style="display: flex; gap: 0.625rem;">
                    <span style="width: 22px; height: 22px; background: rgb(43, 45, 63); color: white; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 0.6875rem; font-weight: 600; flex-shrink: 0;">9</span>
                    <span>To speak to <strong style="text-decoration: underline;">Unused HuntGroup_3</strong>, press 0.</span>
                  </div>
                  <div style="display: flex; gap: 0.625rem;">
                    <span style="width: 22px; height: 22px; background: rgb(43, 45, 63); color: white; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 0.6875rem; font-weight: 600; flex-shrink: 0;">★</span>
                    <span>To speak to <strong style="text-decoration: underline;">Unused HuntGroup_newtest</strong>, press *.</span>
                  </div>
                </div>

                <button style="background: none; border: none; color: rgb(13, 98, 255); font-size: 0.8125rem; font-weight: 600; cursor: pointer; padding: 0; margin-top: 20px; display: flex; align-items: center; gap: 0.375rem;" onmouseover="this.style.opacity='0.7'" onmouseout="this.style.opacity='1'">
                  <i data-lucide="copy" style="width: 16px; height: 16px;"></i>
                  Copy script to the text area
                </button>
              </div>
            </div>

            <!-- Right Column: Greeting Configuration -->
            <div>
              <!-- Current Greeting Section -->
              <div style="margin-bottom: 2rem;">
                <div style="display: flex; align-items: center; gap: 0.5rem; margin-bottom: 1rem;">
                  <div style="width: 10px; height: 10px; background: rgb(234, 179, 8); border-radius: 50%;"></div>
                  <h3 style="font-size: 0.875rem; font-weight: 600; color: rgb(43, 45, 63); text-transform: uppercase; letter-spacing: 0.5px; margin: 0;">CURRENT GREETING</h3>
                </div>
                
                <div style="background: white; border: 1px solid rgb(241, 242, 246); border-radius: 0.5rem; padding: 1.5rem;">
                  <div style="display: flex; align-items: center; gap: 0.75rem; margin-bottom: 0.75rem;">
                    <i data-lucide="volume-2" style="width: 20px; height: 20px; color: rgb(112, 113, 125);"></i>
                    <span style="font-size: 0.9375rem; font-weight: 600; color: rgb(43, 45, 63);">Default Greeting</span>
                    <button style="background: none; border: none; cursor: pointer; padding: 0.25rem;">
                      <i data-lucide="info" style="width: 16px; height: 16px; color: rgb(112, 113, 125);"></i>
                    </button>
                  </div>
                  <p style="font-size: 0.8125rem; color: rgb(89, 90, 105); line-height: 1.6; margin: 0;">
                    "Welcome, your call has been answered by an Automated Attendant. If you know your party's extension, press 1. To use our automatic main directory, press 2. If you'd like to 
                    <a href="#" style="color: rgb(13, 98, 255); text-decoration: none; font-weight: 500;">View all ↓</a>
                  </p>
                </div>
              </div>

              <!-- New Greeting Section -->
              <div>
                <h3 style="font-size: 0.875rem; font-weight: 600; color: rgb(43, 45, 63); text-transform: uppercase; letter-spacing: 0.5px; margin-bottom: 1rem;">NEW GREETING</h3>
                
                <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 1rem; margin-bottom: 1.5rem;">
                  <!-- Text-to-Speech -->
                  <div style="background: white; border: 2px solid rgb(241, 242, 246); border-radius: 0.75rem; padding: 2rem 24px; cursor: pointer; transition: all 0.2s; display: flex; flex-direction: column; align-items: center; text-align: center;" onmouseover="this.style.borderColor='rgb(13, 98, 255)'; this.style.background='rgb(245, 248, 255)'" onmouseout="this.style.borderColor='rgb(241, 242, 246)'; this.style.background='white'">
                    <i data-lucide="type" style="width: 32px; height: 32px; color: rgb(13, 98, 255); margin-bottom: 0.75rem;"></i>
                    <div style="font-size: 0.875rem; font-weight: 600; color: rgb(43, 45, 63); margin-bottom: 0.25rem;">TEXT-TO-SPEECH</div>
                    <div style="font-size: 0.6875rem; color: rgb(157, 158, 167); margin-top: 0.5rem;">Maximum characters: 3500</div>
                  </div>

                  <!-- Record -->
                  <div style="background: white; border: 2px solid rgb(241, 242, 246); border-radius: 0.75rem; padding: 2rem 24px; cursor: pointer; transition: all 0.2s; display: flex; flex-direction: column; align-items: center; text-align: center;" onmouseover="this.style.borderColor='rgb(13, 98, 255)'; this.style.background='rgb(245, 248, 255)'" onmouseout="this.style.borderColor='rgb(241, 242, 246)'; this.style.background='white'">
                    <i data-lucide="mic" style="width: 32px; height: 32px; color: rgb(13, 98, 255); margin-bottom: 0.75rem;"></i>
                    <div style="font-size: 0.875rem; font-weight: 600; color: rgb(43, 45, 63); margin-bottom: 0.25rem;">RECORD</div>
                    <div style="font-size: 0.6875rem; color: rgb(157, 158, 167); margin-top: 0.5rem;">Maximum duration: 4 minutes</div>
                  </div>

                  <!-- Upload -->
                  <div style="background: white; border: 2px solid rgb(241, 242, 246); border-radius: 0.75rem; padding: 2rem 24px; cursor: pointer; transition: all 0.2s; display: flex; flex-direction: column; align-items: center; text-align: center;" onmouseover="this.style.borderColor='rgb(13, 98, 255)'; this.style.background='rgb(245, 248, 255)'" onmouseout="this.style.borderColor='rgb(241, 242, 246)'; this.style.background='white'">
                    <i data-lucide="upload" style="width: 32px; height: 32px; color: rgb(13, 98, 255); margin-bottom: 0.75rem;"></i>
                    <div style="font-size: 0.875rem; font-weight: 600; color: rgb(43, 45, 63); margin-bottom: 0.25rem;">UPLOAD</div>
                    <div style="font-size: 0.6875rem; color: rgb(157, 158, 167); margin-top: 0.5rem;">File formats: mp3, WAV<br>Maximum file size: 8 MB</div>
                  </div>
                </div>

                <!-- Terms Notice -->
                <p style="font-size: 0.75rem; color: rgb(112, 113, 125); line-height: 1.5; margin-bottom: 1.5rem;">
                  You acknowledge and agree that any content that you upload to My Account is governed by the Terms and Conditions <a href="#" style="color: rgb(13, 98, 255); text-decoration: none;">including the Acceptable Use Policy</a>.
                </p>

                <!-- Additional Recording Option -->
                <div>
                  <h3 style="font-size: 0.875rem; font-weight: 600; color: rgb(43, 45, 63); text-transform: uppercase; letter-spacing: 0.5px; margin-bottom: 0.75rem;">ADDITIONAL RECORDING OPTION</h3>
                  <select style="width: 100%; padding: 0.75rem 16px; border: 1px solid rgb(221, 221, 226); border-radius: 0.375rem; font-size: 0.875rem; color: rgb(89, 90, 105); background: white; cursor: pointer;">
                    <option>Record using Voice Portal Number</option>
                  </select>
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- Bottom Actions - Fixed -->
        <div class="wizard-bottom-actions" style="position: fixed; bottom: 0; left: 340px; right: 0; background: white; padding: 1.25rem 24px; border-top: 1px solid rgb(241, 242, 246); display: flex; justify-content: space-between; align-items: center; z-index: 50; box-shadow: 0 -2px 8px rgba(0,0,0,0.08); transition: left 0.3s ease;">
          <button onclick="backFromGreeting()" style="display: inline-flex; align-items: center; gap: 0.5rem; background: none; border: none; color: rgb(13, 98, 255); font-size: 0.8125rem; font-weight: 600; text-transform: uppercase; letter-spacing: 0.5px; cursor: pointer; padding: 0;" onmouseover="this.style.opacity='0.8'" onmouseout="this.style.opacity='1'">
            <i data-lucide="chevron-left" style="width: 18px; height: 18px;"></i>
            <span>BACK</span>
          </button>
          <button onclick="saveGreetingAndComplete()" style="background: rgb(13, 98, 255); color: white; border: none; padding: 0.75rem 32px; border-radius: 0.375rem; font-weight: 600; font-size: 0.875rem; cursor: pointer; transition: all 0.2s;" onmouseover="this.style.background='rgb(8, 59, 153)'" onmouseout="this.style.background='rgb(13, 98, 255)'">
            SAVE & NEXT
          </button>
        </div>
        
        <!-- Spacer for fixed bottom bar -->
        <div style="height: 5rem;"></div>
      </div>

      <!-- Setup: Google Virtual Assistant Configuration -->
      <div id="setup-google-ai" style="display: none;">
        <!-- Wizard Header -->
        <div style="background: white; padding: 1.5rem 24px 20px 24px; margin: -24px -24px 24px -24px; box-shadow: 0 1px 3px rgba(0,0,0,0.1);">
          <div style="display: flex; align-items: center; justify-content: space-between; margin-bottom: 1.5rem;">
            <h1 style="font-size: 1.25rem; font-weight: 600; color: rgb(43, 45, 63); margin: 0;">Call Flow Setup</h1>
            <button onclick="saveAndExit()" style="background: none; border: 1px solid rgb(221, 221, 226); color: rgb(13, 98, 255); padding: 0.5rem 20px; border-radius: 0.25rem; font-size: 0.8125rem; font-weight: 600; text-transform: uppercase; letter-spacing: 0.5px; cursor: pointer; transition: all 0.15s;" onmouseover="this.style.background='rgb(252, 252, 252)'" onmouseout="this.style.background='none'">
              SAVE & EXIT
            </button>
          </div>

          <!-- Wizard Steps -->
          <div style="display: flex; align-items: center; gap: 0; position: relative;">
            <!-- Step 1 - Completed (Clickable) -->
            <div onclick="navigateToStep('setup-holidays')" style="flex: 1; display: flex; align-items: center; gap: 0.5rem; position: relative; cursor: pointer; transition: opacity 0.15s;" onmouseover="this.style.opacity='0.7'" onmouseout="this.style.opacity='1'" title="Go back to Schedules">
              <div style="width: 32px; height: 32px; border-radius: 50%; background: rgb(34, 197, 94); color: white; display: flex; align-items: center; justify-content: center; font-size: 0.875rem; font-weight: 600; z-index: 2; position: relative;">
                <i data-lucide="check" style="width: 18px; height: 18px;"></i>
              </div>
              <span style="font-size: 0.875rem; font-weight: 500; color: rgb(89, 90, 105); position: relative; z-index: 2; background: white; padding-left: 0.5rem; padding-right: 0.5rem;">Schedules</span>
              <div style="position: absolute; left: 16px; top: 15px; height: 2px; background: rgb(34, 197, 94); width: 100%; z-index: 0;"></div>
            </div>

            <!-- Step 2 - Completed (Clickable) -->
            <div onclick="navigateToStep('setup-routing')" style="flex: 1; display: flex; align-items: center; gap: 0.5rem; position: relative; cursor: pointer; transition: opacity 0.15s;" onmouseover="this.style.opacity='0.7'" onmouseout="this.style.opacity='1'" title="Go back to Open Hours">
              <div style="width: 32px; height: 32px; border-radius: 50%; background: rgb(34, 197, 94); color: white; display: flex; align-items: center; justify-content: center; font-size: 0.875rem; font-weight: 600; z-index: 2; position: relative;">
                <i data-lucide="check" style="width: 18px; height: 18px;"></i>
              </div>
              <span style="font-size: 0.875rem; font-weight: 500; color: rgb(89, 90, 105); position: relative; z-index: 2; background: white; padding-left: 0.5rem; padding-right: 0.5rem;">Open Hours</span>
              <div style="position: absolute; left: 16px; top: 15px; height: 2px; background: rgb(34, 197, 94); width: 100%; z-index: 0;"></div>
            </div>

            <!-- Step 3 - Completed (Clickable) -->
            <div onclick="navigateToStep('setup-routing-closed')" style="flex: 1; display: flex; align-items: center; gap: 0.5rem; position: relative; cursor: pointer; transition: opacity 0.15s;" onmouseover="this.style.opacity='0.7'" onmouseout="this.style.opacity='1'" title="Go back to Closed Hours">
              <div style="width: 32px; height: 32px; border-radius: 50%; background: rgb(34, 197, 94); color: white; display: flex; align-items: center; justify-content: center; font-size: 0.875rem; font-weight: 600; z-index: 2; position: relative;">
                <i data-lucide="check" style="width: 18px; height: 18px;"></i>
              </div>
              <span style="font-size: 0.875rem; font-weight: 500; color: rgb(89, 90, 105); position: relative; z-index: 2; background: white; padding-left: 0.5rem; padding-right: 0.5rem;">Closed Hours</span>
              <div style="position: absolute; left: 16px; top: 15px; height: 2px; background: rgb(34, 197, 94); width: 100%; z-index: 0;"></div>
            </div>

            <!-- Step 4 - Completed (Clickable) -->
            <div onclick="navigateToStep('setup-cfnr')" style="flex: 1; display: flex; align-items: center; gap: 0.5rem; position: relative; cursor: pointer; transition: opacity 0.15s;" onmouseover="this.style.opacity='0.7'" onmouseout="this.style.opacity='1'" title="Go back to Failover">
              <div style="width: 32px; height: 32px; border-radius: 50%; background: rgb(34, 197, 94); color: white; display: flex; align-items: center; justify-content: center; font-size: 0.875rem; font-weight: 600; z-index: 2; position: relative;">
                <i data-lucide="check" style="width: 18px; height: 18px;"></i>
              </div>
              <span style="font-size: 0.875rem; font-weight: 500; color: rgb(89, 90, 105); position: relative; z-index: 2; background: white; padding-left: 0.5rem; padding-right: 0.5rem;">Failover</span>
              <div style="position: absolute; left: 16px; top: 15px; height: 2px; background: rgb(34, 197, 94); width: 100%; z-index: 0;"></div>
            </div>

            <!-- Step 5 - Active -->
            <div style="flex: 1; display: flex; align-items: center; gap: 0.5rem; position: relative;">
              <div style="width: 32px; height: 32px; border-radius: 50%; background: rgb(13, 98, 255); color: white; display: flex; align-items: center; justify-content: center; font-size: 0.875rem; font-weight: 600; z-index: 2; position: relative;">5</div>
              <span style="font-size: 0.875rem; font-weight: 600; color: rgb(13, 98, 255); position: relative; z-index: 2; background: white; padding-left: 0.5rem; padding-right: 0.5rem;">Virtual Assistant</span>
            </div>
          </div>
        </div>

        <!-- Content -->
        <div style="max-width: 900px; margin: 0 auto;">
          <!-- Success Banner -->
          <div style="background: linear-gradient(135deg, rgb(220, 252, 231) 0%, rgb(187, 247, 208) 100%); border: 2px solid rgb(134, 239, 172); border-radius: 0.75rem; padding: 2rem; margin-bottom: 2.5rem; text-align: center;">
            <div style="width: 64px; height: 64px; background: white; border-radius: 50%; display: flex; align-items: center; justify-content: center; margin: 0 auto 1rem; box-shadow: 0 4px 16px rgba(34,197,94,0.2);">
              <i data-lucide="check-circle" style="width: 36px; height: 36px; color: rgb(22, 163, 74);"></i>
            </div>
            <h2 style="font-size: 1.5rem; font-weight: 600; color: rgb(22, 101, 52); margin-bottom: 0.5rem;">Call Flow Configuration Complete!</h2>
            <p style="font-size: 0.875rem; color: rgb(21, 128, 61); margin: 0;">Your call flow has been saved and is ready to handle incoming calls.</p>
          </div>

          <!-- Hunt Group Naming Info -->
          <div style="background: rgb(245, 248, 255); border: 1px solid rgb(186, 230, 253); border-radius: 0.75rem; padding: 1.5rem 2rem; margin-bottom: 2rem;">
            <div style="display: flex; align-items: start; gap: 1.25rem;">
              <div style="width: 44px; height: 44px; background: white; border-radius: 0.75rem; display: flex; align-items: center; justify-content: center; flex-shrink: 0; border: 1px solid rgb(186, 230, 253);">
                <i data-lucide="info" style="width: 24px; height: 24px; color: rgb(13, 98, 255);"></i>
              </div>
              <div style="flex: 1;">
                <h3 style="font-size: 1rem; font-weight: 600; color: rgb(43, 45, 63); margin-bottom: 0.5rem;">Review Your Hunt Group Names</h3>
                <p style="font-size: 0.875rem; color: rgb(89, 90, 105); line-height: 1.6; margin-bottom: 1rem;">Before configuring Google Virtual Assistant, make sure your hunt groups have clear, descriptive names (like "Sales", "Support", "Billing") instead of generic names (like "Hunt Group 1", "Hunt Group 2"). This helps the AI route calls accurately to the right teams.</p>
                <div style="display: flex; gap: 1rem; flex-wrap: wrap;">
                  <button onclick="alert('Navigate to hunt groups configuration')" style="display: inline-flex; align-items: center; gap: 0.5rem; padding: 0.625rem 1.25rem; background: white; color: rgb(13, 98, 255); border: 2px solid rgb(13, 98, 255); border-radius: 0.375rem; font-size: 0.8125rem; font-weight: 600; cursor: pointer; transition: all 0.2s;" onmouseover="this.style.background='rgb(13, 98, 255)'; this.style.color='white'" onmouseout="this.style.background='white'; this.style.color='rgb(13, 98, 255)'">
                    <i data-lucide="users" style="width: 16px; height: 16px;"></i>
                    <span>Review Hunt Groups</span>
                  </button>
                  <span style="font-size: 0.75rem; color: rgb(112, 113, 125); align-self: center;">Recommended before continuing</span>
                </div>
              </div>
            </div>
          </div>

          <!-- Google Virtual Assistant Configuration Card -->
          <div style="background: linear-gradient(135deg, rgb(224, 242, 254) 0%, rgb(245, 248, 255) 100%); border: 2px solid rgb(125, 211, 252); border-radius: 0.75rem; padding: 2rem; margin-bottom: 2rem;">
            <div style="display: flex; align-items: start; gap: 1.5rem;">
              <div style="width: 64px; height: 64px; background: white; border-radius: 0.75rem; display: flex; align-items: center; justify-content: center; flex-shrink: 0; box-shadow: 0 4px 12px rgba(13,98,255,0.15);">
                <i data-lucide="bot" style="width: 36px; height: 36px; color: rgb(13, 98, 255);"></i>
              </div>
              <div style="flex: 1;">
                <h2 style="font-size: 1.25rem; font-weight: 600; color: rgb(43, 45, 63); margin-bottom: 0.75rem;">Configure Google Virtual Assistant</h2>
                <p style="font-size: 0.875rem; color: rgb(89, 90, 105); line-height: 1.6; margin-bottom: 1rem;">Your call flow is configured and ready. To enable AI-powered call handling, complete the Google Assistant configuration.</p>
                
                <div style="background: white; border-radius: 0.5rem; padding: 1rem; margin-bottom: 1.25rem;">
                  <ul style="list-style: none; padding: 0; margin: 0; display: flex; flex-direction: column; gap: 0.75rem;">
                    <li style="display: flex; align-items: start; gap: 0.75rem;">
                      <i data-lucide="check" style="width: 18px; height: 18px; color: rgb(34, 197, 94); flex-shrink: 0; margin-top: 0.125rem;"></i>
                      <span style="font-size: 0.8125rem; color: rgb(89, 90, 105);">All calls will route to the call flow you just built until you configure the assistant and turn it on.</span>
                    </li>
                    <li style="display: flex; align-items: start; gap: 0.75rem;">
                      <i data-lucide="check" style="width: 18px; height: 18px; color: rgb(34, 197, 94); flex-shrink: 0; margin-top: 0.125rem;"></i>
                      <span style="font-size: 0.8125rem; color: rgb(89, 90, 105);">You can turn off the assistant at any time to route calls back to your configured call flow.</span>
                    </li>
                    <li style="display: flex; align-items: start; gap: 0.75rem;">
                      <i data-lucide="check" style="width: 18px; height: 18px; color: rgb(34, 197, 94); flex-shrink: 0; margin-top: 0.125rem;"></i>
                      <span style="font-size: 0.8125rem; color: rgb(89, 90, 105);">Your configured schedules apply to both the call flow and Google Virtual Assistant routing.</span>
                    </li>
                  </ul>
                </div>

                <button onclick="launchGoogleAIConfig()" style="background: rgb(13, 98, 255); color: white; border: none; padding: 0.875rem 32px; border-radius: 0.375rem; font-weight: 600; font-size: 0.875rem; cursor: pointer; transition: all 0.2s; display: inline-flex; align-items: center; gap: 0.625rem; box-shadow: 0 4px 12px rgba(13,98,255,0.3);" onmouseover="this.style.background='rgb(8, 59, 153)'; this.style.transform='translateY(-2px)'; this.style.boxShadow='0 6px 20px rgba(13,98,255,0.4)'" onmouseout="this.style.background='rgb(13, 98, 255)'; this.style.transform='translateY(0)'; this.style.boxShadow='0 4px 12px rgba(13,98,255,0.3)'">
                  <i data-lucide="external-link" style="width: 18px; height: 18px;"></i>
                  <span>CONFIGURE GOOGLE ASSISTANT</span>
                </button>
                
                <button onclick="completeWizardFromGoogleAI()" style="background: none; border: none; color: rgb(112, 113, 125); font-size: 0.8125rem; font-weight: 600; cursor: pointer; padding: 0.5rem; margin-left: 1rem; transition: color 0.2s;" onmouseover="this.style.color='rgb(43, 45, 63)'" onmouseout="this.style.color='rgb(112, 113, 125)'">
                  I'll configure this later
                </button>
              </div>
            </div>
          </div>

          <!-- Info Section -->
          <div style="background: rgb(252, 252, 252); border: 1px solid rgb(241, 242, 246); border-radius: 0.5rem; padding: 1.25rem;">
            <div style="display: flex; align-items: start; gap: 0.75rem;">
              <i data-lucide="info" style="width: 20px; height: 20px; color: rgb(13, 98, 255); flex-shrink: 0; margin-top: 0.125rem;"></i>
              <div>
                <p style="font-size: 0.875rem; color: rgb(89, 90, 105); line-height: 1.6; margin: 0;">
                  <strong style="color: rgb(43, 45, 63);">Note:</strong> The routing selections you configured (Open Hours and Closed Hours) are only for your backup/default call flow. They will be used when the AI Assistant is disabled or when AI minutes are depleted.
                </p>
              </div>
            </div>
          </div>
        </div>

        <!-- Bottom Actions - Fixed -->
        <div class="wizard-bottom-actions" style="position: fixed; bottom: 0; left: 340px; right: 0; background: white; padding: 1.25rem 24px; border-top: 1px solid rgb(241, 242, 246); display: flex; justify-content: space-between; align-items: center; z-index: 50; box-shadow: 0 -2px 8px rgba(0,0,0,0.08); transition: left 0.3s ease;">
          <button onclick="backToGoogleAIFromCFNR()" style="display: inline-flex; align-items: center; gap: 0.5rem; background: none; border: none; color: rgb(13, 98, 255); font-size: 0.8125rem; font-weight: 600; text-transform: uppercase; letter-spacing: 0.5px; cursor: pointer; padding: 0;" onmouseover="this.style.opacity='0.8'" onmouseout="this.style.opacity='1'">
            <i data-lucide="chevron-left" style="width: 18px; height: 18px;"></i>
            <span>BACK</span>
          </button>
          <button onclick="completeWizardFromGoogleAI()" class="action-button-primary" style="font-size: 0.8125rem; padding: 0.75rem 32px;">
            FINISH
          </button>
        </div>
        
        <!-- Spacer for fixed bottom bar -->
        <div style="height: 5rem;"></div>
      </div>

      <!-- AI Settings moved outside #page-attendants - see after page-attendants closes -->
      <!-- Main Call Flow Content (Hidden initially) -->
      <div id="main-callflow-content" style="display: none; position: relative;">
        <!-- Demo buttons moved to global demo bar -->
        
        <div class="page-header">
          <div>
            <div class="page-title">MAIN BUSINESS NUMBER</div>
            <div style="display: flex; align-items: center; gap: 0.75rem; margin: 0.75rem 0 0.5rem 0;">
              <span style="font-size: 1.125rem; font-weight: 600; color: rgb(43, 45, 63);">(445) 223-3000</span>
            </div>
            <p style="color: rgb(112, 113, 125); font-size: 0.875rem; margin: 0; line-height: 1.5;">Set up how calls to your main business number are handled</p>
          </div>
          <button onclick="startCallFlowSetup()" style="display: inline-flex; align-items: center; gap: 0.5rem; padding: 0.75rem 20px; background: white; color: rgb(13, 98, 255); border: 2px solid rgb(13, 98, 255); border-radius: 0.5rem; font-size: 0.875rem; font-weight: 600; cursor: pointer; transition: all 0.2s;" onmouseover="this.style.background='rgb(13, 98, 255)'; this.style.color='white';" onmouseout="this.style.background='white'; this.style.color='rgb(13, 98, 255)';">
            <i data-lucide="settings" style="width: 18px; height: 18px;"></i>
            <span>Edit Call Flow</span>
          </button>
        </div>

        <!-- Active Call Flow Status Bar -->
        <div style="background: linear-gradient(135deg, rgb(34, 197, 94) 0%, rgb(22, 163, 74) 100%); border-radius: 0.75rem; padding: 1.25rem 1.75rem; margin-bottom: 2rem; color: white; box-shadow: 0 4px 12px rgba(16, 185, 129, 0.2); display: none;">
          <div style="display: flex; align-items: center; justify-content: space-between;">
            <!-- Status Info -->
            <div style="display: flex; align-items: center; gap: 2rem;">
              <div style="display: flex; align-items: center; gap: 0.75rem;">
                <div style="width: 8px; height: 8px; background: white; border-radius: 50%; box-shadow: 0 0 8px rgba(255,255,255,0.8);"></div>
                <div>
                  <div style="font-size: 0.6875rem; font-weight: 600; text-transform: uppercase; letter-spacing: 0.5px; opacity: 0.85; margin-bottom: 0.25rem;">Active Call Flow</div>
                  <div style="font-size: 1rem; font-weight: 600;">Open Hours • 9:00 AM - 5:00 PM</div>
                </div>
              </div>
              <div style="border-left: 1px solid rgba(255,255,255,0.3); padding-left: 2rem; height: 40px; display: flex; align-items: center;">
                <div>
                  <div style="font-size: 0.6875rem; opacity: 0.85; margin-bottom: 0.25rem;">Next Change</div>
                  <div style="font-size: 0.9375rem; font-weight: 600;">Closes at 5:00 PM</div>
                </div>
              </div>
            </div>

            <!-- Compact Flow Diagram -->
            <div style="display: flex; align-items: center; gap: 0.75rem; padding: 0.75rem 1.25rem; background: rgba(255,255,255,0.15); border-radius: 0.5rem; backdrop-filter: blur(10px);">
              <div style="display: flex; align-items: center; gap: 0.5rem;">
                <i data-lucide="phone-incoming" style="width: 20px; height: 20px;"></i>
                <span style="font-size: 0.8125rem; font-weight: 500;">Call</span>
              </div>
              <i data-lucide="arrow-right" style="width: 16px; height: 16px; opacity: 0.6;"></i>
              <div style="display: flex; align-items: center; gap: 0.5rem; padding: 0.375rem 0.75rem; background: rgba(255,255,255,0.25); border-radius: 0.375rem;">
                <i data-lucide="bot" style="width: 20px; height: 20px;"></i>
                <span style="font-size: 0.8125rem; font-weight: 600;">Google Virtual Assistant</span>
              </div>
              <i data-lucide="arrow-right" style="width: 16px; height: 16px; opacity: 0.4;"></i>
              <div style="display: flex; align-items: center; gap: 0.5rem; opacity: 0.6;">
                <i data-lucide="grid-3x3" style="width: 18px; height: 18px;"></i>
                <span style="font-size: 0.75rem; font-weight: 500;">Keypad menu</span>
              </div>
              <i data-lucide="arrow-right" style="width: 16px; height: 16px; opacity: 0.6;"></i>
              <i data-lucide="check-circle" style="width: 20px; height: 20px;"></i>
            </div>
          </div>
        </div>

        <!-- Google Virtual Assistant Primary Section -->
        <div id="callflow-ai-primary" style="background: white; border: 1px solid rgb(241, 242, 246); border-radius: 0.75rem; padding: 2rem 32px; margin-bottom: 2rem;">
          <!-- Header with Toggle -->
          <div style="display: flex; align-items: center; justify-content: space-between; margin-bottom: 1.5rem; padding-bottom: 1.5rem; border-bottom: 2px solid rgb(241, 242, 246);">
            <div style="display: flex; align-items: center; gap: 1rem;">
              <div style="width: 56px; height: 56px; background: linear-gradient(135deg, rgb(224, 242, 254) 0%, rgb(186, 230, 253) 100%); border-radius: 12px; display: flex; align-items: center; justify-content: center;">
                <i data-lucide="bot" style="width: 28px; height: 28px; color: rgb(13, 98, 255);"></i>
              </div>
              <div>
                <h2 style="font-size: 1.25rem; font-weight: 600; color: rgb(43, 45, 63); margin: 0 0 0.375rem 0;">Google Virtual Assistant</h2>
                <div id="ai-status-badge" style="display: flex; align-items: center; gap: 0.5rem;">
                  <div style="width: 8px; height: 8px; background: rgb(34, 197, 94); border-radius: 50%; box-shadow: 0 0 0 2px rgba(34, 197, 94, 0.2);"></div>
                  <span style="font-size: 0.875rem; font-weight: 500; color: rgb(34, 197, 94);">Active</span>
                  <span style="font-size: 0.875rem; color: rgb(112, 113, 125);">• AI handling all incoming calls</span>
                </div>
              </div>
            </div>
            <div style="display: flex; align-items: center; gap: 1rem;">
              <div style="text-align: right; margin-right: 1rem;">
                <div style="font-size: 0.75rem; font-weight: 600; color: rgb(112, 113, 125); text-transform: uppercase; letter-spacing: 0.5px; margin-bottom: 0.25rem;">AI Assistant</div>
                <div style="font-size: 0.875rem; font-weight: 600; color: rgb(43, 45, 63);" id="ai-toggle-label">Enabled</div>
              </div>
              <label class="toggle-switch" style="transform: scale(1.2);">
                <input type="checkbox" id="ai-primary-toggle" checked onchange="handleAIPrimaryToggle()">
                <span class="toggle-slider"></span>
              </label>
              <button onclick="openAISettings()" style="display: inline-flex; align-items: center; gap: 0.5rem; padding: 0.5rem 14px; background: white; border: 2px solid rgb(221, 221, 226); border-radius: 0.5rem; font-size: 0.8125rem; font-weight: 600; color: rgb(112, 113, 125); cursor: pointer; transition: all 0.2s; margin-left: 0.5rem;" onmouseover="this.style.background='rgb(249, 250, 251)'; this.style.borderColor='rgb(13, 98, 255)'; this.style.color='rgb(13, 98, 255)';" onmouseout="this.style.background='white'; this.style.borderColor='rgb(221, 221, 226)'; this.style.color='rgb(112, 113, 125)';">
                <i data-lucide="settings" style="width: 16px; height: 16px;"></i>
                <span>Settings</span>
              </button>
            </div>
          </div>

          <!-- Usage Metrics -->
          <div id="ai-usage-metrics" style="margin-bottom: 1.5rem;">
            <div style="display: flex; align-items: center; justify-content: space-between; margin-bottom: 1rem;">
              <div style="display: flex; align-items: baseline; gap: 0.75rem;">
                <span id="ai-minutes-used" style="font-size: 2.25rem; font-weight: 600; color: rgb(43, 45, 63);">247</span>
                <span style="font-size: 1rem; color: rgb(112, 113, 125);">/ <span id="ai-minutes-total">500</span> minutes used</span>
              </div>
              <div style="text-align: right;">
                <div style="font-size: 0.875rem; font-weight: 600; color: rgb(34, 197, 94);"><span id="ai-minutes-remaining">253</span> minutes remaining</div>
                <div style="font-size: 0.75rem; color: rgb(112, 113, 125); margin-top: 0.25rem;">Billing: <span id="ai-billing-cycle">Jan 1 - Jan 31, 2026</span></div>
              </div>
            </div>
            
            <!-- Progress Bar -->
            <div style="width: 100%; height: 12px; background: rgb(241, 242, 246); border-radius: 6px; overflow: hidden; margin-bottom: 0.75rem;">
              <div id="ai-progress-bar" style="width: 49.4%; height: 100%; background: linear-gradient(90deg, rgb(13, 98, 255) 0%, rgb(59, 130, 246) 100%); border-radius: 6px; transition: width 0.3s;"></div>
            </div>
            
            <div style="display: flex; align-items: center; justify-content: space-between; font-size: 0.75rem; color: rgb(112, 113, 125);">
              <div style="display: flex; align-items: center; gap: 0.375rem;">
                <i data-lucide="clock" style="width: 12px; height: 12px;"></i>
                <span>Updated: <span id="ai-last-updated">2:30 PM ET</span></span>
              </div>
              <div id="ai-status-text" style="font-weight: 500;">49.4% used</div>
            </div>
          </div>

          <!-- Alert Banner (shown when AI is off or minutes depleted) -->
          <div id="ai-alert-banner" style="display: none; background: linear-gradient(135deg, rgb(254, 243, 199) 0%, rgb(253, 224, 71) 100%); border: 2px solid rgb(251, 191, 36); border-radius: 0.5rem; padding: 1rem 1.25rem; margin-bottom: 1.5rem;">
            <div style="display: flex; align-items: start; gap: 0.75rem;">
              <i data-lucide="alert-triangle" style="width: 20px; height: 20px; color: rgb(180, 83, 9); flex-shrink: 0; margin-top: 0.125rem;"></i>
              <div style="flex: 1;">
                <div style="font-size: 0.875rem; font-weight: 600; color: rgb(120, 53, 15); margin-bottom: 0.25rem;">Calls routing to backup call flow</div>
                <div style="font-size: 0.8125rem; color: rgb(146, 64, 14); line-height: 1.5;">Your Google Virtual Assistant is currently disabled. All incoming calls are being handled by your configured backup call flow.</div>
              </div>
          </div>
        </div>

          <!-- Configuration Overview (nested within AI context) -->
          <div style="background: white; border: 1px solid rgb(221, 221, 226); border-radius: 0.5rem; padding: 1.25rem; margin-bottom: 1.5rem;">
            <div style="display: flex; align-items: center; gap: 0.625rem; margin-bottom: 1rem; padding-bottom: 0.75rem; border-bottom: 1px solid rgb(241, 242, 246);">
              <i data-lucide="info" style="width: 16px; height: 16px; color: rgb(112, 113, 125);"></i>
              <h4 style="font-size: 0.8125rem; font-weight: 600; color: rgb(112, 113, 125); margin: 0; text-transform: uppercase; letter-spacing: 0.5px;">Configuration</h4>
            </div>
            
            <!-- Business Hours (as a configuration detail) -->
            <div style="display: flex; align-items: start; gap: 1rem; margin-bottom: 1rem;">
              <i data-lucide="clock" style="width: 20px; height: 20px; color: rgb(13, 98, 255); flex-shrink: 0; margin-top: 0.125rem;"></i>
              <div style="flex: 1;">
                <div style="font-size: 0.8125rem; font-weight: 600; color: rgb(43, 45, 63); margin-bottom: 0.5rem;">Active Hours</div>
                <div style="display: grid; gap: 0.5rem;">
                  <div style="display: flex; align-items: center; gap: 0.5rem; font-size: 0.8125rem;">
                    <span style="color: rgb(89, 90, 105);">Open:</span>
                    <span style="font-weight: 500; color: rgb(43, 45, 63);">Mon-Fri, 9:00 AM - 5:00 PM</span>
                  </div>
                  <div style="display: flex; align-items: center; gap: 0.5rem; font-size: 0.8125rem;">
                    <span style="color: rgb(89, 90, 105);">Closed:</span>
                    <span style="font-weight: 500; color: rgb(43, 45, 63);">Evenings, Weekends & Holidays</span>
                  </div>
                </div>
              </div>
            </div>
            
            <!-- Help text -->
            <div style="display: flex; gap: 0.5rem; padding: 0.75rem; background: rgb(249, 250, 251); border-radius: 0.375rem; border-left: 3px solid rgb(13, 98, 255);">
              <i data-lucide="lightbulb" style="width: 14px; height: 14px; color: rgb(112, 113, 125); flex-shrink: 0; margin-top: 0.125rem;"></i>
              <p style="font-size: 0.75rem; color: rgb(89, 90, 105); margin: 0; line-height: 1.5;">Manage schedules, call routing, and AI preferences in the configuration panel</p>
            </div>
          </div>

          <!-- Actions -->
          <div style="display: flex; gap: 0.75rem; flex-wrap: wrap;">
            <button onclick="openAddMinutesPage()" style="display: inline-flex; align-items: center; gap: 0.5rem; padding: 0.75rem 20px; background: rgb(13, 98, 255); color: white; border: none; border-radius: 0.5rem; font-size: 0.875rem; font-weight: 600; cursor: pointer; transition: all 0.2s; box-shadow: 0 2px 4px rgba(13, 98, 255, 0.2);" onmouseover="this.style.background='rgb(10, 78, 204)'; this.style.transform='translateY(-1px)'; this.style.boxShadow='0 4px 8px rgba(13, 98, 255, 0.3)';" onmouseout="this.style.background='rgb(13, 98, 255)'; this.style.transform='translateY(0)'; this.style.boxShadow='0 2px 4px rgba(13, 98, 255, 0.2)';">
              <i data-lucide="plus-circle" style="width: 18px; height: 18px;"></i>
              <span>Add Minutes</span>
            </button>
            <button onclick="saveCFNRAndNext()" style="display: inline-flex; align-items: center; gap: 0.5rem; padding: 0.75rem 20px; background: white; color: rgb(13, 98, 255); border: 2px solid rgb(13, 98, 255); border-radius: 0.5rem; font-size: 0.875rem; font-weight: 600; cursor: pointer; transition: all 0.2s;" onmouseover="this.style.background='rgb(13, 98, 255)'; this.style.color='white';" onmouseout="this.style.background='white'; this.style.color='rgb(13, 98, 255)';">
              <i data-lucide="sliders" style="width: 18px; height: 18px;"></i>
              <span>Manage Configuration</span>
            </button>
          </div>
        </div>

        <!-- Backup Call Flow Section (Collapsible) -->
        <div id="backup-callflow-section" style="background: white; border: 1px solid rgb(241, 242, 246); border-radius: 0.75rem; margin-bottom: 2rem; overflow: hidden;">
          <!-- Collapsible Header -->
          <div onclick="toggleBackupSection()" style="padding: 1.5rem 32px; cursor: pointer; transition: all 0.2s; display: flex; align-items: center; justify-content: space-between; background: rgb(249, 250, 251);" onmouseover="this.style.background='rgb(245, 248, 255)'" onmouseout="this.style.background='rgb(249, 250, 251)'">
            <div style="flex: 1;">
              <div style="display: flex; align-items: center; gap: 0.75rem; margin-bottom: 0.5rem;">
                <i id="backup-chevron" data-lucide="chevron-right" style="width: 20px; height: 20px; color: rgb(112, 113, 125); transition: transform 0.2s;"></i>
                <h2 style="font-size: 1.125rem; font-weight: 600; color: rgb(43, 45, 63); margin: 0;">Backup Call Flow Configuration</h2>
                <span style="background: rgb(221, 221, 226); color: rgb(66, 68, 84); padding: 0.25rem 0.75rem; border-radius: 1rem; font-size: 0.75rem; font-weight: 600; text-transform: uppercase; letter-spacing: 0.5px;">Failover</span>
              </div>
              <p style="font-size: 0.875rem; color: rgb(112, 113, 125); margin: 0; padding-left: 1.875rem;">Schedules and routing that power your Google Virtual Assistant and serve as backup when VA is unavailable</p>
            </div>
            <div id="backup-status-indicator" style="display: none; padding: 0.5rem 1rem; background: rgb(254, 243, 199); border: 1px solid rgb(251, 191, 36); border-radius: 0.5rem; margin-left: 1rem;">
              <div style="display: flex; align-items: center; gap: 0.5rem;">
                <div style="width: 8px; height: 8px; background: rgb(251, 191, 36); border-radius: 50%;"></div>
                <span style="font-size: 0.75rem; font-weight: 600; color: rgb(146, 64, 14); text-transform: uppercase; letter-spacing: 0.5px;">Currently Active</span>
              </div>
            </div>
          </div>

          <!-- Collapsible Content -->
          <div id="backup-content" style="display: none; padding: 0 32px 2rem 32px;">
            <!-- Info Banner explaining cascade -->
            <div style="background: linear-gradient(135deg, rgb(224, 242, 254) 0%, rgb(209, 241, 255) 100%); border: 2px solid rgb(125, 211, 252); border-radius: 0.5rem; padding: 1rem 1.25rem; margin-top: 2rem; margin-bottom: 2rem;">
              <div style="display: flex; gap: 1rem;">
                <i data-lucide="info" style="width: 20px; height: 20px; color: rgb(13, 98, 255); flex-shrink: 0; margin-top: 0.125rem;"></i>
                <div style="flex: 1;">
                  <div style="font-size: 0.875rem; font-weight: 600; color: rgb(43, 45, 63); margin-bottom: 0.375rem;">Configuration Overview</div>
                  <p style="font-size: 0.8125rem; color: rgb(43, 45, 63); line-height: 1.5; margin: 0;">
                    Your <strong>schedules and routing rules</strong> below are used by Google Virtual Assistant to intelligently handle calls. 
                    <strong>Greetings are backup-only</strong> and play when the AI is unavailable. Changes here affect both your AI assistant and backup call flow.
                  </p>
                </div>
              </div>
            </div>
            <!-- Unified Call Routing Schedule -->
            <div style="margin-bottom: 2rem; padding-top: 2rem; border-top: 1px solid rgb(241, 242, 246);">
          <div style="display: flex; align-items: center; justify-content: space-between; margin-bottom: 1rem;">
            <div style="display: flex; align-items: center; gap: 0.75rem;">
              <h2 style="font-size: 1.125rem; font-weight: 600; color: rgb(43, 45, 63); margin: 0;">Call Routing Schedule</h2>
              <span style="background: linear-gradient(135deg, rgb(224, 242, 254) 0%, rgb(209, 241, 255) 100%); color: rgb(13, 98, 255); padding: 0.25rem 0.625rem; border-radius: 0.25rem; font-size: 0.6875rem; font-weight: 600; text-transform: uppercase; letter-spacing: 0.5px; border: 1px solid rgb(125, 211, 252);">
                <i data-lucide="zap" style="width: 10px; height: 10px; display: inline; margin-right: 0.25rem;"></i>Powers VA
              </span>
            </div>
            <button onclick="jumpToSchedules()" style="display: inline-flex; align-items: center; gap: 0.5rem; padding: 0.5rem 16px; background: white; color: rgb(13, 98, 255); border: 2px solid rgb(13, 98, 255); border-radius: 0.375rem; font-size: 0.8125rem; font-weight: 600; cursor: pointer; transition: all 0.2s;" onmouseover="this.style.background='rgb(13, 98, 255)'; this.style.color='white';" onmouseout="this.style.background='white'; this.style.color='rgb(13, 98, 255)';">
              <i data-lucide="calendar" style="width: 16px; height: 16px;"></i>
              Edit Schedule
            </button>
          </div>
          <p style="font-size: 0.8125rem; color: rgb(112, 113, 125); margin: 0 0 1.5rem 0; line-height: 1.5;">Google Virtual Assistant uses these hours to determine when it's active and how to respond to callers.</p>

          <!-- Schedule Summary -->
          <div style="background: rgb(252, 252, 252); border-radius: 0.5rem; padding: 1.25rem; margin-bottom: 2rem;">
            <div style="display: flex; align-items: center; justify-content: space-between; padding-bottom: 1rem; border-bottom: 1px solid rgb(229, 229, 234); margin-bottom: 1rem;">
              <div style="display: flex; align-items: center; gap: 0.75rem;">
                <i data-lucide="clock" style="width: 18px; height: 18px; color: rgb(13, 98, 255);"></i>
                <div>
                  <div style="font-size: 0.875rem; font-weight: 600; color: rgb(43, 45, 63);">Business Hours</div>
                  <div style="font-size: 0.8125rem; color: rgb(112, 113, 125); margin-top: 0.25rem;">Mon-Fri, 9:00 AM - 5:00 PM</div>
                </div>
              </div>
            </div>
            <div style="display: flex; align-items: center; gap: 0.75rem;">
              <i data-lucide="calendar-off" style="width: 18px; height: 18px; color: rgb(112, 113, 125);"></i>
              <div>
                <div style="font-size: 0.875rem; font-weight: 600; color: rgb(43, 45, 63);">Holidays</div>
                <div style="font-size: 0.8125rem; color: rgb(112, 113, 125); margin-top: 0.25rem;">10 federal holidays configured</div>
              </div>
            </div>
          </div>


          <!-- Call Routing Configuration -->
          <div>
            <h3 style="font-size: 1rem; font-weight: 600; color: rgb(43, 45, 63); margin-bottom: 1.25rem;">Call Routing</h3>
            
            <!-- Open Hours -->
            <div style="background: white; border: 1px solid rgb(229, 229, 234); border-radius: 0.5rem; padding: 1.25rem; margin-bottom: 1rem;">
              <div style="display: flex; align-items: center; justify-content: space-between; margin-bottom: 1rem;">
                <div style="display: flex; align-items: center; gap: 0.625rem;">
                  <i data-lucide="sun" style="width: 18px; height: 18px; color: rgb(13, 98, 255);"></i>
                  <h4 style="font-size: 0.9375rem; font-weight: 600; color: rgb(43, 45, 63); margin: 0;">Open Hours</h4>
                </div>
              </div>
              
              <div style="display: grid; gap: 0.75rem;">
                <div style="display: flex; align-items: center; justify-content: space-between; padding: 0.75rem; background: rgb(252, 252, 252); border-radius: 0.375rem;">
                  <div style="display: flex; align-items: center; gap: 0.625rem;">
                    <i data-lucide="volume-2" style="width: 16px; height: 16px; color: rgb(112, 113, 125);"></i>
                    <div>
                      <div style="font-size: 0.8125rem; font-weight: 500; color: rgb(43, 45, 63);">Default Greeting</div>
                      <div style="display: flex; align-items: center; gap: 0.375rem; margin-top: 0.25rem;">
                        <span style="background: rgb(241, 242, 246); color: rgb(112, 113, 125); padding: 0.125rem 0.375rem; border-radius: 0.25rem; font-size: 0.625rem; font-weight: 600; text-transform: uppercase;">Backup Only</span>
                      </div>
                    </div>
                  </div>
                  <button onclick="jumpToOpenGreeting()" style="background: none; border: none; color: rgb(13, 98, 255); font-size: 0.75rem; font-weight: 600; cursor: pointer;">Edit</button>
                </div>
                
                <div style="display: flex; align-items: center; justify-content: space-between; padding: 0.75rem; background: rgb(252, 252, 252); border-radius: 0.375rem;">
                  <div style="display: flex; align-items: center; gap: 0.625rem;">
                    <i data-lucide="grid-3x3" style="width: 16px; height: 16px; color: rgb(112, 113, 125);"></i>
                    <div>
                      <div style="font-size: 0.8125rem; font-weight: 500; color: rgb(43, 45, 63);">Keypad menu</div>
                      <div style="display: flex; align-items: center; gap: 0.375rem; margin-top: 0.25rem;">
                        <span style="background: linear-gradient(135deg, rgb(224, 242, 254) 0%, rgb(209, 241, 255) 100%); color: rgb(13, 98, 255); padding: 0.125rem 0.375rem; border-radius: 0.25rem; font-size: 0.625rem; font-weight: 600; text-transform: uppercase; border: 1px solid rgb(186, 230, 253);">Powers VA</span>
                      </div>
                    </div>
                  </div>
                  <button onclick="jumpToOpenKeypad()" style="background: none; border: none; color: rgb(13, 98, 255); font-size: 0.75rem; font-weight: 600; cursor: pointer;">Edit</button>
                </div>
              </div>
            </div>
            
            <!-- Closed Hours -->
            <div style="background: white; border: 1px solid rgb(229, 229, 234); border-radius: 0.5rem; padding: 1.25rem;">
              <div style="display: flex; align-items: center; justify-content: space-between; margin-bottom: 1rem;">
                <div style="display: flex; align-items: center; gap: 0.625rem;">
                  <i data-lucide="moon" style="width: 18px; height: 18px; color: rgb(112, 113, 125);"></i>
                  <h4 style="font-size: 0.9375rem; font-weight: 600; color: rgb(43, 45, 63); margin: 0;">Closed Hours</h4>
                </div>
              </div>
              
              <div style="display: grid; gap: 0.75rem;">
                <div style="display: flex; align-items: center; justify-content: space-between; padding: 0.75rem; background: rgb(252, 252, 252); border-radius: 0.375rem;">
                  <div style="display: flex; align-items: center; gap: 0.625rem;">
                    <i data-lucide="volume-2" style="width: 16px; height: 16px; color: rgb(112, 113, 125);"></i>
                    <div>
                      <div style="font-size: 0.8125rem; font-weight: 500; color: rgb(43, 45, 63);">After Hours Message</div>
                      <div style="display: flex; align-items: center; gap: 0.375rem; margin-top: 0.25rem;">
                        <span style="background: rgb(241, 242, 246); color: rgb(112, 113, 125); padding: 0.125rem 0.375rem; border-radius: 0.25rem; font-size: 0.625rem; font-weight: 600; text-transform: uppercase;">Backup Only</span>
                      </div>
                    </div>
                  </div>
                  <button onclick="jumpToClosedGreeting()" style="background: none; border: none; color: rgb(13, 98, 255); font-size: 0.75rem; font-weight: 600; cursor: pointer;">Edit</button>
                </div>
                
                <div style="display: flex; align-items: center; justify-content: space-between; padding: 0.75rem; background: rgb(252, 252, 252); border-radius: 0.375rem;">
                  <div style="display: flex; align-items: center; gap: 0.625rem;">
                    <i data-lucide="voicemail" style="width: 16px; height: 16px; color: rgb(112, 113, 125);"></i>
                    <div>
                      <div style="font-size: 0.8125rem; font-weight: 500; color: rgb(43, 45, 63);">Send to Voicemail</div>
                      <div style="display: flex; align-items: center; gap: 0.375rem; margin-top: 0.25rem;">
                        <span style="background: linear-gradient(135deg, rgb(224, 242, 254) 0%, rgb(209, 241, 255) 100%); color: rgb(13, 98, 255); padding: 0.125rem 0.375rem; border-radius: 0.25rem; font-size: 0.625rem; font-weight: 600; text-transform: uppercase; border: 1px solid rgb(186, 230, 253);">Powers VA</span>
                      </div>
                    </div>
                  </div>
                  <button onclick="jumpToClosedRouting()" style="background: none; border: none; color: rgb(13, 98, 255); font-size: 0.75rem; font-weight: 600; cursor: pointer;">Edit</button>
                </div>
              </div>
            </div>
          </div>
        </div>

          </div> <!-- End backup-content -->
        </div> <!-- End backup-callflow-section -->

      </div>
    </div>

    <!-- AI Settings Screen (Moved outside #page-attendants to prevent parent hiding) -->
    <div id="ai-settings" style="display: none; padding: 1.5rem;">
      <!-- Header -->
      <div style="background: white; padding: 1.5rem 24px 20px 24px; margin: -24px -24px 24px -24px; box-shadow: 0 1px 3px rgba(0,0,0,0.1);">
        <div style="display: flex; align-items: center; justify-content: space-between; margin-bottom: 1rem;">
          <h1 style="font-size: 1.25rem; font-weight: 600; color: rgb(43, 45, 63); margin: 0;">Google Virtual Assistant Settings</h1>
          <button onclick="saveAISettingsAndExit()" style="background: none; border: 1px solid rgb(221, 221, 226); color: rgb(13, 98, 255); padding: 0.5rem 20px; border-radius: 0.25rem; font-size: 0.8125rem; font-weight: 600; text-transform: uppercase; letter-spacing: 0.5px; cursor: pointer; transition: all 0.15s;" onmouseover="this.style.background='rgb(252, 252, 252)'" onmouseout="this.style.background='none'">
            SAVE & EXIT
          </button>
        </div>
        
        <!-- Breadcrumb -->
        <div style="display: flex; align-items: center; gap: 0.5rem; font-size: 0.8125rem; color: rgb(112, 113, 125);">
          <span>Call Flow</span>
          <i data-lucide="chevron-right" style="width: 14px; height: 14px;"></i>
          <span style="color: rgb(13, 98, 255); font-weight: 600;">Settings</span>
        </div>
      </div>

      <div style="max-width: 1000px;">
        <!-- Email Notifications Section -->
        <div style="background: white; border: 1px solid rgb(241, 242, 246); border-radius: 0.75rem; padding: 1.75rem; margin-bottom: 1.5rem;">
          <h2 style="font-size: 1rem; font-weight: 600; color: rgb(43, 45, 63); margin-bottom: 1.25rem;">Email Notifications</h2>
          
          <div style="display: flex; align-items: start; justify-content: space-between; margin-bottom: 1.25rem;">
            <div style="flex: 1;">
              <div style="display: flex; align-items: center; gap: 0.75rem; margin-bottom: 0.5rem;">
                <i data-lucide="mail" style="width: 20px; height: 20px; color: rgb(13, 98, 255);"></i>
                <h3 style="font-size: 0.875rem; font-weight: 600; color: rgb(43, 45, 63); margin: 0;">Low Balance Alerts</h3>
              </div>
              <p style="font-size: 0.8125rem; color: rgb(112, 113, 125); line-height: 1.5; margin: 0;">
                Receive email notifications when your AI minutes reach 80% and 90% usage
              </p>
            </div>
            <label class="toggle-switch">
              <input type="checkbox" id="email-notifications-toggle" checked>
              <span class="toggle-slider"></span>
            </label>
          </div>

          <div>
            <label style="display: block; font-size: 0.8125rem; font-weight: 600; color: rgb(89, 90, 105); margin-bottom: 0.5rem;">Email Address</label>
            <input 
              type="email" 
              id="user-email" 
              value="really_changeds@example.com"
              readonly
              style="width: 100%; max-width: 400px; padding: 0.625rem 14px; border: 2px solid rgb(229, 229, 234); border-radius: 0.375rem; font-size: 0.875rem; background: rgb(249, 250, 251); color: rgb(43, 45, 63); cursor: not-allowed; outline: none;"
            />
          </div>
        </div>

        <!-- Automatic Monthly Reset Section -->
        <div style="background: white; border: 1px solid rgb(241, 242, 246); border-radius: 0.75rem; padding: 1.75rem; margin-bottom: 1.5rem;">
          <h2 style="font-size: 1rem; font-weight: 600; color: rgb(43, 45, 63); margin-bottom: 1.25rem;">Automatic Monthly Reset</h2>
          
          <div style="display: flex; align-items: start; justify-content: space-between;">
            <div style="flex: 1;">
              <div style="display: flex; align-items: center; gap: 0.75rem; margin-bottom: 0.5rem;">
                <i data-lucide="calendar" style="width: 20px; height: 20px; color: rgb(13, 98, 255);"></i>
                <h3 style="font-size: 0.875rem; font-weight: 600; color: rgb(43, 45, 63); margin: 0;">Auto-Enable at Billing Cycle</h3>
              </div>
              <p style="font-size: 0.8125rem; color: rgb(112, 113, 125); line-height: 1.5; margin: 0;">
                When enabled, Google Virtual Assistant automatically turns on at the start of each billing cycle if you have available minutes. Disable this to maintain manual control over when AI call handling is active.
              </p>
            </div>
            <label class="toggle-switch" style="margin-left: 1.5rem;">
              <input type="checkbox" id="auto-reset-toggle" checked>
              <span class="toggle-slider"></span>
            </label>
          </div>
        </div>

        <!-- CFNR Configuration Section -->
        <div style="background: white; border: 1px solid rgb(241, 242, 246); border-radius: 0.75rem; padding: 1.75rem; margin-bottom: 1.5rem;">
          <h2 style="font-size: 1rem; font-weight: 600; color: rgb(43, 45, 63); margin-bottom: 1.25rem;">Call Forward No Reply (CFNR)</h2>
          
          <div style="background: rgb(252, 252, 252); border: 1px solid rgb(241, 242, 246); border-radius: 0.5rem; padding: 1rem; margin-bottom: 1.25rem;">
            <div style="display: flex; align-items: start; gap: 0.75rem;">
              <i data-lucide="info" style="width: 18px; height: 18px; color: rgb(13, 98, 255); flex-shrink: 0; margin-top: 0.125rem;"></i>
              <p style="font-size: 0.8125rem; color: rgb(89, 90, 105); line-height: 1.5; margin: 0;">
                Automatically forward unanswered calls after a specified time period to ensure no calls are missed. These settings are used by your Google Virtual Assistant.
              </p>
            </div>
          </div>

          <div style="display: flex; align-items: start; justify-content: space-between;">
            <div style="flex: 1;">
              <div style="display: flex; align-items: center; gap: 0.75rem; margin-bottom: 0.5rem;">
                <i data-lucide="phone-forwarded" style="width: 20px; height: 20px; color: rgb(13, 98, 255);"></i>
                <h3 style="font-size: 0.875rem; font-weight: 600; color: rgb(43, 45, 63); margin: 0;">Forward Destination</h3>
              </div>
              <p style="font-size: 0.8125rem; color: rgb(43, 45, 63); font-weight: 500; line-height: 1.5; margin: 0;">
                +1 (215) 555-0100
              </p>
            </div>
            <button onclick="saveCFNRAndNext()" style="padding: 0.5rem 16px; background: rgb(13, 98, 255); color: white; border: none; border-radius: 0.375rem; font-size: 0.8125rem; font-weight: 600; cursor: pointer; white-space: nowrap; margin-left: 1rem;">Edit</button>
          </div>
        </div>
      </div>

    </div>

    <!-- Add AI Minutes Page -->
    <div id="page-add-minutes" style="display: none; padding: 1.5rem;">
      <!-- Header -->
      <div style="background: white; padding: 1.5rem 24px 20px 24px; margin: -24px -24px 24px -24px; box-shadow: 0 1px 3px rgba(0,0,0,0.1);">
        <div style="display: flex; align-items: center; justify-content: space-between; margin-bottom: 1rem;">
          <h1 style="font-size: 1.25rem; font-weight: 600; color: rgb(43, 45, 63); margin: 0;">Add AI Minutes</h1>
          <button onclick="closeAddMinutesPage()" style="background: none; border: 1px solid rgb(221, 221, 226); color: rgb(112, 113, 125); padding: 0.5rem 20px; border-radius: 0.25rem; font-size: 0.8125rem; font-weight: 600; text-transform: uppercase; letter-spacing: 0.5px; cursor: pointer; transition: all 0.15s;" onmouseover="this.style.background='rgb(252, 252, 252)'" onmouseout="this.style.background='none'">
            <i data-lucide="x" style="width: 16px; height: 16px; display: inline-block; vertical-align: middle; margin-right: 0.375rem;"></i>
            CLOSE
          </button>
        </div>
        
        <!-- Breadcrumb -->
        <div style="display: flex; align-items: center; gap: 0.5rem; font-size: 0.8125rem; color: rgb(112, 113, 125);">
          <span>AI Usage</span>
          <i data-lucide="chevron-right" style="width: 14px; height: 14px;"></i>
          <span style="color: rgb(13, 98, 255); font-weight: 600;">Add Minutes</span>
        </div>
      </div>

      <div style="max-width: 800px; margin: 0 auto;">
        <!-- Hero Section -->
        <div style="background: rgb(224, 242, 254); border-radius: 0.75rem; padding: 2.5rem 32px; margin-bottom: 2rem; text-align: center;">
          <div style="width: 80px; height: 80px; background: white; border-radius: 50%; display: flex; align-items: center; justify-content: center; margin: 0 auto 1.5rem;">
            <i data-lucide="phone" style="width: 40px; height: 40px; color: rgb(13, 98, 255);"></i>
          </div>
          <h2 style="font-size: 1.5rem; font-weight: 600; color: rgb(43, 45, 63); margin: 0 0 0.75rem 0;">Need More AI Minutes?</h2>
          <p style="font-size: 1rem; color: rgb(89, 90, 105); line-height: 1.6; margin: 0;">Contact our Customer Care team to add additional Google Virtual Assistant minutes to your account.</p>
        </div>

        <!-- Contact Customer Care Card -->
        <div style="background: white; border: 2px solid rgb(13, 98, 255); border-radius: 0.75rem; padding: 2rem; margin-bottom: 1.5rem;">
          <div style="display: flex; align-items: start; gap: 1.5rem;">
            <div style="width: 56px; height: 56px; background: rgb(224, 242, 254); border-radius: 0.75rem; display: flex; align-items: center; justify-content: center; flex-shrink: 0;">
              <i data-lucide="headphones" style="width: 28px; height: 28px; color: rgb(13, 98, 255);"></i>
            </div>
            <div style="flex: 1;">
              <h3 style="font-size: 1.125rem; font-weight: 600; color: rgb(43, 45, 63); margin: 0 0 0.75rem 0;">Contact Customer Care</h3>
              <p style="font-size: 0.875rem; color: rgb(112, 113, 125); line-height: 1.6; margin: 0 0 1.5rem 0;">
                Our Customer Care team works directly with Google to provision additional AI minutes for your account. Have your account number ready when you call.
              </p>
              
              <!-- Contact Options -->
              <div style="display: flex; flex-direction: column; gap: 1rem;">
                <a href="tel:1-800-555-2000" style="display: flex; align-items: center; gap: 1rem; padding: 1rem; background: rgb(252, 252, 252); border: 1px solid rgb(229, 229, 234); border-radius: 0.5rem; text-decoration: none; transition: all 0.15s;" onmouseover="this.style.background='rgb(245, 248, 255)'; this.style.borderColor='rgb(186, 230, 253)'" onmouseout="this.style.background='rgb(252, 252, 252)'; this.style.borderColor='rgb(229, 229, 234)'">
                  <div style="width: 40px; height: 40px; background: rgb(13, 98, 255); border-radius: 0.5rem; display: flex; align-items: center; justify-content: center; flex-shrink: 0;">
                    <i data-lucide="phone" style="width: 20px; height: 20px; color: white;"></i>
                  </div>
                  <div style="flex: 1;">
                    <div style="font-size: 0.75rem; font-weight: 600; color: rgb(112, 113, 125); text-transform: uppercase; letter-spacing: 0.5px; margin-bottom: 0.25rem;">Call Us</div>
                    <div style="font-size: 1.125rem; font-weight: 600; color: rgb(13, 98, 255);">1-800-555-2000</div>
                  </div>
                  <i data-lucide="arrow-right" style="width: 20px; height: 20px; color: rgb(13, 98, 255);"></i>
                </a>

                <a href="#" onclick="alert('Chat feature coming soon'); return false;" style="display: flex; align-items: center; gap: 1rem; padding: 1rem; background: rgb(252, 252, 252); border: 1px solid rgb(229, 229, 234); border-radius: 0.5rem; text-decoration: none; transition: all 0.15s;" onmouseover="this.style.background='rgb(245, 248, 255)'; this.style.borderColor='rgb(186, 230, 253)'" onmouseout="this.style.background='rgb(252, 252, 252)'; this.style.borderColor='rgb(229, 229, 234)'">
                  <div style="width: 40px; height: 40px; background: rgb(13, 98, 255); border-radius: 0.5rem; display: flex; align-items: center; justify-content: center; flex-shrink: 0;">
                    <i data-lucide="message-circle" style="width: 20px; height: 20px; color: white;"></i>
                  </div>
                  <div style="flex: 1;">
                    <div style="font-size: 0.75rem; font-weight: 600; color: rgb(112, 113, 125); text-transform: uppercase; letter-spacing: 0.5px; margin-bottom: 0.25rem;">Live Chat</div>
                    <div style="font-size: 0.875rem; font-weight: 600; color: rgb(43, 45, 63);">Chat with a specialist</div>
                  </div>
                  <i data-lucide="arrow-right" style="width: 20px; height: 20px; color: rgb(13, 98, 255);"></i>
                </a>
              </div>
            </div>
          </div>
        </div>

        <!-- Business Hours Info -->
        <div style="background: rgb(252, 252, 252); border: 1px solid rgb(229, 229, 234); border-radius: 0.75rem; padding: 1.5rem; margin-bottom: 1.5rem;">
          <div style="display: flex; align-items: start; gap: 1rem;">
            <i data-lucide="clock" style="width: 20px; height: 20px; color: rgb(13, 98, 255); flex-shrink: 0; margin-top: 0.125rem;"></i>
            <div>
              <h4 style="font-size: 0.875rem; font-weight: 600; color: rgb(43, 45, 63); margin: 0 0 0.5rem 0;">Customer Care Hours</h4>
              <p style="font-size: 0.8125rem; color: rgb(112, 113, 125); line-height: 1.5; margin: 0;">
                Monday - Friday: 8:00 AM - 8:00 PM ET<br>
                Saturday: 9:00 AM - 6:00 PM ET<br>
                Sunday: Closed
              </p>
            </div>
          </div>
        </div>

        <!-- Important Notes -->
        <div style="background: rgb(254, 249, 195); border: 2px solid rgb(250, 204, 21); border-radius: 0.75rem; padding: 1.5rem; margin-bottom: 1.5rem;">
          <div style="display: flex; align-items: start; gap: 1rem;">
            <i data-lucide="alert-circle" style="width: 20px; height: 20px; color: rgb(161, 98, 7); flex-shrink: 0; margin-top: 0.125rem;"></i>
            <div>
              <h4 style="font-size: 0.875rem; font-weight: 600; color: rgb(161, 98, 7); margin: 0 0 0.5rem 0;">Important Information</h4>
              <ul style="font-size: 0.8125rem; color: rgb(120, 53, 15); line-height: 1.6; margin: 0; padding-left: 1.25rem;">
                <li style="margin-bottom: 0.375rem;">Additional minutes are provisioned by Google and may take 1-2 business days to reflect in your account</li>
                <li style="margin-bottom: 0.375rem;">Pricing varies based on your current plan and commitment level</li>
                <li style="margin-bottom: 0.375rem;">Your account number will be required to process the request</li>
                <li>Changes to your AI minutes allocation may affect your monthly billing</li>
              </ul>
            </div>
          </div>
        </div>

        <!-- FAQ Section -->
        <div style="background: white; border: 1px solid rgb(229, 229, 234); border-radius: 0.75rem; padding: 1.5rem;">
          <h3 style="font-size: 1rem; font-weight: 600; color: rgb(43, 45, 63); margin: 0 0 1rem 0;">Frequently Asked Questions</h3>
          
          <div style="margin-bottom: 1rem;">
            <h4 style="font-size: 0.875rem; font-weight: 600; color: rgb(43, 45, 63); margin: 0 0 0.375rem 0;">How long does it take to add minutes?</h4>
            <p style="font-size: 0.8125rem; color: rgb(112, 113, 125); line-height: 1.5; margin: 0;">
              Once you contact Customer Care, the request is submitted to Google for provisioning. Additional minutes typically appear in your account within 1-2 business days.
            </p>
          </div>
          
          <div style="margin-bottom: 1rem;">
            <h4 style="font-size: 0.875rem; font-weight: 600; color: rgb(43, 45, 63); margin: 0 0 0.375rem 0;">Will my service be interrupted?</h4>
            <p style="font-size: 0.8125rem; color: rgb(112, 113, 125); line-height: 1.5; margin: 0;">
              No. Your call flow continues to function during the provisioning process. If you've run out of AI minutes, calls will route to your configured fallback call flow until new minutes are available.
            </p>
          </div>
          
          <div>
            <h4 style="font-size: 0.875rem; font-weight: 600; color: rgb(43, 45, 63); margin: 0 0 0.375rem 0;">Can I add minutes myself?</h4>
            <p style="font-size: 0.8125rem; color: rgb(112, 113, 125); line-height: 1.5; margin: 0;">
              Currently, AI minute provisioning requires coordination between Comcast Business and Google. Our Customer Care team handles this process to ensure proper account configuration and billing.
            </p>
          </div>
        </div>
      </div>
    </div>

    <!-- Call Flow Builder Page -->
    <div id="page-callflow" class="page">
      <div class="page-header">
        <div>
          <div class="page-title">CALL FLOW CONFIGURATION</div>
          <div class="location-info">
            <span>Business Hours Attendant</span>
          </div>
          <p style="color: rgb(112, 113, 125); font-size: 0.8125rem; margin: 0.5rem 0 0 0;">Design your call routing and Keypad menu workflow</p>
        </div>
        <div style="display: flex; gap: 0.75rem;">
          <button class="action-button">
            <i data-lucide="save" style="width: 16px; height: 16px;"></i>
            <span>SAVE FLOW</span>
          </button>
          <button class="action-button">
            <i data-lucide="play" style="width: 16px; height: 16px;"></i>
            <span>TEST FLOW</span>
          </button>
          <button class="action-button-primary">
            <i data-lucide="plus" style="width: 16px; height: 16px;"></i>
            <span>ADD NODE</span>
          </button>
        </div>
      </div>

      <div class="card">
        <div class="card-header">
          <h3 class="card-title">Flow Builder</h3>
        </div>
        <div class="card-body">
          <div class="flow-builder">
            <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 1.25rem;">
              <div class="flow-node" style="border-color: rgb(34, 197, 94); background: linear-gradient(135deg, rgb(220, 252, 231) 0%, white 100%);">
                <div class="flow-node-title">
                  <i data-lucide="phone-incoming" style="width: 20px; height: 20px; color: rgb(34, 197, 94);"></i>
                  <span>Incoming Call</span>
                </div>
                <div class="flow-node-desc">Entry point for all calls</div>
                <div class="flow-node-tags">
                  <span class="flow-tag" style="background: rgb(220, 252, 231); color: rgb(22, 101, 52);">Start</span>
                </div>
              </div>

              <div class="flow-node">
                <div class="flow-node-title">
                  <i data-lucide="menu" style="width: 20px; height: 20px; color: rgb(13, 98, 255);"></i>
                  <span>Main Keypad menu</span>
                </div>
                <div class="flow-node-desc">"Press 1 for Sales, 2 for Support..."</div>
                <div class="flow-node-tags">
                  <span class="flow-tag">1: Sales</span>
                  <span class="flow-tag">2: Support</span>
                  <span class="flow-tag">0: Operator</span>
                </div>
              </div>

              <div class="flow-node">
                <div class="flow-node-title">
                  <i data-lucide="users" style="width: 20px; height: 20px; color: rgb(168, 85, 247);"></i>
                  <span>Route to Department</span>
                </div>
                <div class="flow-node-desc">Transfer call to selected queue</div>
                <div class="flow-node-tags">
                  <span class="flow-tag">Queue</span>
                </div>
              </div>

              <div class="flow-node">
                <div class="flow-node-title">
                  <i data-lucide="clock" style="width: 20px; height: 20px; color: rgb(234, 179, 8);"></i>
                  <span>Business Hours Check</span>
                </div>
                <div class="flow-node-desc">Verify current operating hours</div>
                <div class="flow-node-tags">
                  <span class="flow-tag">Open</span>
                  <span class="flow-tag">Closed</span>
                </div>
              </div>

              <div class="flow-node">
                <div class="flow-node-title">
                  <i data-lucide="voicemail" style="width: 20px; height: 20px; color: rgb(168, 85, 247);"></i>
                  <span>Voicemail</span>
                </div>
                <div class="flow-node-desc">Record caller message</div>
                <div class="flow-node-tags">
                  <span class="flow-tag">Record</span>
                </div>
              </div>

              <div class="flow-node" style="border-color: rgb(239, 68, 68); background: linear-gradient(135deg, rgb(254, 226, 226) 0%, white 100%);">
                <div class="flow-node-title">
                  <i data-lucide="phone-off" style="width: 20px; height: 20px; color: rgb(239, 68, 68);"></i>
                  <span>End Call</span>
                </div>
                <div class="flow-node-desc">Call completed</div>
                <div class="flow-node-tags">
                  <span class="flow-tag" style="background: rgb(254, 226, 226); color: rgb(153, 27, 27);">Hangup</span>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Keypad menu Page -->
    <div id="page-keypad" class="page">
      <div class="page-header">
        <div>
          <div class="page-title">KEYPAD MENU CONFIGURATION</div>
          <div class="location-info">
            <span>Keypad Menu Options</span>
          </div>
          <p style="color: rgb(112, 113, 125); font-size: 0.8125rem; margin: 0.5rem 0 0 0;">Configure keypad actions and routing</p>
        </div>
      </div>

      <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1.5rem;">
        <div class="card">
          <div class="card-header">
            <h3 class="card-title">Keypad Layout</h3>
          </div>
          <div class="card-body">
            <div class="keypad-grid">
              <div class="keypad-key">1</div>
              <div class="keypad-key">2</div>
              <div class="keypad-key">3</div>
              <div class="keypad-key">4</div>
              <div class="keypad-key">5</div>
              <div class="keypad-key">6</div>
              <div class="keypad-key">7</div>
              <div class="keypad-key">8</div>
              <div class="keypad-key">9</div>
              <div class="keypad-key">*</div>
              <div class="keypad-key">0</div>
              <div class="keypad-key">#</div>
            </div>
            <p style="text-align: center; font-size: 0.8125rem; color: rgb(112, 113, 125);">Click a key to configure its action</p>
          </div>
        </div>

        <div class="card">
          <div class="card-header">
            <h3 class="card-title">Key Actions</h3>
          </div>
          <div class="card-body">
            <div class="user-card">
              <div class="user-avatar" style="background: rgb(13, 98, 255);">1</div>
              <div class="user-info">
                <div class="user-name">Sales Department</div>
                <div class="user-details">Transfer to sales team</div>
              </div>
              <button class="action-button" style="padding: 0.375rem 16px;">EDIT</button>
            </div>

            <div class="user-card">
              <div class="user-avatar" style="background: rgb(13, 98, 255);">2</div>
              <div class="user-info">
                <div class="user-name">Support Department</div>
                <div class="user-details">Technical support queue</div>
              </div>
              <button class="action-button" style="padding: 0.375rem 16px;">EDIT</button>
            </div>

            <div class="user-card">
              <div class="user-avatar" style="background: rgb(13, 98, 255);">3</div>
              <div class="user-info">
                <div class="user-name">Billing & Accounts</div>
                <div class="user-details">Billing inquiries</div>
              </div>
              <button class="action-button" style="padding: 0.375rem 16px;">EDIT</button>
            </div>

            <div class="user-card">
              <div class="user-avatar" style="background: rgb(13, 98, 255);">0</div>
              <div class="user-info">
                <div class="user-name">Operator</div>
                <div class="user-details">Live operator assistance</div>
              </div>
              <button class="action-button" style="padding: 0.375rem 16px;">EDIT</button>
            </div>

            <div class="user-card">
              <div class="user-avatar" style="background: rgb(180, 181, 187);">#</div>
              <div class="user-info">
                <div class="user-name" style="color: rgb(157, 158, 167);">Not Configured</div>
                <div class="user-details">No action assigned</div>
              </div>
              <button class="action-button-primary" style="padding: 0.375rem 16px;">CONFIGURE</button>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Contact Lists Page -->
    <div id="page-contacts" class="page">
      <div class="page-header">
        <div>
          <div class="page-title">CONTACT LISTS</div>
          <div class="location-info">
            <span>Blocked & Permitted Numbers</span>
          </div>
          <p style="color: rgb(112, 113, 125); font-size: 0.8125rem; margin: 0.5rem 0 0 0;">Manage phone number access control</p>
        </div>
        <button class="action-button-primary">
          <i data-lucide="plus" style="width: 16px; height: 16px;"></i>
          <span>ADD CONTACT</span>
        </button>
      </div>

      <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1.5rem;">
        <div class="card">
          <div class="card-header" style="display: flex; justify-content: space-between; align-items: center;">
            <div style="display: flex; align-items: center; gap: 0.75rem;">
              <i data-lucide="x-circle" style="width: 24px; height: 24px; color: rgb(239, 68, 68);"></i>
              <div>
                <h3 class="card-title">Blocked Numbers</h3>
                <p style="font-size: 0.75rem; color: rgb(112, 113, 125); margin: 0.25rem 0 0 0;">42 numbers blocked</p>
              </div>
            </div>
            <button class="action-button" style="padding: 0.375rem 16px;">IMPORT</button>
          </div>
          <div class="card-body">
            <input type="text" class="search-box" placeholder="Search blocked numbers...">
            
            <div class="user-card" style="background: rgb(254, 226, 226); border-color: rgb(254, 202, 202);">
              <div class="user-info">
                <div class="user-name">(215) 555-0199</div>
                <div class="user-details">Spam caller</div>
              </div>
              <button style="background: none; border: none; color: rgb(220, 38, 38); cursor: pointer;">
                <i data-lucide="trash-2" style="width: 18px; height: 18px;"></i>
              </button>
            </div>

            <div class="user-card" style="background: rgb(254, 226, 226); border-color: rgb(254, 202, 202);">
              <div class="user-info">
                <div class="user-name">(215) 555-0188</div>
                <div class="user-details">Telemarketer</div>
              </div>
              <button style="background: none; border: none; color: rgb(220, 38, 38); cursor: pointer;">
                <i data-lucide="trash-2" style="width: 18px; height: 18px;"></i>
              </button>
            </div>

            <div class="user-card" style="background: rgb(254, 226, 226); border-color: rgb(254, 202, 202);">
              <div class="user-info">
                <div class="user-name">(215) 555-0177</div>
                <div class="user-details">Robocaller</div>
              </div>
              <button style="background: none; border: none; color: rgb(220, 38, 38); cursor: pointer;">
                <i data-lucide="trash-2" style="width: 18px; height: 18px;"></i>
              </button>
            </div>

            <div style="text-align: center; margin-top: 1rem;">
              <a href="#" class="link-button">View all 42 blocked numbers</a>
            </div>
          </div>
        </div>

        <div class="card">
          <div class="card-header" style="display: flex; justify-content: space-between; align-items: center;">
            <div style="display: flex; align-items: center; gap: 0.75rem;">
              <i data-lucide="check-circle" style="width: 24px; height: 24px; color: rgb(34, 197, 94);"></i>
              <div>
                <h3 class="card-title">Permitted Numbers</h3>
                <p style="font-size: 0.75rem; color: rgb(112, 113, 125); margin: 0.25rem 0 0 0;">128 numbers allowed</p>
              </div>
            </div>
            <button class="action-button" style="padding: 0.375rem 16px;">IMPORT</button>
          </div>
          <div class="card-body">
            <input type="text" class="search-box" placeholder="Search permitted numbers...">
            
            <div class="user-card" style="background: rgb(220, 252, 231); border-color: rgb(187, 247, 208);">
              <div class="user-info">
                <div class="user-name">(215) 555-0123</div>
                <div class="user-details">Partner company</div>
              </div>
              <button style="background: none; border: none; color: rgb(22, 163, 74); cursor: pointer;">
                <i data-lucide="edit" style="width: 18px; height: 18px;"></i>
              </button>
            </div>

            <div class="user-card" style="background: rgb(220, 252, 231); border-color: rgb(187, 247, 208);">
              <div class="user-info">
                <div class="user-name">(215) 555-0134</div>
                <div class="user-details">VIP client</div>
              </div>
              <button style="background: none; border: none; color: rgb(22, 163, 74); cursor: pointer;">
                <i data-lucide="edit" style="width: 18px; height: 18px;"></i>
              </button>
            </div>

            <div class="user-card" style="background: rgb(220, 252, 231); border-color: rgb(187, 247, 208);">
              <div class="user-info">
                <div class="user-name">(215) 555-0145</div>
                <div class="user-details">Emergency contact</div>
              </div>
              <button style="background: none; border: none; color: rgb(22, 163, 74); cursor: pointer;">
                <i data-lucide="edit" style="width: 18px; height: 18px;"></i>
              </button>
            </div>

            <div style="text-align: center; margin-top: 1rem;">
              <a href="#" class="link-button">View all 128 permitted numbers</a>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Call Queues Page -->
    <div id="page-queues" class="page">
      <div class="page-header">
        <div>
          <div class="page-title">CALL QUEUES</div>
          <div class="location-info">
            <span>Queue Management</span>
          </div>
          <p style="color: rgb(112, 113, 125); font-size: 0.8125rem; margin: 0.5rem 0 0 0;">Manage call queues and agent assignments</p>
        </div>
        <button class="action-button-primary">
          <i data-lucide="plus" style="width: 16px; height: 16px;"></i>
          <span>CREATE QUEUE</span>
        </button>
      </div>

      <div class="card">
        <div class="card-header">
          <h3 class="card-title">Active Queues</h3>
        </div>
        <div class="card-body">
          <table>
            <thead>
              <tr>
                <th>Queue Name</th>
                <th>Phone Number</th>
                <th>Agents</th>
                <th>Calls in Queue</th>
                <th>Avg Wait Time</th>
                <th>Actions</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>
                  <div style="font-weight: 600;">Sales Queue</div>
                  <div style="font-size: 0.75rem; color: rgb(157, 158, 167); margin-top: 0.125rem;">Primary sales routing</div>
                </td>
                <td>(445) 223-3042</td>
                <td>
                  <div style="display: flex; align-items: center; gap: 0.5rem;">
                    <span style="font-weight: 600;">12</span>
                    <span class="badge badge-active">5 Available</span>
                  </div>
                </td>
                <td><span style="font-weight: 600; color: rgb(13, 98, 255);">3</span></td>
                <td>2m 14s</td>
                <td>
                  <a href="#" class="link-button">MANAGE</a>
                </td>
              </tr>
              <tr>
                <td>
                  <div style="font-weight: 600;">Support Queue</div>
                  <div style="font-size: 0.75rem; color: rgb(157, 158, 167); margin-top: 0.125rem;">Technical support</div>
                </td>
                <td>(445) 223-3043</td>
                <td>
                  <div style="display: flex; align-items: center; gap: 0.5rem;">
                    <span style="font-weight: 600;">8</span>
                    <span class="badge badge-active">3 Available</span>
                  </div>
                </td>
                <td><span style="font-weight: 600; color: rgb(13, 98, 255);">1</span></td>
                <td>1m 32s</td>
                <td>
                  <a href="#" class="link-button">MANAGE</a>
                </td>
              </tr>
              <tr>
                <td>
                  <div style="font-weight: 600;">Billing Queue</div>
                  <div style="font-size: 0.75rem; color: rgb(157, 158, 167); margin-top: 0.125rem;">Billing and accounts</div>
                </td>
                <td>(445) 223-3044</td>
                <td>
                  <div style="display: flex; align-items: center; gap: 0.5rem;">
                    <span style="font-weight: 600;">6</span>
                    <span class="badge badge-active">4 Available</span>
                  </div>
                </td>
                <td><span style="font-weight: 600;">0</span></td>
                <td>45s</td>
                <td>
                  <a href="#" class="link-button">MANAGE</a>
                </td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
    </div>
  </main>

  <!-- Help Button -->
  <button class="help-button" title="Help">
    <i data-lucide="help-circle" style="width: 24px; height: 24px;"></i>
  </button>

  <!-- Footer -->
  <footer id="footer" style="background: #052766; color: white; padding: 1.5rem 1.5rem 2rem 1.5rem; margin-top: 48px; margin-left: 340px; box-sizing: border-box; transition: margin-left 0.3s ease;">
    <div style="max-width: 1400px; margin: 0 auto;">
      <div style="display: flex; flex-wrap: wrap; gap: 1rem; margin-bottom: 1rem;">
        <a href="#" style="color: white; text-decoration: none; font-size: 0.8125rem; opacity: 0.9;">Contact Us</a>
        <a href="#" style="color: white; text-decoration: none; font-size: 0.8125rem; opacity: 0.9;">Community</a>
        <a href="#" style="color: white; text-decoration: none; font-size: 0.8125rem; opacity: 0.9;">Privacy Policy</a>
        <a href="#" style="color: white; text-decoration: none; font-size: 0.8125rem; opacity: 0.9;">Your Privacy Choices</a>
        <a href="#" style="color: white; text-decoration: none; font-size: 0.8125rem; opacity: 0.9;">Notice at Collection</a>
        <a href="#" style="color: white; text-decoration: none; font-size: 0.8125rem; opacity: 0.9;">Visitor Agreement</a>
        <a href="#" style="color: white; text-decoration: none; font-size: 0.8125rem; opacity: 0.9;">Terms & Conditions</a>
        <a href="#" style="color: white; text-decoration: none; font-size: 0.8125rem; opacity: 0.9;">Sitemap</a>
        <a href="#" style="color: white; text-decoration: none; font-size: 0.8125rem; opacity: 0.9;">Open Source</a>
        <a href="#" style="color: white; text-decoration: none; font-size: 0.8125rem; opacity: 0.9;">Broadband Labels</a>
      </div>
      <div style="font-size: 0.75rem; opacity: 0.7; margin-bottom: 1rem;">©2026 Comcast Corporation. All Rights Reserved.</div>
      <div style="display: flex; gap: 0.75rem; margin-bottom: 1.5rem;">
        <a href="#" style="color: white; opacity: 0.8;">
          <i data-lucide="facebook" style="width: 20px; height: 20px;"></i>
        </a>
        <a href="#" style="color: white; opacity: 0.8;">
          <i data-lucide="linkedin" style="width: 20px; height: 20px;"></i>
        </a>
        <a href="#" style="color: white; opacity: 0.8;">
          <i data-lucide="twitter" style="width: 20px; height: 20px;"></i>
        </a>
      </div>
      <div style="border-top: 1px solid rgba(255,255,255,0.2); padding-top: 1rem; text-align: center;">
        <button style="background: none; border: 1px solid rgba(255,255,255,0.3); color: white; padding: 0.625rem 20px; border-radius: 0.25rem; font-size: 0.8125rem; cursor: pointer; display: inline-flex; align-items: center; gap: 0.5rem; transition: all 0.15s;" onmouseover="this.style.background='rgba(255,255,255,0.1)'" onmouseout="this.style.background='none'">
          <i data-lucide="cookie" style="width: 16px; height: 16px;"></i>
          Cookie Preferences
        </button>
      </div>
    </div>
  </footer>

  <script>
    // Initialize Lucide icons
    lucide.createIcons();
    
    // Check if user is already authenticated
    function checkAuth() {
      const isAuthenticated = localStorage.getItem('autoAttendantAuth');
      const overlay = document.getElementById('login-overlay');
      
      if (isAuthenticated === 'true') {
        overlay.classList.add('hidden');
      }
    }
    
    // Logout function
    function handleLogout() {
      localStorage.removeItem('autoAttendantAuth');
      const overlay = document.getElementById('login-overlay');
      overlay.classList.remove('hidden');
      document.getElementById('login-password').focus();
    }
    
    // Add shake animation for failed login
    const style = document.createElement('style');
    style.textContent = `
      @keyframes shake {
        0%, 100% { transform: translateX(0); }
        10%, 30%, 50%, 70%, 90% { transform: translateX(-10px); }
        20%, 40%, 60%, 80% { transform: translateX(10px); }
      }
    `;
    document.head.appendChild(style);
    
    // Check authentication on page load
    checkAuth();

    // Global state variable
    let keypadContext = 'open'; // 'open' or 'closed'

    // State management with localStorage
    function saveCurrentScreen(screenId, context = {}) {
      console.log('Saving screen:', screenId, context); // Debug
      localStorage.setItem('callflow_current_screen', screenId);
      localStorage.setItem('callflow_context', JSON.stringify(context));
    }

    function restoreState() {
      const savedScreen = localStorage.getItem('callflow_current_screen');
      const savedContext = JSON.parse(localStorage.getItem('callflow_context') || '{}');
      console.log('Restoring state:', savedScreen, savedContext); // Debug
      
      if (savedScreen && savedScreen !== 'fte-callflow') {
        // Hide all pages first
        document.querySelectorAll('.page').forEach(p => p.classList.remove('active'));
        
        // Show the attendants page (parent container)
        const pageAttendants = document.getElementById('page-attendants');
        if (pageAttendants) {
          pageAttendants.classList.add('active');
        }
        
        // Hide all wizard screens first
        document.getElementById('fte-callflow').style.display = 'none';
        document.getElementById('main-callflow-content').style.display = 'none';
        document.getElementById('setup-timezone').style.display = 'none';
        document.getElementById('setup-openhours').style.display = 'none';
        document.getElementById('setup-holidays').style.display = 'none';
        document.getElementById('setup-routing').style.display = 'none';
        document.getElementById('setup-routing-closed').style.display = 'none';
        document.getElementById('setup-cfnr').style.display = 'none';
        document.getElementById('setup-google-ai').style.display = 'none';
        document.getElementById('setup-keypad').style.display = 'none';
        document.getElementById('setup-greeting').style.display = 'none';
        document.getElementById('ai-settings').style.display = 'none';
        
        // Show the saved screen
        document.getElementById(savedScreen).style.display = 'block';
        
        // Update sidebar active state
        document.querySelectorAll('.sidebar-item').forEach(i => i.classList.remove('active'));
        const attendantNavItem = document.querySelector('.sidebar-item[data-page="attendants"]');
        if (attendantNavItem) {
          attendantNavItem.classList.add('active');
        }
        
        // Restore context (keypadContext, etc.)
        if (savedContext.keypadContext) {
          keypadContext = savedContext.keypadContext;
        }
        
        // Update steppers if needed
        if (savedScreen === 'setup-keypad') {
          updateStepper('keypad-stepper', keypadContext);
        } else if (savedScreen === 'setup-greeting') {
          updateStepper('greeting-stepper', keypadContext);
        }
        
        // Show/hide footer and update help button
        if (savedScreen === 'main-callflow-content' || savedScreen === 'fte-callflow') {
          document.getElementById('footer').style.display = 'block';
          document.body.classList.remove('has-wizard-actions');
        } else {
          document.getElementById('footer').style.display = 'none';
          document.body.classList.add('has-wizard-actions');
        }
        
        // Update demo bar based on restored screen
        if (savedScreen === 'main-callflow-content') {
          document.getElementById('demo-fte-control').style.display = 'none';
          document.getElementById('demo-completed-control').style.display = 'flex';
        }
        
        lucide.createIcons();
      }
    }

    // Note: State restoration is now handled when user navigates to attendants page
    // This prevents auto-navigation away from dashboard on page refresh

    // Sidebar collapse toggle
    const sidebar = document.getElementById('sidebar');
    const sidebarToggle = document.getElementById('sidebar-toggle');
    const sidebarToggleIcon = document.getElementById('sidebar-toggle-icon');
    const mainContent = document.querySelector('.main-content');
    const footer = document.getElementById('footer');

    sidebarToggle.addEventListener('click', () => {
      sidebar.classList.toggle('collapsed');
      mainContent.classList.toggle('sidebar-collapsed');

      // Get all wizard bottom action bars
      const wizardBottomActions = document.querySelectorAll('.wizard-bottom-actions');

      // Update footer and wizard action bars
      if (sidebar.classList.contains('collapsed')) {
        footer.style.marginLeft = '60px';
        wizardBottomActions.forEach(el => el.style.left = '60px');
        sidebarToggleIcon.setAttribute('data-lucide', 'chevrons-right');
      } else {
        footer.style.marginLeft = '340px';
        wizardBottomActions.forEach(el => el.style.left = '340px');
        sidebarToggleIcon.setAttribute('data-lucide', 'chevrons-left');
      }

      // Reinitialize icons to show the updated icon
      lucide.createIcons();
    });

    // Navigation
    const sidebarItems = document.querySelectorAll('.sidebar-item[data-page]');
    const pages = document.querySelectorAll('.page');

    sidebarItems.forEach(item => {
      item.addEventListener('click', (e) => {
        e.preventDefault();
        const pageId = item.dataset.page;

        // Update active states
        sidebarItems.forEach(i => i.classList.remove('active'));
        item.classList.add('active');

        // Show selected page
        pages.forEach(p => p.classList.remove('active'));
        const targetPage = document.getElementById(`page-${pageId}`);
        if (targetPage) {
          targetPage.classList.add('active');
        }

        // Manage demo bar visibility
        if (pageId === 'dashboard') {
          // Dashboard: Hide wizard controls
          document.getElementById('demo-fte-control').style.display = 'none';
          document.getElementById('demo-completed-control').style.display = 'none';
        } else if (pageId === 'attendants') {
          // Attendants: Show FTE control initially
          document.getElementById('demo-fte-control').style.display = 'flex';
          document.getElementById('demo-completed-control').style.display = 'none';
          // Restore callflow wizard state (may override to show completed control)
          restoreState();
          // Check if naming modal should be shown for existing customers
          checkAndShowNamingModal();
        } else {
          // Other pages: Hide all wizard controls
          document.getElementById('demo-fte-control').style.display = 'none';
          document.getElementById('demo-completed-control').style.display = 'none';
        }

        // Reinitialize icons
        lucide.createIcons();
      });
    });

    // Quick action functions
    function showCallFlow() {
      document.querySelectorAll('.sidebar-item').forEach(i => i.classList.remove('active'));
      pages.forEach(p => p.classList.remove('active'));
      document.getElementById('page-callflow').classList.add('active');
      lucide.createIcons();
    }

    function showMainBusinessNumberCallflow() {
      // Navigate to the Main Business Number (attendants) page
      document.querySelectorAll('.sidebar-item').forEach(i => i.classList.remove('active'));
      pages.forEach(p => p.classList.remove('active'));
      
      // Activate the attendants page
      document.getElementById('page-attendants').classList.add('active');
      
      // Highlight the correct sidebar item
      const attendantNavItem = document.querySelector('.sidebar-item[data-page="attendants"]');
      if (attendantNavItem) {
        attendantNavItem.classList.add('active');
      }
      
      // Show the FTE screen (not the completed callflow)
      document.getElementById('fte-callflow').style.display = 'block';
      document.getElementById('main-callflow-content').style.display = 'none';
      
      // Update demo bar (show FTE control)
      document.getElementById('demo-fte-control').style.display = 'flex';
      document.getElementById('demo-completed-control').style.display = 'none';
      
      // Check if naming modal should be shown for existing customers
      checkAndShowNamingModal();
      
      // Scroll to top and reinitialize icons
      window.scrollTo(0, 0);
      lucide.createIcons();
    }

    function showKeypadMenu() {
      document.querySelectorAll('.sidebar-item').forEach(i => i.classList.remove('active'));
      pages.forEach(p => p.classList.remove('active'));
      document.getElementById('page-keypad').classList.add('active');
      lucide.createIcons();
    }

    function showContacts() {
      document.querySelectorAll('.sidebar-item').forEach(i => i.classList.remove('active'));
      pages.forEach(p => p.classList.remove('active'));
      document.getElementById('page-contacts').classList.add('active');
      lucide.createIcons();
    }

    // Keypad interaction
    document.querySelectorAll('.keypad-key').forEach(key => {
      key.addEventListener('click', () => {
        key.style.transform = 'scale(0.95)';
        setTimeout(() => {
          key.style.transform = '';
        }, 100);
      });
    });

    // Naming Setup Modal Functions
    function showNamingModal() {
      const modal = document.getElementById('naming-setup-modal');
      if (modal) {
        modal.style.display = 'block';
        lucide.createIcons();
      }
    }

    function dismissNamingModal() {
      document.getElementById('naming-setup-modal').style.display = 'none';
      // Mark as seen so it doesn't show again
      localStorage.setItem('naming_modal_dismissed', 'true');
    }

    function dismissNamingModalAndProceed() {
      dismissNamingModal();
      // Optionally scroll to "BEGIN CONFIGURATION" button
      document.querySelector('.action-button-primary').scrollIntoView({ behavior: 'smooth', block: 'center' });
    }

    // Check if naming modal should be shown (for existing customers on first login)
    function checkAndShowNamingModal() {
      // Only show if:
      // 1. User hasn't dismissed it before
      // 2. They're on the FTE page
      // 3. They haven't completed setup yet (no saved screen state or saved state is 'fte-callflow')
      const hasSeenModal = localStorage.getItem('naming_modal_dismissed');
      const currentScreen = localStorage.getItem('callflow_current_screen');
      const isOnFTE = !currentScreen || currentScreen === 'fte-callflow';
      
      if (!hasSeenModal && isOnFTE) {
        // Show modal after a brief delay for better UX
        setTimeout(() => {
          showNamingModal();
        }, 500);
      }
    }

    // First Time Experience - Get Started
    function startCallFlowSetup() {
      document.getElementById('fte-callflow').style.display = 'none';
      document.getElementById('setup-timezone').style.display = 'block';
      document.getElementById('footer').style.display = 'none'; // Hide footer in wizard
      document.body.classList.add('has-wizard-actions'); // Move help button up
      saveCurrentScreen('setup-timezone');
      window.scrollTo(0, 0);
      lucide.createIcons();
    }

    // Reset to First-Time Experience (FTE)
    function resetToFTE() {
      // Hide completed callflow
      document.getElementById('main-callflow-content').style.display = 'none';
      
      // Hide all wizard screens
      document.getElementById('setup-timezone').style.display = 'none';
      document.getElementById('setup-openhours').style.display = 'none';
      document.getElementById('setup-holidays').style.display = 'none';
      document.getElementById('setup-routing').style.display = 'none';
      document.getElementById('setup-routing-closed').style.display = 'none';
      document.getElementById('setup-cfnr').style.display = 'none';
      document.getElementById('setup-google-ai').style.display = 'none';
      document.getElementById('setup-keypad').style.display = 'none';
      document.getElementById('setup-greeting').style.display = 'none';
      document.getElementById('ai-settings').style.display = 'none';
      
      // Show FTE screen
      document.getElementById('fte-callflow').style.display = 'block';
      
      // Update demo bar (show FTE control)
      document.getElementById('demo-fte-control').style.display = 'flex';
      document.getElementById('demo-completed-control').style.display = 'none';
      
      // Clear saved state so it doesn't restore
      localStorage.removeItem('callflow_current_screen');
      localStorage.removeItem('callflow_context');
      
      // Show footer
      document.getElementById('footer').style.display = 'block';
      document.body.classList.remove('has-wizard-actions');
      
      // Scroll to top
      window.scrollTo(0, 0);
      
      // Reinitialize icons
      lucide.createIcons();
    }

    // Skip to Completed Callflow (from FTE)
    function skipToCompleted() {
      // Hide FTE screen
      document.getElementById('fte-callflow').style.display = 'none';
      
      // Hide all wizard screens
      document.getElementById('setup-timezone').style.display = 'none';
      document.getElementById('setup-openhours').style.display = 'none';
      document.getElementById('setup-holidays').style.display = 'none';
      document.getElementById('setup-routing').style.display = 'none';
      document.getElementById('setup-routing-closed').style.display = 'none';
      document.getElementById('setup-cfnr').style.display = 'none';
      document.getElementById('setup-google-ai').style.display = 'none';
      document.getElementById('setup-keypad').style.display = 'none';
      document.getElementById('setup-greeting').style.display = 'none';
      document.getElementById('ai-settings').style.display = 'none';
      
      // Show completed callflow
      document.getElementById('main-callflow-content').style.display = 'block';
      
      // Update demo bar (show completed control)
      document.getElementById('demo-fte-control').style.display = 'none';
      document.getElementById('demo-completed-control').style.display = 'flex';
      
      // Save completed state so it persists
      localStorage.setItem('callflow_current_screen', 'main-callflow-content');
      localStorage.setItem('callflow_context', JSON.stringify({}));
      
      // Show footer
      document.getElementById('footer').style.display = 'block';
      document.body.classList.remove('has-wizard-actions');
      
      // Scroll to top
      window.scrollTo(0, 0);
      
      // Reinitialize icons
      lucide.createIcons();
    }

    // Save timezone and continue
    function saveTimezoneAndNext() {
      // TODO: Save timezone selection
      document.getElementById('setup-timezone').style.display = 'none';
      document.getElementById('setup-openhours').style.display = 'block';
      saveCurrentScreen('setup-openhours');
      // Scroll to top when navigating to next step
      window.scrollTo(0, 0);
      lucide.createIcons();
    }

    // Go back to timezone from open hours
    function backToTimezone() {
      document.getElementById('setup-openhours').style.display = 'none';
      document.getElementById('setup-timezone').style.display = 'block';
      // Scroll to top when navigating back
      window.scrollTo(0, 0);
      lucide.createIcons();
    }

    // Save open hours and continue
    function saveOpenHoursAndNext() {
      // TODO: Save open hours
      document.getElementById('setup-openhours').style.display = 'none';
      document.getElementById('setup-holidays').style.display = 'block';
      saveCurrentScreen('setup-holidays');
      window.scrollTo(0, 0);
      lucide.createIcons();
    }

    // Toggle day open/closed
    function toggleDay(dayId) {
      const toggle = document.getElementById('toggle-' + dayId);
      const badge = document.getElementById('badge-' + dayId);
      const timeInputs = document.getElementById('times-' + dayId);
      
      if (toggle.checked) {
        badge.textContent = 'OPEN';
        badge.style.background = 'rgb(13, 98, 255)';
        badge.style.color = 'white';
        timeInputs.style.display = 'flex';
      } else {
        badge.textContent = 'CLOSED';
        badge.style.background = 'rgb(241, 242, 246)';
        badge.style.color = 'rgb(112, 113, 125)';
        timeInputs.style.display = 'none';
      }
    }

    // Navigate between tabs
    function navigateToTab(tab) {
      // Hide all screens
      document.getElementById('setup-timezone').style.display = 'none';
      document.getElementById('setup-openhours').style.display = 'none';
      document.getElementById('setup-holidays').style.display = 'none';
      
      // Show selected screen
      if (tab === 'timezone') {
        document.getElementById('setup-timezone').style.display = 'block';
      } else if (tab === 'openhours') {
        document.getElementById('setup-openhours').style.display = 'block';
      } else if (tab === 'holidays') {
        document.getElementById('setup-holidays').style.display = 'block';
      }
      
      // Scroll to top when navigating
      window.scrollTo(0, 0);
      
      // Reinitialize icons
      lucide.createIcons();
    }

    // Go back to open hours from holidays
    function backToOpenHours() {
      document.getElementById('setup-holidays').style.display = 'none';
      document.getElementById('setup-openhours').style.display = 'block';
      window.scrollTo(0, 0);
      lucide.createIcons();
    }

    // Save holidays and continue to routing
    function saveHolidaysAndComplete() {
      // TODO: Save holiday selections
      document.getElementById('setup-holidays').style.display = 'none';
      document.getElementById('setup-routing').style.display = 'block';
      saveCurrentScreen('setup-routing');
      window.scrollTo(0, 0);
      lucide.createIcons();
    }

    // Go back to holidays from routing
    function backToHolidays() {
      document.getElementById('setup-routing').style.display = 'none';
      document.getElementById('setup-holidays').style.display = 'block';
      window.scrollTo(0, 0);
      lucide.createIcons();
    }

    // Save routing and go to closed hours routing
    function saveRoutingAndNext() {
      document.getElementById('setup-routing').style.display = 'none';
      document.getElementById('setup-routing-closed').style.display = 'block';
      saveCurrentScreen('setup-routing-closed');
      window.scrollTo(0, 0);
      lucide.createIcons();
    }

    // Go back to open hours routing from closed hours routing
    function backToRouting() {
      document.getElementById('setup-routing-closed').style.display = 'none';
      document.getElementById('setup-routing').style.display = 'block';
      window.scrollTo(0, 0);
      lucide.createIcons();
    }

    // Save routing closed and proceed to CFNR
    function saveRoutingClosedAndNext() {
      document.getElementById('setup-routing-closed').style.display = 'none';
      document.getElementById('setup-cfnr').style.display = 'block';
      saveCurrentScreen('setup-cfnr');
      window.scrollTo(0, 0);
      lucide.createIcons();
    }

    // Go back from CFNR to routing-closed
    function backToCFNRFromRouting() {
      document.getElementById('setup-cfnr').style.display = 'none';
      document.getElementById('setup-routing-closed').style.display = 'block';
      window.scrollTo(0, 0);
      lucide.createIcons();
    }

    // Save CFNR and proceed to Google Virtual Assistant configuration
    function saveCFNRAndNext() {
      // TODO: Save CFNR selection
      document.getElementById('setup-cfnr').style.display = 'none';
      document.getElementById('setup-google-ai').style.display = 'block';
      saveCurrentScreen('setup-google-ai');
      window.scrollTo(0, 0);
      lucide.createIcons();
    }

    // Navigate to a specific step in the wizard (for clickable completed steps)
    function navigateToStep(stepId) {
      // Hide all wizard screens
      document.getElementById('setup-timezone').style.display = 'none';
      document.getElementById('setup-openhours').style.display = 'none';
      document.getElementById('setup-holidays').style.display = 'none';
      document.getElementById('setup-routing').style.display = 'none';
      document.getElementById('setup-routing-closed').style.display = 'none';
      document.getElementById('setup-cfnr').style.display = 'none';
      document.getElementById('setup-google-ai').style.display = 'none';
      document.getElementById('setup-keypad').style.display = 'none';
      document.getElementById('setup-greeting').style.display = 'none';
      
      // Show the target step
      document.getElementById(stepId).style.display = 'block';
      saveCurrentScreen(stepId);
      window.scrollTo(0, 0);
      lucide.createIcons();
    }

    // Go back from Google Virtual Assistant to CFNR
    function backToGoogleAIFromCFNR() {
      document.getElementById('setup-google-ai').style.display = 'none';
      document.getElementById('setup-cfnr').style.display = 'block';
      window.scrollTo(0, 0);
      lucide.createIcons();
    }

    // Complete wizard from Google Virtual Assistant step
    function completeWizardFromGoogleAI() {
      // Hide wizard screens
      document.getElementById('setup-google-ai').style.display = 'none';
      
      // Show completed callflow
      document.getElementById('main-callflow-content').style.display = 'block';
      document.getElementById('footer').style.display = 'block';
      document.body.classList.remove('has-wizard-actions');
      
      // Update demo bar
      document.getElementById('demo-fte-control').style.display = 'none';
      document.getElementById('demo-completed-control').style.display = 'flex';
      
      saveCurrentScreen('main-callflow-content');
      window.scrollTo(0, 0);
      lucide.createIcons();
    }

    // Launch Google Virtual Assistant configuration (opens in new tab)
    function launchGoogleAIConfig() {
      window.open('https://google-ai-config-placeholder.com', '_blank');
    }

    // CFNR Phone Number Formatting
    function formatPhoneNumberInput(input) {
      // Get the current value and remove all non-digit characters
      let value = input.value.replace(/\D/g, '');
      let formattedValue = '';
      
      // Format as (XXX) XXX-XXXX
      if (value.length > 0) {
        if (value.length <= 3) {
          formattedValue = '(' + value;
        } else if (value.length <= 6) {
          formattedValue = '(' + value.slice(0, 3) + ') ' + value.slice(3);
        } else if (value.length <= 10) {
          formattedValue = '(' + value.slice(0, 3) + ') ' + value.slice(3, 6) + '-' + value.slice(6);
        } else {
          // Handle extension (more than 10 digits)
          formattedValue = '(' + value.slice(0, 3) + ') ' + value.slice(3, 6) + '-' + value.slice(6, 10) + ' Ext. ' + value.slice(10);
        }
      }
      
      // Update the input value
      input.value = formattedValue;
    }

    // CFNR Searchable Dropdown Functions
    function showCFNRDropdown() {
      const dropdown = document.getElementById('cfnr-dropdown-panel');
      dropdown.style.display = 'block';
      lucide.createIcons();
    }

    function toggleCFNRDropdown() {
      const dropdown = document.getElementById('cfnr-dropdown-panel');
      dropdown.style.display = dropdown.style.display === 'none' ? 'block' : 'none';
      lucide.createIcons();
    }

    function hideCFNRDropdown() {
      const dropdown = document.getElementById('cfnr-dropdown-panel');
      dropdown.style.display = 'none';
    }

    function selectCFNRNumber(element) {
      const value = element.getAttribute('data-value');
      const label = element.getAttribute('data-label');
      const input = document.getElementById('cfnr-phone-number');
      const preview = document.getElementById('cfnr-selection-preview');
      const previewText = document.getElementById('cfnr-preview-text');
      
      // Set the input value
      input.value = value;
      
      // Show preview
      preview.style.display = 'block';
      previewText.textContent = `${label} - ${value}`;
      
      // Hide dropdown
      hideCFNRDropdown();
      
      // Reinitialize icons
      lucide.createIcons();
    }

    function filterCFNRNumbers() {
      const mainInput = document.getElementById('cfnr-phone-number');
      const dropdownSearch = document.getElementById('cfnr-dropdown-search');
      const searchTerm = (dropdownSearch?.value || mainInput.value).toLowerCase();
      const items = document.querySelectorAll('.cfnr-number-item');
      const categories = document.querySelectorAll('.cfnr-category');
      
      // Update preview for manual entry
      const preview = document.getElementById('cfnr-selection-preview');
      const previewText = document.getElementById('cfnr-preview-text');
      
      if (mainInput.value.trim() !== '' && !dropdownSearch?.value) {
        preview.style.display = 'block';
        previewText.textContent = mainInput.value;
      } else if (mainInput.value.trim() === '') {
        preview.style.display = 'none';
      }
      
      // Filter items
      categories.forEach(category => {
        let hasVisibleItems = false;
        const categoryItems = category.querySelectorAll('.cfnr-number-item');
        
        categoryItems.forEach(item => {
          const label = item.getAttribute('data-label').toLowerCase();
          const value = item.getAttribute('data-value').toLowerCase();
          
          if (label.includes(searchTerm) || value.includes(searchTerm)) {
            item.style.display = 'block';
            hasVisibleItems = true;
          } else {
            item.style.display = 'none';
          }
        });
        
        // Show/hide category based on whether it has visible items
        category.style.display = hasVisibleItems ? 'block' : 'none';
      });
    }

    // Close dropdown when clicking outside
    document.addEventListener('click', function(event) {
      const dropdown = document.getElementById('cfnr-dropdown-panel');
      const input = document.getElementById('cfnr-phone-number');
      const dropdownSearch = document.getElementById('cfnr-dropdown-search');
      
      if (dropdown && input && 
          !dropdown.contains(event.target) && 
          event.target !== input &&
          event.target !== dropdownSearch) {
        hideCFNRDropdown();
      }
    });

    // Complete the call flow setup
    function completeCallFlowSetup() {
      alert('Call Flow setup completed! This would save all settings and return to the main call flow screen.');
      // In a real app, this would save all the settings and navigate back
      document.getElementById('setup-routing-closed').style.display = 'none';
      document.getElementById('main-callflow-content').style.display = 'block';
      document.getElementById('footer').style.display = 'block';
      document.body.classList.remove('has-wizard-actions'); // Reset help button position
      saveCurrentScreen('main-callflow-content');
      window.scrollTo(0, 0);
      lucide.createIcons();
    }

    // Save and exit (can be called from any wizard step)
    function saveAndExit() {
      if (confirm('Save your progress and exit the wizard?')) {
        alert('Progress saved! Returning to main screen.');
        // Hide all wizard screens
        document.getElementById('setup-timezone').style.display = 'none';
        document.getElementById('setup-openhours').style.display = 'none';
        document.getElementById('setup-holidays').style.display = 'none';
        document.getElementById('setup-routing').style.display = 'none';
        document.getElementById('setup-routing-closed').style.display = 'none';
        document.getElementById('setup-keypad').style.display = 'none';
        document.getElementById('setup-greeting').style.display = 'none';
        document.getElementById('ai-settings').style.display = 'none';
        // Show main content and footer
        document.getElementById('main-callflow-content').style.display = 'block';
        document.getElementById('footer').style.display = 'block';
        document.body.classList.remove('has-wizard-actions'); // Reset help button position
        saveCurrentScreen('main-callflow-content');
        window.scrollTo(0, 0);
        lucide.createIcons();
      }
    }

    // Function to update stepper based on context
    function updateStepper(elementId, context) {
      const stepperEl = document.getElementById(elementId);
      if (!stepperEl) return;

      let stepperHTML = '';
      
      if (context === 'open') {
        // For Open Hours: Step 1 completed, Step 2 active, Steps 3-5 inactive
        stepperHTML = `
          <!-- Step 1: Schedules (Completed - Clickable) -->
          <div onclick="navigateToStep('setup-holidays')" style="flex: 1; display: flex; align-items: center; gap: 0.5rem; position: relative; cursor: pointer; transition: opacity 0.15s;" onmouseover="this.style.opacity='0.7'" onmouseout="this.style.opacity='1'" title="Go back to Schedules">
            <div style="width: 32px; height: 32px; border-radius: 50%; background: rgb(34, 197, 94); color: white; display: flex; align-items: center; justify-content: center; font-size: 0.875rem; font-weight: 600; z-index: 2; position: relative;">
              <i data-lucide="check" style="width: 18px; height: 18px;"></i>
            </div>
            <span style="font-size: 0.875rem; font-weight: 500; color: rgb(89, 90, 105); position: relative; z-index: 2; background: white; padding-left: 0.5rem; padding-right: 0.5rem;">Schedules</span>
            <div style="position: absolute; left: 16px; top: 15px; height: 2px; background: rgb(34, 197, 94); width: 100%; z-index: 0;"></div>
          </div>

          <!-- Step 2: Open Hours (Active) -->
          <div style="flex: 1; display: flex; align-items: center; gap: 0.5rem; position: relative;">
            <div style="width: 32px; height: 32px; border-radius: 50%; background: rgb(13, 98, 255); color: white; display: flex; align-items: center; justify-content: center; font-size: 0.875rem; font-weight: 600; z-index: 2; position: relative;">2</div>
            <span style="font-size: 0.875rem; font-weight: 600; color: rgb(13, 98, 255); position: relative; z-index: 2; background: white; padding-left: 0.5rem; padding-right: 0.5rem;">Open Hours</span>
            <div style="position: absolute; left: 16px; top: 15px; height: 2px; background: rgb(241, 242, 246); width: 100%; z-index: 0;"></div>
          </div>

          <!-- Step 3: Closed Hours (Inactive) -->
          <div style="flex: 1; display: flex; align-items: center; gap: 0.5rem; position: relative;">
            <div style="width: 32px; height: 32px; border-radius: 50%; background: rgb(249, 249, 250); border: 2px solid rgb(221, 221, 226); color: rgb(180, 181, 187); display: flex; align-items: center; justify-content: center; font-size: 0.875rem; font-weight: 600; z-index: 2; position: relative;">3</div>
            <span style="font-size: 0.875rem; font-weight: 500; color: rgb(180, 181, 187); position: relative; z-index: 2; background: white; padding-left: 0.5rem; padding-right: 0.5rem;">Closed Hours</span>
            <div style="position: absolute; left: 16px; top: 15px; height: 2px; background: rgb(241, 242, 246); width: 100%; z-index: 0;"></div>
          </div>

          <!-- Step 4: Failover (Inactive) -->
          <div style="flex: 1; display: flex; align-items: center; gap: 0.5rem; position: relative;">
            <div style="width: 32px; height: 32px; border-radius: 50%; background: rgb(249, 249, 250); border: 2px solid rgb(221, 221, 226); color: rgb(180, 181, 187); display: flex; align-items: center; justify-content: center; font-size: 0.875rem; font-weight: 600; z-index: 2; position: relative;">4</div>
            <span style="font-size: 0.875rem; font-weight: 500; color: rgb(180, 181, 187); position: relative; z-index: 2; background: white; padding-left: 0.5rem; padding-right: 0.5rem;">Failover</span>
            <div style="position: absolute; left: 16px; top: 15px; height: 2px; background: rgb(241, 242, 246); width: 100%; z-index: 0;"></div>
          </div>

          <!-- Step 5: Google Virtual Assistant (Inactive) -->
          <div style="flex: 1; display: flex; align-items: center; gap: 0.5rem; position: relative;">
            <div style="width: 32px; height: 32px; border-radius: 50%; background: rgb(249, 249, 250); border: 2px solid rgb(221, 221, 226); color: rgb(180, 181, 187); display: flex; align-items: center; justify-content: center; font-size: 0.875rem; font-weight: 600; z-index: 2; position: relative;">5</div>
            <span style="font-size: 0.875rem; font-weight: 500; color: rgb(180, 181, 187); position: relative; z-index: 2; background: white; padding-left: 0.5rem; padding-right: 0.5rem;">Google Virtual Assistant</span>
          </div>
        `;
      } else {
        // For Closed Hours: Step 1 & 2 completed, Step 3 active, Steps 4-5 inactive
        stepperHTML = `
          <!-- Step 1: Schedules (Completed - Clickable) -->
          <div onclick="navigateToStep('setup-holidays')" style="flex: 1; display: flex; align-items: center; gap: 0.5rem; position: relative; cursor: pointer; transition: opacity 0.15s;" onmouseover="this.style.opacity='0.7'" onmouseout="this.style.opacity='1'" title="Go back to Schedules">
            <div style="width: 32px; height: 32px; border-radius: 50%; background: rgb(34, 197, 94); color: white; display: flex; align-items: center; justify-content: center; font-size: 0.875rem; font-weight: 600; z-index: 2; position: relative;">
              <i data-lucide="check" style="width: 18px; height: 18px;"></i>
            </div>
            <span style="font-size: 0.875rem; font-weight: 500; color: rgb(89, 90, 105); position: relative; z-index: 2; background: white; padding-left: 0.5rem; padding-right: 0.5rem;">Schedules</span>
            <div style="position: absolute; left: 16px; top: 15px; height: 2px; background: rgb(34, 197, 94); width: 100%; z-index: 0;"></div>
          </div>

          <!-- Step 2: Open Hours (Completed - Clickable) -->
          <div onclick="navigateToStep('setup-routing')" style="flex: 1; display: flex; align-items: center; gap: 0.5rem; position: relative; cursor: pointer; transition: opacity 0.15s;" onmouseover="this.style.opacity='0.7'" onmouseout="this.style.opacity='1'" title="Go back to Open Hours">
            <div style="width: 32px; height: 32px; border-radius: 50%; background: rgb(34, 197, 94); color: white; display: flex; align-items: center; justify-content: center; font-size: 0.875rem; font-weight: 600; z-index: 2; position: relative;">
              <i data-lucide="check" style="width: 18px; height: 18px;"></i>
            </div>
            <span style="font-size: 0.875rem; font-weight: 500; color: rgb(89, 90, 105); position: relative; z-index: 2; background: white; padding-left: 0.5rem; padding-right: 0.5rem;">Open Hours</span>
            <div style="position: absolute; left: 16px; top: 15px; height: 2px; background: rgb(34, 197, 94); width: 100%; z-index: 0;"></div>
          </div>

          <!-- Step 3: Closed Hours (Active) -->
          <div style="flex: 1; display: flex; align-items: center; gap: 0.5rem; position: relative;">
            <div style="width: 32px; height: 32px; border-radius: 50%; background: rgb(13, 98, 255); color: white; display: flex; align-items: center; justify-content: center; font-size: 0.875rem; font-weight: 600; z-index: 2; position: relative;">3</div>
            <span style="font-size: 0.875rem; font-weight: 600; color: rgb(13, 98, 255); position: relative; z-index: 2; background: white; padding-left: 0.5rem; padding-right: 0.5rem;">Closed Hours</span>
            <div style="position: absolute; left: 16px; top: 15px; height: 2px; background: rgb(241, 242, 246); width: 100%; z-index: 0;"></div>
          </div>

          <!-- Step 4: Failover (Inactive) -->
          <div style="flex: 1; display: flex; align-items: center; gap: 0.5rem; position: relative;">
            <div style="width: 32px; height: 32px; border-radius: 50%; background: rgb(249, 249, 250); border: 2px solid rgb(221, 221, 226); color: rgb(180, 181, 187); display: flex; align-items: center; justify-content: center; font-size: 0.875rem; font-weight: 600; z-index: 2; position: relative;">4</div>
            <span style="font-size: 0.875rem; font-weight: 500; color: rgb(180, 181, 187); position: relative; z-index: 2; background: white; padding-left: 0.5rem; padding-right: 0.5rem;">Failover</span>
            <div style="position: absolute; left: 16px; top: 15px; height: 2px; background: rgb(241, 242, 246); width: 100%; z-index: 0;"></div>
          </div>

          <!-- Step 5: Google Virtual Assistant (Inactive) -->
          <div style="flex: 1; display: flex; align-items: center; gap: 0.5rem; position: relative;">
            <div style="width: 32px; height: 32px; border-radius: 50%; background: rgb(249, 249, 250); border: 2px solid rgb(221, 221, 226); color: rgb(180, 181, 187); display: flex; align-items: center; justify-content: center; font-size: 0.875rem; font-weight: 600; z-index: 2; position: relative;">5</div>
            <span style="font-size: 0.875rem; font-weight: 500; color: rgb(180, 181, 187); position: relative; z-index: 2; background: white; padding-left: 0.5rem; padding-right: 0.5rem;">Google Virtual Assistant</span>
          </div>
        `;
      }

      stepperEl.innerHTML = stepperHTML;
    }

    // Navigate to keypad configuration from routing screen
    function goToKeypadConfig(context) {
      keypadContext = context;
      if (context === 'open') {
        document.getElementById('setup-routing').style.display = 'none';
      } else {
        document.getElementById('setup-routing-closed').style.display = 'none';
      }
      document.getElementById('setup-keypad').style.display = 'block';
      updateStepper('keypad-stepper', context);
      saveCurrentScreen('setup-keypad', {keypadContext: context});
      window.scrollTo(0, 0);
      lucide.createIcons();
    }

    // Go back from keypad configuration to routing screen
    function backFromKeypad() {
      document.getElementById('setup-keypad').style.display = 'none';
      if (keypadContext === 'open') {
        document.getElementById('setup-routing').style.display = 'block';
      } else {
        document.getElementById('setup-routing-closed').style.display = 'block';
      }
      window.scrollTo(0, 0);
      lucide.createIcons();
    }

    // Save keypad configuration and go to greeting
    function saveKeypadAndNext() {
      document.getElementById('setup-keypad').style.display = 'none';
      document.getElementById('setup-greeting').style.display = 'block';
      updateStepper('greeting-stepper', keypadContext);
      saveCurrentScreen('setup-greeting', {keypadContext: keypadContext});
      window.scrollTo(0, 0);
      lucide.createIcons();
    }

    // Go back from greeting to keypad configuration
    function backFromGreeting() {
      document.getElementById('setup-greeting').style.display = 'none';
      document.getElementById('setup-keypad').style.display = 'block';
      updateStepper('keypad-stepper', keypadContext);
      window.scrollTo(0, 0);
      lucide.createIcons();
    }

    // Save greeting and advance to next step
    function saveGreetingAndComplete() {
      document.getElementById('setup-greeting').style.display = 'none';
      
      if (keypadContext === 'open') {
        // After completing Open Hours routing, go to Closed Hours routing
        document.getElementById('setup-routing-closed').style.display = 'block';
        saveCurrentScreen('setup-routing-closed');
      } else {
        // After completing Closed Hours routing, go to CFNR configuration
        document.getElementById('setup-cfnr').style.display = 'block';
        saveCurrentScreen('setup-cfnr');
      }
      
      window.scrollTo(0, 0);
      lucide.createIcons();
    }

    // Toggle all holidays
    function toggleAllHolidays() {
      const selectAll = document.getElementById('select-all-holidays');
      const checkboxes = document.querySelectorAll('.holiday-checkbox');
      
      checkboxes.forEach(checkbox => {
        checkbox.checked = selectAll.checked;
      });
    }

    // Toggle Open 24/7
    function toggleOpen247() {
      const checkbox = document.getElementById('open-24-7');
      const days = ['monday', 'tuesday', 'wednesday', 'thursday', 'friday', 'saturday', 'sunday'];
      
      days.forEach(day => {
        const toggle = document.getElementById('toggle-' + day);
        const badge = document.getElementById('badge-' + day);
        const timeInputs = document.getElementById('times-' + day);
        
        if (checkbox.checked) {
          // Enable all days and set to 24 hours
          toggle.checked = true;
          badge.textContent = 'OPEN';
          badge.style.background = 'rgb(13, 98, 255)';
          badge.style.color = 'white';
          timeInputs.style.display = 'flex';
          
          // Replace time inputs with "24 hours" display
          timeInputs.innerHTML = '<input type="text" value="24 hours" readonly style="padding: 0.5rem 12px; border: 1px solid rgb(221, 221, 226); border-radius: 0.25rem; font-size: 0.875rem; background: rgb(252, 252, 252); color: rgb(112, 113, 125); cursor: not-allowed;"><button style="background: none; border: none; cursor: pointer; padding: 0.25rem;" title="Copy to other days"><i data-lucide="copy" style="width: 18px; height: 18px; color: rgb(112, 113, 125);"></i></button>';
          
          // Disable the toggle so users can't change individual days
          toggle.disabled = true;
        } else {
          // Reset to normal state
          toggle.disabled = false;
          
          // Reset time inputs to standard format
          if (day === 'monday' || day === 'tuesday') {
            timeInputs.innerHTML = '<input type="time" value="09:00" style="padding: 0.5rem 12px; border: 1px solid rgb(221, 221, 226); border-radius: 0.25rem; font-size: 0.875rem; cursor: pointer; background: white;"><span style="color: rgb(112, 113, 125);">—</span><input type="time" value="18:00" style="padding: 0.5rem 12px; border: 1px solid rgb(221, 221, 226); border-radius: 0.25rem; font-size: 0.875rem; cursor: pointer; background: white;"><button style="background: none; border: none; cursor: pointer; padding: 0.25rem;" title="Copy to other days"><i data-lucide="copy" style="width: 18px; height: 18px; color: rgb(112, 113, 125);"></i></button>';
          } else if (day === 'thursday' || day === 'saturday') {
            timeInputs.innerHTML = '<input type="text" value="24 hours" readonly style="padding: 0.5rem 12px; border: 1px solid rgb(221, 221, 226); border-radius: 0.25rem; font-size: 0.875rem; background: rgb(252, 252, 252); color: rgb(112, 113, 125);"><button style="background: none; border: none; cursor: pointer; padding: 0.25rem;" title="Copy to other days"><i data-lucide="copy" style="width: 18px; height: 18px; color: rgb(112, 113, 125);"></i></button>';
          } else {
            // Wednesday, Friday, Sunday - turn off
            toggle.checked = false;
            badge.textContent = 'CLOSED';
            badge.style.background = 'rgb(241, 242, 246)';
            badge.style.color = 'rgb(112, 113, 125)';
            timeInputs.style.display = 'none';
          }
        }
      });
      
      // Reinitialize icons
      lucide.createIcons();
    }

    // Go back to FTE
    function backToFTE() {
      document.getElementById('setup-timezone').style.display = 'none';
      document.getElementById('setup-openhours').style.display = 'none';
      document.getElementById('setup-holidays').style.display = 'none';
      document.getElementById('setup-routing').style.display = 'none';
      document.getElementById('setup-routing-closed').style.display = 'none';
      document.getElementById('setup-cfnr').style.display = 'none';
      document.getElementById('setup-google-ai').style.display = 'none';
      document.getElementById('setup-keypad').style.display = 'none';
      document.getElementById('setup-greeting').style.display = 'none';
      document.getElementById('fte-callflow').style.display = 'block';
      document.getElementById('footer').style.display = 'block'; // Show footer when exiting wizard
      document.body.classList.remove('has-wizard-actions'); // Reset help button position
      saveCurrentScreen('fte-callflow');
      window.scrollTo(0, 0);
      lucide.createIcons();
    }

    // Jump to specific workflow steps from landing page
    function jumpToSchedules() {
      document.getElementById('main-callflow-content').style.display = 'none';
      document.getElementById('footer').style.display = 'none';
      document.getElementById('setup-timezone').style.display = 'block';
      document.body.classList.add('has-wizard-actions');
      saveCurrentScreen('setup-timezone');
      window.scrollTo(0, 0);
      lucide.createIcons();
    }

    function jumpToHolidays() {
      document.getElementById('main-callflow-content').style.display = 'none';
      document.getElementById('footer').style.display = 'none';
      document.getElementById('setup-holidays').style.display = 'block';
      document.body.classList.add('has-wizard-actions');
      saveCurrentScreen('setup-holidays');
      window.scrollTo(0, 0);
      lucide.createIcons();
    }

    function jumpToOpenKeypad() {
      keypadContext = 'open';
      document.getElementById('main-callflow-content').style.display = 'none';
      document.getElementById('footer').style.display = 'none';
      document.getElementById('setup-keypad').style.display = 'block';
      updateStepper('keypad-stepper', 'open');
      document.body.classList.add('has-wizard-actions');
      saveCurrentScreen('setup-keypad', {keypadContext: 'open'});
      window.scrollTo(0, 0);
      lucide.createIcons();
    }

    function jumpToOpenGreeting() {
      keypadContext = 'open';
      document.getElementById('main-callflow-content').style.display = 'none';
      document.getElementById('footer').style.display = 'none';
      document.getElementById('setup-greeting').style.display = 'block';
      updateStepper('greeting-stepper', 'open');
      document.body.classList.add('has-wizard-actions');
      saveCurrentScreen('setup-greeting', {keypadContext: 'open'});
      window.scrollTo(0, 0);
      lucide.createIcons();
    }

    function jumpToClosedRouting() {
      document.getElementById('main-callflow-content').style.display = 'none';
      document.getElementById('footer').style.display = 'none';
      document.getElementById('setup-routing-closed').style.display = 'block';
      document.body.classList.add('has-wizard-actions');
      saveCurrentScreen('setup-routing-closed');
      window.scrollTo(0, 0);
      lucide.createIcons();
    }

    function jumpToClosedGreeting() {
      keypadContext = 'closed';
      document.getElementById('main-callflow-content').style.display = 'none';
      document.getElementById('footer').style.display = 'none';
      document.getElementById('setup-greeting').style.display = 'block';
      updateStepper('greeting-stepper', 'closed');
      document.body.classList.add('has-wizard-actions');
      saveCurrentScreen('setup-greeting', {keypadContext: 'closed'});
      window.scrollTo(0, 0);
      lucide.createIcons();
    }

    // AI Settings State Management
    let aiSettings = {
      aiEnabled: true,
      emailNotifications: true,
      userEmail: 'really_changeds@example.com'
    };

    // Load settings from localStorage
    function loadAISettings() {
      const saved = localStorage.getItem('ai_settings');
      if (saved) {
        try {
          aiSettings = JSON.parse(saved);
        } catch (e) {
          console.error('Error loading AI settings:', e);
        }
      }
      return aiSettings;
    }

    // Save settings to localStorage
    function saveAISettings() {
      localStorage.setItem('ai_settings', JSON.stringify(aiSettings));
    }

    // Open Add Minutes page
    function openAddMinutesPage() {
      // Store previous page for return navigation
      const currentPage = document.querySelector('[style*="display: block"], [style*="display: flex"]');
      if (currentPage && currentPage.id) {
        sessionStorage.setItem('previousPage', currentPage.id);
      }
      
      // Hide all pages
      document.querySelectorAll('.page').forEach(p => p.classList.remove('active'));
      
      // Hide other screens
      document.getElementById('fte-callflow').style.display = 'none';
      document.getElementById('main-callflow-content').style.display = 'none';
      document.getElementById('setup-timezone').style.display = 'none';
      document.getElementById('setup-openhours').style.display = 'none';
      document.getElementById('setup-holidays').style.display = 'none';
      document.getElementById('setup-routing').style.display = 'none';
      document.getElementById('setup-routing-closed').style.display = 'none';
      document.getElementById('setup-cfnr').style.display = 'none';
      document.getElementById('setup-google-ai').style.display = 'none';
      document.getElementById('ai-settings').style.display = 'none';
      
      // Show Add Minutes page
      document.getElementById('page-add-minutes').style.display = 'block';
      
      // Re-initialize icons
      lucide.createIcons();
    }
    
    // Close Add Minutes page and return to previous page
    function closeAddMinutesPage() {
      // Hide Add Minutes page
      document.getElementById('page-add-minutes').style.display = 'none';
      
      // Try to return to previous page
      const previousPage = sessionStorage.getItem('previousPage');
      if (previousPage === 'page-site') {
        showPage('page-site');
      } else {
        // Default to showing main callflow
        showMainBusinessNumberCallflow();
      }
    }

    // Toggle backup call flow section collapse/expand
    function toggleBackupSection() {
      const backupContent = document.getElementById('backup-content');
      const chevron = document.getElementById('backup-chevron');
      const section = document.getElementById('backup-callflow-section');
      
      if (backupContent.style.display === 'none' || backupContent.style.display === '') {
        // Expand
        backupContent.style.display = 'block';
        chevron.style.transform = 'rotate(90deg)';
      } else {
        // Collapse
        backupContent.style.display = 'none';
        chevron.style.transform = 'rotate(0deg)';
      }
      
      // Reinitialize icons
      lucide.createIcons();
    }

    // Scroll to and expand backup configuration
    function scrollToBackupConfig() {
      const backupSection = document.getElementById('backup-callflow-section');
      const backupContent = document.getElementById('backup-content');
      const chevron = document.getElementById('backup-chevron');
      
      // Expand if collapsed
      if (backupContent.style.display === 'none' || backupContent.style.display === '') {
        backupContent.style.display = 'block';
        chevron.style.transform = 'rotate(90deg)';
        lucide.createIcons();
      }
      
      // Smooth scroll to section
      backupSection.scrollIntoView({ behavior: 'smooth', block: 'start' });
    }

    // Handle AI primary toggle switch
    function handleAIPrimaryToggle() {
      const toggle = document.getElementById('ai-primary-toggle');
      const statusBadge = document.getElementById('ai-status-badge');
      const toggleLabel = document.getElementById('ai-toggle-label');
      const alertBanner = document.getElementById('ai-alert-banner');
      const backupStatusIndicator = document.getElementById('backup-status-indicator');
      const backupSection = document.getElementById('backup-callflow-section');
      const backupContent = document.getElementById('backup-content');
      const chevron = document.getElementById('backup-chevron');
      
      if (toggle.checked) {
        // AI is ON
        statusBadge.innerHTML = `
          <div style="width: 8px; height: 8px; background: rgb(34, 197, 94); border-radius: 50%; box-shadow: 0 0 0 2px rgba(34, 197, 94, 0.2);"></div>
          <span style="font-size: 0.875rem; font-weight: 500; color: rgb(34, 197, 94);">Active</span>
          <span style="font-size: 0.875rem; color: rgb(112, 113, 125);">• AI handling all incoming calls</span>
        `;
        toggleLabel.textContent = 'Enabled';
        alertBanner.style.display = 'none';
        backupStatusIndicator.style.display = 'none';
        backupSection.style.border = '1px solid rgb(241, 242, 246)';
        
        // Collapse backup section
        backupContent.style.display = 'none';
        chevron.style.transform = 'rotate(0deg)';
      } else {
        // AI is OFF
        statusBadge.innerHTML = `
          <div style="width: 8px; height: 8px; background: rgb(180, 181, 187); border-radius: 50%; box-shadow: 0 0 0 2px rgba(180, 181, 187, 0.2);"></div>
          <span style="font-size: 0.875rem; font-weight: 500; color: rgb(180, 181, 187);">Inactive</span>
          <span style="font-size: 0.875rem; color: rgb(112, 113, 125);">• Calls routing to backup call flow</span>
        `;
        toggleLabel.textContent = 'Disabled';
        alertBanner.style.display = 'block';
        backupStatusIndicator.style.display = 'flex';
        backupSection.style.border = '2px solid rgb(251, 191, 36)';
        
        // Auto-expand backup section
        backupContent.style.display = 'block';
        chevron.style.transform = 'rotate(90deg)';
      }
      
      // Sync with AI Settings toggle
      const aiSettingsToggle = document.getElementById('ai-assistant-toggle');
      if (aiSettingsToggle) {
        aiSettingsToggle.checked = toggle.checked;
      }
      
      // Reinitialize icons
      lucide.createIcons();
    }

    // Open settings page
    function openAISettings() {
      // Hide all pages
      document.querySelectorAll('.page').forEach(p => p.classList.remove('active'));
      
      // Hide other wizard screens
      document.getElementById('fte-callflow').style.display = 'none';
      document.getElementById('main-callflow-content').style.display = 'none';
      document.getElementById('setup-timezone').style.display = 'none';
      document.getElementById('setup-openhours').style.display = 'none';
      document.getElementById('setup-holidays').style.display = 'none';
      document.getElementById('setup-routing').style.display = 'none';
      document.getElementById('setup-routing-closed').style.display = 'none';
      document.getElementById('setup-cfnr').style.display = 'none';
      document.getElementById('setup-google-ai').style.display = 'none';
      document.getElementById('setup-keypad').style.display = 'none';
      document.getElementById('setup-greeting').style.display = 'none';
      
      // Hide demo bar
      document.getElementById('global-demo-bar').style.display = 'none';
      
      // Show settings screen
      document.getElementById('ai-settings').style.display = 'block';
      document.getElementById('footer').style.display = 'none';
      document.body.classList.add('has-wizard-actions');
      
      // Sync toggle state from primary section to settings
      const primaryToggle = document.getElementById('ai-primary-toggle');
      const settingsToggle = document.getElementById('ai-assistant-toggle');
      if (primaryToggle && settingsToggle) {
        settingsToggle.checked = primaryToggle.checked;
      }
      
      // Load current settings into form
      populateSettingsForm();
      
      // Scroll to top
      window.scrollTo(0, 0);
      
      lucide.createIcons();
    }

    // Populate form with current settings
    function populateSettingsForm() {
      loadAISettings();
      document.getElementById('ai-assistant-toggle').checked = aiSettings.aiEnabled;
      document.getElementById('email-notifications-toggle').checked = aiSettings.emailNotifications;
      document.getElementById('user-email').value = aiSettings.userEmail;
    }

    // Save settings and return to landing
    function saveAISettingsAndExit() {
      // Get values from form
      aiSettings.aiEnabled = document.getElementById('ai-assistant-toggle').checked;
      aiSettings.emailNotifications = document.getElementById('email-notifications-toggle').checked;
      aiSettings.userEmail = document.getElementById('user-email').value;
      
      // Validate email if notifications are enabled
      if (aiSettings.emailNotifications) {
        const emailInput = document.getElementById('user-email');
        const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
        if (!emailRegex.test(aiSettings.userEmail)) {
          alert('Please enter a valid email address for notifications.');
          emailInput.focus();
          return;
        }
      }
      
      // Save to localStorage
      saveAISettings();
      
      // Sync toggle state from settings back to primary section
      const settingsToggle = document.getElementById('ai-assistant-toggle');
      const primaryToggle = document.getElementById('ai-primary-toggle');
      if (settingsToggle && primaryToggle) {
        primaryToggle.checked = settingsToggle.checked;
        // Trigger the toggle handler to update UI
        handleAIPrimaryToggle();
      }
      
      // Hide settings page
      document.getElementById('ai-settings').style.display = 'none';
      
      // Navigate to attendants page
      document.querySelectorAll('.sidebar-item').forEach(i => i.classList.remove('active'));
      document.querySelectorAll('.page').forEach(p => p.classList.remove('active'));
      
      // Activate the attendants page
      const attendantsPage = document.getElementById('page-attendants');
      if (attendantsPage) {
        attendantsPage.classList.add('active');
      }
      
      // Highlight the correct sidebar item
      const attendantNavItem = document.querySelector('.sidebar-item[data-page="attendants"]');
      if (attendantNavItem) {
        attendantNavItem.classList.add('active');
      }
      
      // Hide FTE, show finished callflow content
      document.getElementById('fte-callflow').style.display = 'none';
      document.getElementById('main-callflow-content').style.display = 'block';
      
      // Show and update demo bar (show completed control)
      document.getElementById('global-demo-bar').style.display = 'flex';
      document.getElementById('demo-fte-control').style.display = 'none';
      document.getElementById('demo-completed-control').style.display = 'flex';
      
      // Show footer and remove wizard classes
      document.getElementById('footer').style.display = 'block';
      document.body.classList.remove('has-wizard-actions');
      
      // Scroll to top
      window.scrollTo(0, 0);
      
      // Reinitialize icons
      lucide.createIcons();
      
      // Show confirmation (optional)
      console.log('AI Settings saved:', aiSettings);
    }

    // Load settings on page load
    loadAISettings();

    // Demo state management
    let currentDemoState = 'normal'; // 'normal', 'warning', 'critical', 'failover'
    
    function toggleDemoUsageState() {
      // Cycle through states: normal -> warning -> critical -> reminder -> failover -> normal
      if (currentDemoState === 'normal') {
        currentDemoState = 'warning';
      } else if (currentDemoState === 'warning') {
        currentDemoState = 'critical';
      } else if (currentDemoState === 'critical') {
        currentDemoState = 'reminder';
      } else if (currentDemoState === 'reminder') {
        currentDemoState = 'failover';
      } else {
        currentDemoState = 'normal';
      }
      
      // Update global demo bar label
      const usageStateText = document.getElementById('demo-usage-state-text');
      if (usageStateText) {
        if (currentDemoState === 'normal') {
          usageStateText.textContent = 'Normal (49%)';
          usageStateText.style.color = 'rgb(186, 230, 253)';
        } else if (currentDemoState === 'warning') {
          usageStateText.textContent = 'Warning (82%)';
          usageStateText.style.color = 'rgb(254, 240, 138)';
        } else if (currentDemoState === 'critical') {
          usageStateText.textContent = 'Critical (92%)';
          usageStateText.style.color = 'rgb(254, 202, 202)';
        } else if (currentDemoState === 'reminder') {
          usageStateText.textContent = 'Reminder (Setup Pending)';
          usageStateText.style.color = 'rgb(13, 98, 255)';
        } else {
          usageStateText.textContent = 'Failover (100%)';
          usageStateText.style.color = 'rgb(221, 221, 226)';
        }
      }
      
      // Update the display
      updateAIUsageStatus();
    }

    // AI Usage Threshold Monitoring
    function updateAIUsageStatus() {
      // Get usage values based on current demo state
      let used, total, statusLabel;
      
      if (currentDemoState === 'normal') {
        used = 247;
        total = 500;
        statusLabel = 'Normal';
      } else if (currentDemoState === 'warning') {
        used = 410;
        total = 500;
        statusLabel = 'Warning';
      } else if (currentDemoState === 'critical') {
        used = 460;
        total = 500;
        statusLabel = 'Critical';
      } else if (currentDemoState === 'reminder') {
        used = 320;
        total = 500;
        statusLabel = 'Setup reminder';
      } else { // failover
        used = 500;
        total = 500;
        statusLabel = 'Failover Active';
      }
      
      const remaining = total - used;
      const percentageUsed = (used / total) * 100;
      
      // Determine status based on usage
      let status = 'normal';
      let statusColor = 'rgb(13, 98, 255)';
      let bgGradient = 'linear-gradient(135deg, rgb(224, 242, 254) 0%, rgb(186, 230, 253) 100%)';
      let borderColor = 'rgb(125, 211, 252)';
      let alertHTML = '';
      
      if (percentageUsed >= 100) {
        // Failover: 100% used (0 minutes remaining)
        status = 'failover';
        statusColor = 'rgb(112, 113, 125)';
        bgGradient = 'linear-gradient(135deg, rgb(249, 249, 250) 0%, rgb(241, 242, 246) 100%)';
        borderColor = 'rgb(221, 221, 226)';
        alertHTML = `
          <div style="background: white; border-left: 4px solid rgb(112, 113, 125); border-radius: 0.5rem; padding: 0.75rem 16px; margin-bottom: 1rem; display: flex; align-items: start; gap: 0.75rem;">
            <i data-lucide="info" style="width: 20px; height: 20px; color: rgb(112, 113, 125); flex-shrink: 0; margin-top: 0.125rem;"></i>
            <div style="flex: 1;">
              <div style="font-size: 0.8125rem; font-weight: 600; color: rgb(43, 45, 63); margin-bottom: 0.25rem;">Standard Auto-Attendant Active</div>
              <div style="font-size: 0.75rem; color: rgb(89, 90, 105); line-height: 1.5; margin-bottom: 0.5rem;">Your Google Virtual Assistant has used all available minutes. Calls are now being handled by your standard auto-attendant.</div>
              <div style="font-size: 0.75rem; color: rgb(43, 45, 63); font-weight: 600;">Add minutes to reactivate your AI assistant.</div>
            </div>
          </div>
        `;
      } else if (percentageUsed >= 90) {
        // Critical: 90%+ used (50 minutes or less)
        status = 'critical';
        statusColor = 'rgb(220, 38, 38)';
        bgGradient = 'linear-gradient(135deg, rgb(254, 226, 226) 0%, rgb(254, 202, 202) 100%)';
        borderColor = 'rgb(248, 113, 113)';
        alertHTML = `
          <div style="background: white; border-left: 4px solid rgb(220, 38, 38); border-radius: 0.5rem; padding: 0.75rem 16px; margin-bottom: 1rem; display: flex; align-items: start; gap: 0.75rem;">
            <i data-lucide="alert-triangle" style="width: 20px; height: 20px; color: rgb(220, 38, 38); flex-shrink: 0; margin-top: 0.125rem;"></i>
            <div style="flex: 1;">
              <div style="font-size: 0.8125rem; font-weight: 600; color: rgb(220, 38, 38); margin-bottom: 0.25rem;">Critical: Only ${remaining} minutes remaining</div>
              <div style="font-size: 0.75rem; color: rgb(89, 90, 105); line-height: 1.5;">Your AI minutes are nearly depleted. Add more minutes now to avoid service interruption.</div>
            </div>
          </div>
        `;
      } else if (percentageUsed >= 80) {
        // Warning: 80-89% used (100-51 minutes remaining)
        status = 'warning';
        statusColor = 'rgb(133, 77, 14)';
        bgGradient = 'linear-gradient(135deg, rgb(254, 249, 195) 0%, rgb(254, 240, 138) 100%)';
        borderColor = 'rgb(250, 204, 21)';
        alertHTML = `
          <div style="background: white; border-left: 4px solid rgb(234, 179, 8); border-radius: 0.5rem; padding: 0.75rem 16px; margin-bottom: 1rem; display: flex; align-items: start; gap: 0.75rem;">
            <i data-lucide="alert-circle" style="width: 20px; height: 20px; color: rgb(234, 179, 8); flex-shrink: 0; margin-top: 0.125rem;"></i>
            <div style="flex: 1;">
              <div style="font-size: 0.8125rem; font-weight: 600; color: rgb(234, 179, 8); margin-bottom: 0.25rem;">Low Balance: ${remaining} minutes remaining</div>
              <div style="font-size: 0.75rem; color: rgb(89, 90, 105); line-height: 1.5;">You're running low on AI minutes. Consider adding more to ensure uninterrupted service.</div>
            </div>
          </div>
        `;
      } else if (currentDemoState === 'reminder') {
        // Reminder: configuration pending
        status = 'reminder';
        statusColor = 'rgb(13, 98, 255)';
        bgGradient = 'linear-gradient(135deg, rgb(237, 249, 255) 0%, rgb(209, 241, 255) 100%)';
        borderColor = 'rgb(125, 211, 252)';
        alertHTML = '';
      }
      
      // Update dashboard card (if it exists)
      const dashboardCard = document.getElementById('dashboard-ai-usage');
      if (dashboardCard) {
        // Update card styling
        dashboardCard.style.background = bgGradient;
        dashboardCard.style.borderColor = borderColor;
        
        // Update displayed numbers
        const usedSpan = dashboardCard.querySelector('span[style*="font-size: 1.75rem"]');
        if (usedSpan) {
          usedSpan.textContent = used;
        }
        
        const remainingSpan = dashboardCard.querySelector('span[style*="font-size: 0.875rem"][style*="margin-left: auto"]');
        if (remainingSpan) {
          remainingSpan.textContent = `${remaining} remaining`;
          remainingSpan.style.color = status === 'normal' ? 'rgb(21, 128, 61)' : statusColor;
        }
        
        // Update progress bar
        const dashboardProgressBar = dashboardCard.querySelector('[style*="width:"][style*="height: 100%"]');
        if (dashboardProgressBar) {
          dashboardProgressBar.style.width = `${percentageUsed}%`;
          dashboardProgressBar.style.background = statusColor;
        }

          const isReminder = currentDemoState === 'reminder';
          
          // Toggle visibility based on state
          const usageSection = dashboardCard.querySelector('[data-dashboard-usage-section]');
          const addMinutesBtn = dashboardCard.querySelector('[data-dashboard-add-minutes]');
          const statusBadge = dashboardCard.querySelector('[data-dashboard-status-badge]');
          const setupCTAContainer = dashboardCard.querySelector('[data-dashboard-setup-cta-container]');
          const title = dashboardCard.querySelector('[data-dashboard-title]');
          const subtitle = dashboardCard.querySelector('[data-dashboard-subtitle]');
          const billingLines = dashboardCard.querySelectorAll('[data-dashboard-billing]');
          
          if (usageSection) {
            usageSection.style.display = isReminder ? 'none' : '';
          }
          if (addMinutesBtn) {
            addMinutesBtn.style.display = isReminder ? 'none' : 'inline-flex';
          }
          if (statusBadge) {
            statusBadge.style.display = isReminder ? 'block' : 'none';
          }
          if (setupCTAContainer) {
            setupCTAContainer.style.display = isReminder ? 'flex' : 'none';
          }
          if (title && isReminder) {
            title.textContent = 'Complete Your Call Flow Setup';
          } else if (title) {
            title.textContent = 'Google Virtual Assistant';
          }
          if (subtitle && isReminder) {
            subtitle.textContent = 'Unlock AI-powered call handling by finishing your configuration';
          } else if (subtitle) {
            subtitle.textContent = 'AI-powered call handling • Click to view details';
          }
          if (billingLines.length) {
            billingLines.forEach((line) => {
              line.style.display = isReminder ? 'none' : '';
            });
          }
        
        // Remove existing alert if present
        const existingAlert = dashboardCard.querySelector('[data-alert]');
        if (existingAlert) {
          existingAlert.remove();
        }
        
        // Add alert if not normal status
        if (status !== 'normal' && alertHTML) {
          const usageStats = dashboardCard.querySelector('div > div');
          if (usageStats) {
            const alertDiv = document.createElement('div');
            alertDiv.setAttribute('data-alert', 'true');
            alertDiv.innerHTML = alertHTML;
            usageStats.parentNode.insertBefore(alertDiv, usageStats);
          }
        }
      }
      
      // Update landing page card (if it exists)
      const landingCard = document.querySelector('[style*="Google Virtual Assistant uses AI"]')?.closest('div[style*="background: white"]');
      if (landingCard) {
        // Update card styling
        landingCard.style.borderColor = status !== 'normal' ? borderColor : 'rgb(241, 242, 246)';
        
        // Update displayed numbers on landing page
        const landingUsedSpan = landingCard.querySelector('span[style*="font-size: 2rem"]');
        if (landingUsedSpan) {
          landingUsedSpan.textContent = used;
        }
        
        const landingRemainingDiv = landingCard.querySelector('div[style*="font-size: 1.5rem"]');
        if (landingRemainingDiv) {
          landingRemainingDiv.textContent = remaining;
          landingRemainingDiv.style.color = status === 'normal' ? 'rgb(34, 197, 94)' : statusColor;
        }
        
        const landingPercentage = landingCard.querySelector('span[style*="82% used"]');
        if (landingPercentage) {
          landingPercentage.textContent = `${Math.round(percentageUsed)}% used`;
          landingPercentage.style.color = status === 'normal' ? 'rgb(13, 98, 255)' : statusColor;
        }
        
        // Update progress bar
        const landingProgressBar = landingCard.querySelector('[style*="width:"][style*="transition: width"]');
        if (landingProgressBar) {
          landingProgressBar.style.width = `${percentageUsed}%`;
          landingProgressBar.style.background = status === 'normal' 
            ? 'linear-gradient(90deg, rgb(13, 98, 255) 0%, rgb(10, 78, 204) 100%)' 
            : `linear-gradient(90deg, ${statusColor} 0%, ${statusColor} 100%)`;
        }
        
        // Remove existing alert if present
        const existingLandingAlert = landingCard.querySelector('[data-alert]');
        if (existingLandingAlert) {
          existingLandingAlert.remove();
        }
        
        // Add alert banner at top of card if not normal
        if (status !== 'normal' && alertHTML) {
          const cardContent = landingCard.querySelector('div[style*="margin-bottom: 1.5rem"]');
          if (cardContent) {
            const alertDiv = document.createElement('div');
            alertDiv.setAttribute('data-alert', 'true');
            alertDiv.innerHTML = alertHTML;
            landingCard.insertBefore(alertDiv, cardContent);
          }
        }
      }
      
      // Update callflow page card
      updateCallflowAIUsage();
      
      // Refresh icons after any updates
      lucide.createIcons();
    }
    
    // Update the detailed AI usage card on the callflow page
    function updateCallflowAIUsage() {
      // Check if we're on the new primary section structure
      const primarySection = document.getElementById('callflow-ai-primary');
      if (!primarySection) return;
      
      // Get usage values based on current demo state
      let used, total, statusLabel, statusHTML;
      
      if (currentDemoState === 'normal') {
        used = 247;
        total = 500;
        statusLabel = 'Normal Operation';
      } else if (currentDemoState === 'warning') {
        used = 410;
        total = 500;
        statusLabel = 'Low Balance Warning';
      } else if (currentDemoState === 'critical') {
        used = 460;
        total = 500;
        statusLabel = 'Critical - Action Required';
      } else if (currentDemoState === 'reminder') {
        used = 320;
        total = 500;
        statusLabel = 'Setup reminder';
      } else { // failover
        used = 500;
        total = 500;
        statusLabel = 'Failover Active';
      }
      
      const remaining = total - used;
      const percentageUsed = (used / total) * 100;
      
      // Update the DOM elements with current values
      const minutesUsedEl = document.getElementById('ai-minutes-used');
      const minutesTotalEl = document.getElementById('ai-minutes-total');
      const minutesRemainingEl = document.getElementById('ai-minutes-remaining');
      const progressBarEl = document.getElementById('ai-progress-bar');
      const statusTextEl = document.getElementById('ai-status-text');
      
      if (minutesUsedEl) minutesUsedEl.textContent = used;
      if (minutesTotalEl) minutesTotalEl.textContent = total;
      if (minutesRemainingEl) {
        minutesRemainingEl.textContent = remaining;
        // Update color based on state
        const parent = minutesRemainingEl.closest('div');
        if (percentageUsed >= 90) {
          parent.style.color = 'rgb(220, 38, 38)';
        } else if (percentageUsed >= 80) {
          parent.style.color = 'rgb(234, 179, 8)';
        } else {
          parent.style.color = 'rgb(34, 197, 94)';
        }
      }
      if (progressBarEl) {
        progressBarEl.style.width = `${percentageUsed}%`;
        // Update progress bar color based on state
        if (percentageUsed >= 100) {
          progressBarEl.style.background = 'linear-gradient(90deg, rgb(180, 181, 187) 0%, rgb(157, 158, 167) 100%)';
        } else if (percentageUsed >= 90) {
          progressBarEl.style.background = 'linear-gradient(90deg, rgb(220, 38, 38) 0%, rgb(239, 68, 68) 100%)';
        } else if (percentageUsed >= 80) {
          progressBarEl.style.background = 'linear-gradient(90deg, rgb(234, 179, 8) 0%, rgb(250, 204, 21) 100%)';
        } else {
          progressBarEl.style.background = 'linear-gradient(90deg, rgb(13, 98, 255) 0%, rgb(59, 130, 246) 100%)';
        }
      }
      if (statusTextEl) statusTextEl.textContent = `${Math.round(percentageUsed)}% used`;
      
      // Reinitialize lucide icons
      lucide.createIcons();
    }
    
    // Initialize global demo bar on page load
    function initializeDemoBar() {
      const usageStateText = document.getElementById('demo-usage-state-text');
      if (usageStateText) {
        usageStateText.textContent = 'Normal (49%)';
        usageStateText.style.color = 'rgb(186, 230, 253)';
      }
    }
    
    // Run on page load
    initializeDemoBar();
    updateAIUsageStatus();
  </script>
</body>
</html>
